(()=>{var mo=Object.defineProperty,go=Object.defineProperties;var _o=Object.getOwnPropertyDescriptors;var zt=Object.getOwnPropertySymbols;var or=Object.prototype.hasOwnProperty,ar=Object.prototype.propertyIsEnumerable;var ts=(i,e,t)=>e in i?mo(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,H=(i,e)=>{for(var t in e||(e={}))or.call(e,t)&&ts(i,t,e[t]);if(zt)for(var t of zt(e))ar.call(e,t)&&ts(i,t,e[t]);return i},xe=(i,e)=>go(i,_o(e));var lr=(i,e)=>{var t={};for(var s in i)or.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&zt)for(var s of zt(i))e.indexOf(s)<0&&ar.call(i,s)&&(t[s]=i[s]);return t};var is=(i,e,t)=>(ts(i,typeof e!="symbol"?e+"":e,t),t);var I=(i,e,t)=>new Promise((s,r)=>{var n=l=>{try{a(t.next(l))}catch(c){r(c)}},o=l=>{try{a(t.throw(l))}catch(c){r(c)}},a=l=>l.done?s(l.value):Promise.resolve(l.value).then(n,o);a((t=t.apply(i,e)).next())});var De=class{constructor(e={}){e=Object.assign({resolveTimeout:null,resolveValue:!0,rejectTimeout:null,rejectValue:!1},e),this._promise=new Promise((o,a)=>{this.resolve=o,this.reject=a}),this.then=this._promise.then.bind(this._promise),this.catch=this._promise.catch.bind(this._promise),this.finally=this._promise.finally.bind(this._promise),this[Symbol.toStringTag]="Promise";let{resolveTimeout:t,resolveValue:s,rejectTimeout:r,rejectValue:n}=e;t&&setTimeout(()=>this.resolve(s),t),r&&setTimeout(()=>this.reject(n),r)}};var hr="layer";function cr(i,e){document.dispatchEvent(new CustomEvent("doofinder.register",{detail:{name:i,entrypoint:e}}))}var xt=i=>typeof i=="function"?i:function(){return i},vo=typeof self!="undefined"?self:null,Ct=typeof window!="undefined"?window:null,Ke=vo||Ct||Ke,bo="2.0.0",Ce={connecting:0,open:1,closing:2,closed:3},yo=1e4,So=1e3,ue={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},Oe={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},ss={longpoll:"longpoll",websocket:"websocket"},Eo={complete:4},Gt=class{constructor(i,e,t,s){this.channel=i,this.event=e,this.payload=t||function(){return{}},this.receivedResp=null,this.timeout=s,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(i){this.timeout=i,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(i,e){return this.hasReceived(i)&&e(this.receivedResp.response),this.recHooks.push({status:i,callback:e}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:i,response:e,_ref:t}){this.recHooks.filter(s=>s.status===i).forEach(s=>s.callback(e))}cancelRefEvent(){!this.refEvent||this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,i=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=i,this.matchReceive(i)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}trigger(i,e){this.channel.trigger(this.refEvent,{status:i,response:e})}},dr=class{constructor(i,e){this.callback=i,this.timerCalc=e,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},wo=class{constructor(i,e,t){this.state=ue.closed,this.topic=i,this.params=xt(e||{}),this.socket=t,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new Gt(this,Oe.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new dr(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=ue.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=ue.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ue.closed,this.socket.remove(this)}),this.onError(s=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,s),this.isJoining()&&this.joinPush.reset(),this.state=ue.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new Gt(this,Oe.leave,xt({}),this.timeout).send(),this.state=ue.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(Oe.reply,(s,r)=>{this.trigger(this.replyEventName(r),s)})}join(i=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=i,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(i){this.on(Oe.close,i)}onError(i){return this.on(Oe.error,e=>i(e))}on(i,e){let t=this.bindingRef++;return this.bindings.push({event:i,ref:t,callback:e}),t}off(i,e){this.bindings=this.bindings.filter(t=>!(t.event===i&&(typeof e=="undefined"||e===t.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(i,e,t=this.timeout){if(e=e||{},!this.joinedOnce)throw new Error(`tried to push '${i}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let s=new Gt(this,i,function(){return e},t);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}leave(i=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=ue.leaving;let e=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(Oe.close,"leave")},t=new Gt(this,Oe.leave,xt({}),i);return t.receive("ok",()=>e()).receive("timeout",()=>e()),t.send(),this.canPush()||t.trigger("ok",{}),t}onMessage(i,e,t){return e}isMember(i,e,t,s){return this.topic!==i?!1:s&&s!==this.joinRef()?(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:i,event:e,payload:t,joinRef:s}),!1):!0}joinRef(){return this.joinPush.ref}rejoin(i=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=ue.joining,this.joinPush.resend(i))}trigger(i,e,t,s){let r=this.onMessage(i,e,t,s);if(e&&!r)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let n=this.bindings.filter(o=>o.event===i);for(let o=0;o<n.length;o++)n[o].callback(r,t,s||this.joinRef())}replyEventName(i){return`chan_reply_${i}`}isClosed(){return this.state===ue.closed}isErrored(){return this.state===ue.errored}isJoined(){return this.state===ue.joined}isJoining(){return this.state===ue.joining}isLeaving(){return this.state===ue.leaving}},Yt=class{static request(i,e,t,s,r,n,o){if(Ke.XDomainRequest){let a=new Ke.XDomainRequest;return this.xdomainRequest(a,i,e,s,r,n,o)}else{let a=new Ke.XMLHttpRequest;return this.xhrRequest(a,i,e,t,s,r,n,o)}}static xdomainRequest(i,e,t,s,r,n,o){return i.timeout=r,i.open(e,t),i.onload=()=>{let a=this.parseJSON(i.responseText);o&&o(a)},n&&(i.ontimeout=n),i.onprogress=()=>{},i.send(s),i}static xhrRequest(i,e,t,s,r,n,o,a){return i.open(e,t,!0),i.timeout=n,i.setRequestHeader("Content-Type",s),i.onerror=()=>a&&a(null),i.onreadystatechange=()=>{if(i.readyState===Eo.complete&&a){let l=this.parseJSON(i.responseText);a(l)}},o&&(i.ontimeout=o),i.send(r),i}static parseJSON(i){if(!i||i==="")return null;try{return JSON.parse(i)}catch(e){return console&&console.log("failed to parse JSON response",i),null}}static serialize(i,e){let t=[];for(var s in i){if(!Object.prototype.hasOwnProperty.call(i,s))continue;let r=e?`${e}[${s}]`:s,n=i[s];typeof n=="object"?t.push(this.serialize(n,r)):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}return t.join("&")}static appendParams(i,e){if(Object.keys(e).length===0)return i;let t=i.match(/\?/)?"&":"?";return`${i}${t}${this.serialize(e)}`}},Ao=i=>{let e="",t=new Uint8Array(i),s=t.byteLength;for(let r=0;r<s;r++)e+=String.fromCharCode(t[r]);return btoa(e)},kt=class{constructor(i){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.awaitingBatchAck=!1,this.currentBatch=null,this.currentBatchTimer=null,this.batchBuffer=[],this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(i),this.readyState=Ce.connecting,setTimeout(()=>this.poll(),0)}normalizeEndpoint(i){return i.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+ss.websocket),"$1/"+ss.longpoll)}endpointURL(){return Yt.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(i,e,t){this.close(i,e,t),this.readyState=Ce.connecting}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===Ce.open||this.readyState===Ce.connecting}poll(){this.ajax("GET","application/json",null,()=>this.ontimeout(),i=>{if(i){var{status:e,token:t,messages:s}=i;this.token=t}else e=0;switch(e){case 200:s.forEach(r=>{setTimeout(()=>this.onmessage({data:r}),0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=Ce.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${e}`)}})}send(i){typeof i!="string"&&(i=Ao(i)),this.currentBatch?this.currentBatch.push(i):this.awaitingBatchAck?this.batchBuffer.push(i):(this.currentBatch=[i],this.currentBatchTimer=setTimeout(()=>{this.batchSend(this.currentBatch),this.currentBatch=null},0))}batchSend(i){this.awaitingBatchAck=!0,this.ajax("POST","application/x-ndjson",i.join(`
`),()=>this.onerror("timeout"),e=>{this.awaitingBatchAck=!1,!e||e.status!==200?(this.onerror(e&&e.status),this.closeAndRetry(1011,"internal server error",!1)):this.batchBuffer.length>0&&(this.batchSend(this.batchBuffer),this.batchBuffer=[])})}close(i,e,t){for(let r of this.reqs)r.abort();this.readyState=Ce.closed;let s=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:i,reason:e,wasClean:t});this.batchBuffer=[],clearTimeout(this.currentBatchTimer),this.currentBatchTimer=null,typeof CloseEvent!="undefined"?this.onclose(new CloseEvent("close",s)):this.onclose(s)}ajax(i,e,t,s,r){let n,o=()=>{this.reqs.delete(n),s()};n=Yt.request(i,this.endpointURL(),e,t,this.timeout,o,a=>{this.reqs.delete(n),this.isActive()&&r(a)}),this.reqs.add(n)}};var Qt={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(i,e){if(i.payload.constructor===ArrayBuffer)return e(this.binaryEncode(i));{let t=[i.join_ref,i.ref,i.topic,i.event,i.payload];return e(JSON.stringify(t))}},decode(i,e){if(i.constructor===ArrayBuffer)return e(this.binaryDecode(i));{let[t,s,r,n,o]=JSON.parse(i);return e({join_ref:t,ref:s,topic:r,event:n,payload:o})}},binaryEncode(i){let{join_ref:e,ref:t,event:s,topic:r,payload:n}=i,o=this.META_LENGTH+e.length+t.length+r.length+s.length,a=new ArrayBuffer(this.HEADER_LENGTH+o),l=new DataView(a),c=0;l.setUint8(c++,this.KINDS.push),l.setUint8(c++,e.length),l.setUint8(c++,t.length),l.setUint8(c++,r.length),l.setUint8(c++,s.length),Array.from(e,m=>l.setUint8(c++,m.charCodeAt(0))),Array.from(t,m=>l.setUint8(c++,m.charCodeAt(0))),Array.from(r,m=>l.setUint8(c++,m.charCodeAt(0))),Array.from(s,m=>l.setUint8(c++,m.charCodeAt(0)));var f=new Uint8Array(a.byteLength+n.byteLength);return f.set(new Uint8Array(a),0),f.set(new Uint8Array(n),a.byteLength),f.buffer},binaryDecode(i){let e=new DataView(i),t=e.getUint8(0),s=new TextDecoder;switch(t){case this.KINDS.push:return this.decodePush(i,e,s);case this.KINDS.reply:return this.decodeReply(i,e,s);case this.KINDS.broadcast:return this.decodeBroadcast(i,e,s)}},decodePush(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=e.getUint8(3),o=this.HEADER_LENGTH+this.META_LENGTH-1,a=t.decode(i.slice(o,o+s));o=o+s;let l=t.decode(i.slice(o,o+r));o=o+r;let c=t.decode(i.slice(o,o+n));o=o+n;let f=i.slice(o,i.byteLength);return{join_ref:a,ref:null,topic:l,event:c,payload:f}},decodeReply(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=e.getUint8(3),o=e.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,l=t.decode(i.slice(a,a+s));a=a+s;let c=t.decode(i.slice(a,a+r));a=a+r;let f=t.decode(i.slice(a,a+n));a=a+n;let m=t.decode(i.slice(a,a+o));a=a+o;let w=i.slice(a,i.byteLength),_={status:m,response:w};return{join_ref:l,ref:c,topic:f,event:Oe.reply,payload:_}},decodeBroadcast(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=this.HEADER_LENGTH+2,o=t.decode(i.slice(n,n+s));n=n+s;let a=t.decode(i.slice(n,n+r));n=n+r;let l=i.slice(n,i.byteLength);return{join_ref:null,ref:null,topic:o,event:a,payload:l}}},ur=class{constructor(i,e={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=e.timeout||yo,this.transport=e.transport||Ke.WebSocket||kt,this.primaryPassedHealthCheck=!1,this.longPollFallbackMs=e.longPollFallbackMs,this.fallbackTimer=null,this.sessionStore=e.sessionStorage||Ke&&Ke.sessionStorage,this.establishedConnections=0,this.defaultEncoder=Qt.encode.bind(Qt),this.defaultDecoder=Qt.decode.bind(Qt),this.closeWasClean=!1,this.binaryType=e.binaryType||"arraybuffer",this.connectClock=1,this.transport!==kt?(this.encode=e.encode||this.defaultEncoder,this.decode=e.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let t=null;Ct&&Ct.addEventListener&&(Ct.addEventListener("pagehide",s=>{this.conn&&(this.disconnect(),t=this.connectClock)}),Ct.addEventListener("pageshow",s=>{t===this.connectClock&&(t=null,this.connect())})),this.heartbeatIntervalMs=e.heartbeatIntervalMs||3e4,this.rejoinAfterMs=s=>e.rejoinAfterMs?e.rejoinAfterMs(s):[1e3,2e3,5e3][s-1]||1e4,this.reconnectAfterMs=s=>e.reconnectAfterMs?e.reconnectAfterMs(s):[10,50,100,150,200,250,500,1e3,2e3][s-1]||5e3,this.logger=e.logger||null,!this.logger&&e.debug&&(this.logger=(s,r,n)=>{console.log(`${s}: ${r}`,n)}),this.longpollerTimeout=e.longpollerTimeout||2e4,this.params=xt(e.params||{}),this.endPoint=`${i}/${ss.websocket}`,this.vsn=e.vsn||bo,this.heartbeatTimeoutTimer=null,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new dr(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}getLongPollTransport(){return kt}replaceTransport(i){this.connectClock++,this.closeWasClean=!0,clearTimeout(this.fallbackTimer),this.reconnectTimer.reset(),this.conn&&(this.conn.close(),this.conn=null),this.transport=i}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let i=Yt.appendParams(Yt.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return i.charAt(0)!=="/"?i:i.charAt(1)==="/"?`${this.protocol()}:${i}`:`${this.protocol()}://${location.host}${i}`}disconnect(i,e,t){this.connectClock++,this.closeWasClean=!0,clearTimeout(this.fallbackTimer),this.reconnectTimer.reset(),this.teardown(i,e,t)}connect(i){i&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=xt(i)),!this.conn&&(this.longPollFallbackMs&&this.transport!==kt?this.connectWithFallback(kt,this.longPollFallbackMs):this.transportConnect())}log(i,e,t){this.logger&&this.logger(i,e,t)}hasLogger(){return this.logger!==null}onOpen(i){let e=this.makeRef();return this.stateChangeCallbacks.open.push([e,i]),e}onClose(i){let e=this.makeRef();return this.stateChangeCallbacks.close.push([e,i]),e}onError(i){let e=this.makeRef();return this.stateChangeCallbacks.error.push([e,i]),e}onMessage(i){let e=this.makeRef();return this.stateChangeCallbacks.message.push([e,i]),e}ping(i){if(!this.isConnected())return!1;let e=this.makeRef(),t=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:e});let s=this.onMessage(r=>{r.ref===e&&(this.off([s]),i(Date.now()-t))});return!0}transportConnect(){this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=i=>this.onConnError(i),this.conn.onmessage=i=>this.onConnMessage(i),this.conn.onclose=i=>this.onConnClose(i)}getSession(i){return this.sessionStore&&this.sessionStore.getItem(i)}storeSession(i,e){this.sessionStore&&this.sessionStore.setItem(i,e)}connectWithFallback(i,e=2500){clearTimeout(this.fallbackTimer);let t=!1,s=!0,r,n,o=a=>{this.log("transport",`falling back to ${i.name}...`,a),this.off([r,n]),s=!1,this.replaceTransport(i),this.transportConnect()};if(this.getSession(`phx:fallback:${i.name}`))return o("memorized");this.fallbackTimer=setTimeout(o,e),n=this.onError(a=>{this.log("transport","error",a),s&&!t&&(clearTimeout(this.fallbackTimer),o(a))}),this.onOpen(()=>{if(t=!0,!s)return this.primaryPassedHealthCheck||this.storeSession(`phx:fallback:${i.name}`,"true"),this.log("transport",`established ${i.name} fallback`);clearTimeout(this.fallbackTimer),this.fallbackTimer=setTimeout(o,e),this.ping(a=>{this.log("transport","connected to primary after",a),this.primaryPassedHealthCheck=!0,clearTimeout(this.fallbackTimer)})}),this.transportConnect()}clearHeartbeats(){clearTimeout(this.heartbeatTimer),clearTimeout(this.heartbeatTimeoutTimer)}onConnOpen(){this.hasLogger()&&this.log("transport",`${this.transport.name} connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,i])=>i())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.triggerChanError(),this.closeWasClean=!1,this.teardown(()=>this.reconnectTimer.scheduleTimeout(),So,"heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,this.clearHeartbeats(),this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(i,e,t){if(!this.conn)return i&&i();this.waitForBufferDone(()=>{this.conn&&(e?this.conn.close(e,t||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onopen=function(){},this.conn.onerror=function(){},this.conn.onmessage=function(){},this.conn.onclose=function(){},this.conn=null),i&&i()})})}waitForBufferDone(i,e=1){if(e===5||!this.conn||!this.conn.bufferedAmount){i();return}setTimeout(()=>{this.waitForBufferDone(i,e+1)},150*e)}waitForSocketClosed(i,e=1){if(e===5||!this.conn||this.conn.readyState===Ce.closed){i();return}setTimeout(()=>{this.waitForSocketClosed(i,e+1)},150*e)}onConnClose(i){let e=i&&i.code;this.hasLogger()&&this.log("transport","close",i),this.triggerChanError(),this.clearHeartbeats(),!this.closeWasClean&&e!==1e3&&this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,t])=>t(i))}onConnError(i){this.hasLogger()&&this.log("transport",i);let e=this.transport,t=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,s])=>{s(i,e,t)}),(e===this.transport||t>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(i=>{i.isErrored()||i.isLeaving()||i.isClosed()||i.trigger(Oe.error)})}connectionState(){switch(this.conn&&this.conn.readyState){case Ce.connecting:return"connecting";case Ce.open:return"open";case Ce.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(i){this.off(i.stateChangeRefs),this.channels=this.channels.filter(e=>e!==i)}off(i){for(let e in this.stateChangeCallbacks)this.stateChangeCallbacks[e]=this.stateChangeCallbacks[e].filter(([t])=>i.indexOf(t)===-1)}channel(i,e={}){let t=new wo(i,e,this);return this.channels.push(t),t}push(i){if(this.hasLogger()){let{topic:e,event:t,payload:s,ref:r,join_ref:n}=i;this.log("push",`${e} ${t} (${n}, ${r})`,s)}this.isConnected()?this.encode(i,e=>this.conn.send(e)):this.sendBuffer.push(()=>this.encode(i,e=>this.conn.send(e)))}makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimeoutTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}onConnMessage(i){this.decode(i.data,e=>{let{topic:t,event:s,payload:r,ref:n,join_ref:o}=e;n&&n===this.pendingHeartbeatRef&&(this.clearHeartbeats(),this.pendingHeartbeatRef=null,this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${r.status||""} ${t} ${s} ${n&&"("+n+")"||""}`,r);for(let a=0;a<this.channels.length;a++){let l=this.channels[a];!l.isMember(t,s,r,o)||l.trigger(s,r,n,o)}for(let a=0;a<this.stateChangeCallbacks.message.length;a++){let[,l]=this.stateChangeCallbacks.message[a];l(e)}})}leaveOpenTopic(i){let e=this.channels.find(t=>t.topic===i&&(t.isJoined()||t.isJoining()));e&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${i}"`),e.leave())}};var fr=(i,e,t)=>{e.forEach(s=>{i.addEventListener(s,t)})},pr=(i,e,t)=>{e.forEach(s=>{i.removeEventListener(s,t)})},rs=class{constructor(e){this.defaults={idle:1e4,events:["mousemove","scroll","keydown","mousedown","touchstart"],onIdle:null,onActive:null,onHide:null,onShow:null,keepTracking:!0,startAtIdle:!1,recurIdleCall:!1},this.throwOnBadKey(Object.keys(e),Object.keys(this.defaults)),this.settings=Object.assign({},this.defaults,e),this.visibilityEvents=["visibilitychange","webkitvisibilitychange","mozvisibilitychange","msvisibilitychange"],this.clearTimeout=null,this.reset(),this.stopListener=t=>{this.stop()},this.idlenessEventsHandler=t=>{this.idle&&(this.idle=!1,this.settings.onActive&&this.settings.onActive.call()),this.resetTimeout(this.settings)},this.visibilityEventsHandler=t=>{document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?this.visible&&(this.visible=!1,this.settings.onHide&&this.settings.onHide.call()):this.visible||(this.visible=!0,this.settings.onShow&&this.settings.onShow.call())}}resetTimeout(e,t=this.settings.keepTracking){this.clearTimeout&&(this.clearTimeout(),this.clearTimeout=null),t&&this.timeout(this.settings)}timeout(e){var t=this.settings.recurIdleCall?{set:setInterval.bind(window),clear:clearInterval.bind(window)}:{set:setTimeout.bind(window),clear:clearTimeout.bind(window)},s=t.set(function(){this.idle=!0,this.settings.onIdle&&this.settings.onIdle.call()}.bind(this),this.settings.idle);this.clearTimeout=()=>t.clear(s)}start(){return window.addEventListener("idle:stop",this.stopListener),this.timeout(this.settings),fr(window,this.settings.events,this.idlenessEventsHandler),(this.settings.onShow||this.settings.onHide)&&fr(document,this.visibilityEvents,this.visibilityEventsHandler),this}stop(){return window.removeEventListener("idle:stop",this.stopListener),pr(window,this.settings.events,this.idlenessEventsHandler),this.resetTimeout(this.settings,!1),(this.settings.onShow||this.settings.onHide)&&pr(document,this.visibilityEvents,this.visibilityEventsHandler),this}reset({idle:e=this.settings.startAtIdle,visible:t=!this.settings.startAtIdle}={}){return this.idle=e,this.visible=t,this}throwOnBadKey(e,t){e.forEach(function(s){if(!t.includes(s))throw`set: Unknown key ${s}`})}set(e){this.throwOnBadKey(Object.keys(e),Object.keys(this.defaults)),this.settings=Object.assign(this.settings,e)}};var ns=class extends ur{constructor(e,t={}){super(e,t);this.preventReconnect=!1,this.shouldReconnect=!1,this.idleMonitor=new rs({idle:3*60*1e3,onActive:this.onShowOrActive.bind(this),onShow:this.onShowOrActive.bind(this)}),this.idleMonitor.start()}onShowOrActive(){this.shouldReconnect&&this.idleMonitor.visible&&!this.idleMonitor.idle&&(this.shouldReconnect=!1,this.reconnectTimer.scheduleTimeout())}onConnClose(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),this.clearHeartbeats(),this.preventReconnect||(this.closeWasClean?this.idleMonitor.stop():this.scheduleReconnect()),this.stateChangeCallbacks.close.forEach(([,t])=>t(e))}scheduleReconnect(){!this.idleMonitor.idle&&this.idleMonitor.visible?this.reconnectTimer.scheduleTimeout():(this.reconnectTimer.reset(),this.shouldReconnect=!0)}};var B="search",Zt="consecutive-reloads",mr=10,gr=5e3,_r=1e4,vr=3e4,ei=["phx-click-loading","phx-change-loading","phx-submit-loading","phx-keydown-loading","phx-keyup-loading","phx-blur-loading","phx-focus-loading","phx-hook-loading"],fe="data-phx-component";var br="track-static";var ae="data-phx-ref",ke="data-phx-ref-src",ti="track-uploads",pe="data-phx-upload-ref",at="data-phx-preflighted-refs",yr="data-phx-done-refs",os="drop-target",Pt="data-phx-active-refs",lt=`${B}:live-file:updated`,ii="data-phx-skip",si="data-phx-id",as="data-phx-prune",ls="page-loading",hs="phx-connected",ht="phx-loading",Rt="phx-no-feedback",It="phx-error",cs="phx-client-error",ri="phx-server-error",ze="data-phx-parent-id",ni="data-phx-main",Pe="data-dfd-root-id",oi="viewport-top",ai="viewport-bottom",Sr="trigger-action",Ge="feedback-for",Ye="feedback-group",Lt="phx-has-focused",Er=["text","textarea","number","email","password","search","tel","url","date","time","datetime-local","color","range"],li=["checkbox","radio"],ct="phx-has-submitted",_e="data-dfd-view",He=`[${_e}]`,ds="data-phx-sticky",Ue="data-phx-static",hi="data-phx-readonly",Qe="data-phx-disabled",Dt="disable-with",Ot="data-phx-disable-with-restore",dt="hook",wr="debounce",Ar="throttle",ut="update",ci="stream",di="data-phx-stream",Tr="key",Ee="phxPrivate",us="auto-recover",Ht="phx:live-socket:debug",ui="phx:live-socket:profiling",fi="phx:live-socket:latency-sim",xr="progress",fs="mounted",Cr=1,kr=200,Pr="dfd-",Rr=3e4;var ft="debounce-trigger",pt="throttled",ps="debounce-prev-key",Ir={debounce:300,throttle:300},Mt="d",we="s",pi="r",le="c",ms="e",gs="r",_s="t",Lr="p",vs="stream";var mi=class{constructor(e,t,s){this.liveSocket=s,this.entry=e,this.offset=0,this.chunkSize=t,this.chunkTimer=null,this.errored=!1,this.uploadChannel=s.channel(`lvu:${e.ref}`,{token:e.metadata()})}error(e){this.errored||(this.uploadChannel.leave(),this.errored=!0,clearTimeout(this.chunkTimer),this.entry.error(e))}upload(){this.uploadChannel.onError(e=>this.error(e)),this.uploadChannel.join().receive("ok",e=>this.readNextChunk()).receive("error",e=>this.error(e))}isDone(){return this.offset>=this.entry.file.size}readNextChunk(){let e=new window.FileReader,t=this.entry.file.slice(this.offset,this.chunkSize+this.offset);e.onload=s=>{if(s.target.error===null)this.offset+=s.target.result.byteLength,this.pushChunk(s.target.result);else return se("Read error: "+s.target.error)},e.readAsArrayBuffer(t)}pushChunk(e){!this.uploadChannel.isJoined()||this.uploadChannel.push("chunk",e).receive("ok",()=>{this.entry.progress(this.offset/this.entry.file.size*100),this.isDone()||(this.chunkTimer=setTimeout(()=>this.readNextChunk(),this.liveSocket.getLatencySim()||0))}).receive("error",({reason:t})=>this.error(t))}};var se=(i,e)=>console.error&&console.error(i,e),ve=i=>{let e=typeof i;return e==="number"||e==="string"&&/^(0|[1-9]\d*)$/.test(i)};function Dr(i=document){let e=new Set,t=i.querySelectorAll("*[id]");for(let s=0,r=t.length;s<r;s++)e.has(t[s].id)?console.error(`Multiple IDs detected: ${t[s].id}. Ensure unique element ids.`):e.add(t[s].id)}var Or=(i,e,t,s)=>{i.liveSocket.isDebugEnabled()&&console.log(`${i.id} ${e}: ${t} - `,s)},gi=i=>typeof i=="function"?i:function(){return i},mt=i=>JSON.parse(JSON.stringify(i)),gt=(i,e,t)=>{do{if(i.matches(`[${e}]`)&&!i.disabled)return i;i=i.parentElement||i.parentNode}while(i!==null&&i.nodeType===1&&!(t&&t.isSameNode(i)||i.matches(He)));return null},Ze=i=>i!==null&&typeof i=="object"&&!(i instanceof Array),Hr=(i,e)=>JSON.stringify(i)===JSON.stringify(e),bs=i=>{for(let e in i)return!1;return!0},Ae=(i,e)=>i&&e(i),Mr=function(i,e,t,s){i.forEach(r=>{new mi(r,t.config.chunk_size,s).upload()})};var Nr={canPushState(){return typeof history.pushState!="undefined"},dropLocal(i,e,t){return i.removeItem(this.localKey(e,t))},updateLocal(i,e,t,s,r){let n=this.getLocal(i,e,t),o=this.localKey(e,t),a=n===null?s:r(n);return i.setItem(o,JSON.stringify(a)),a},getLocal(i,e,t){return JSON.parse(i.getItem(this.localKey(e,t)))},updateCurrentState(i){!this.canPushState()||history.replaceState(i(history.state||{}),"",window.location.href)},pushState(i,e,t){if(this.canPushState()){if(t!==window.location.href){if(e.type=="redirect"&&e.scroll){let r=history.state||{};r.scroll=e.scroll,history.replaceState(r,"",window.location.href)}delete e.scroll,history[i+"State"](e,"",t||null);let s=this.getHashTargetEl(window.location.hash);s?s.scrollIntoView():e.type==="redirect"&&window.scroll(0,0)}}else this.redirect(t)},setCookie(i,e){document.cookie=`${i}=${e}`},getCookie(i){return document.cookie.replace(new RegExp(`(?:(?:^|.*;s*)${i}s*=s*([^;]*).*$)|^.*$`),"$1")},redirect(i,e){e&&Nr.setCookie("__phoenix_flash__",e+"; max-age=60000; path=/"),window.location=i},localKey(i,e){return`${i}-${e}`},getHashTargetEl(i){let e=i.toString().substring(1);if(e!=="")return document.getElementById(e)||document.querySelector(`a[name="${e}"]`)}},Re=Nr;var To={focusMain(){let i=document.querySelector("main h1, main, h1");if(i){let e=i.tabIndex;i.tabIndex=-1,i.focus(),i.tabIndex=e}},anyOf(i,e){return e.find(t=>i instanceof t)},isFocusable(i,e){return i instanceof HTMLAnchorElement&&i.rel!=="ignore"||i instanceof HTMLAreaElement&&i.href!==void 0||!i.disabled&&this.anyOf(i,[HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement,HTMLButtonElement])||i instanceof HTMLIFrameElement||i.tabIndex>0||!e&&i.getAttribute("tabindex")!==null&&i.getAttribute("aria-hidden")!=="true"},attemptFocus(i,e){if(this.isFocusable(i,e))try{i.focus()}catch(t){}return!!document.activeElement&&document.activeElement.isSameNode(i)},focusFirstInteractive(i){let e=i.firstElementChild;for(;e;){if(this.attemptFocus(e,!0)||this.focusFirstInteractive(e,!0))return!0;e=e.nextElementSibling}},focusFirst(i){let e=i.firstElementChild;for(;e;){if(this.attemptFocus(e)||this.focusFirst(e))return!0;e=e.nextElementSibling}},focusLast(i){let e=i.lastElementChild;for(;e;){if(this.attemptFocus(e)||this.focusLast(e))return!0;e=e.previousElementSibling}}},Be=To;var _i=null,Fr=200,xo={exec(i,e,t,s,r){let[n,o]=r||[null,{callback:r&&r.callback}];(e.charAt(0)==="["?JSON.parse(e):[[n,o]]).forEach(([l,c])=>{l===n&&o.data&&(c.data=Object.assign(c.data||{},o.data),c.callback=c.callback||o.callback),this.filterToEls(s,c).forEach(f=>{this[`exec_${l}`](i,e,t,s,f,c)})})},isVisible(i){return!!(i.offsetWidth||i.offsetHeight||i.getClientRects().length>0)},isInViewport(i){let e=i.getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight,s=window.innerWidth||document.documentElement.clientWidth;return e.right>0&&e.bottom>0&&e.left<s&&e.top<t},exec_exec(i,e,t,s,r,{attr:n,to:o}){(o?p.all(document,o):[s]).forEach(l=>{let c=l.getAttribute(n);if(!c)throw new Error(`expected ${n} to contain JS command on "${o}"`);t.liveSocket.execJS(l,c,i)})},exec_dispatch(i,e,t,s,r,{to:n,event:o,detail:a,bubbles:l}){a=a||{},a.dispatcher=s,p.dispatchEvent(r,o,{detail:a,bubbles:l})},exec_push(i,e,t,s,r,n){let{event:o,data:a,target:l,page_loading:c,loading:f,value:m,dispatcher:w,callback:_}=n,S={loading:f,value:m,target:l,page_loading:!!c},E=i==="change"&&w?w:s,R=l||E.getAttribute(t.binding("target"))||E;t.withinTargets(R,(F,L)=>{if(!!F.isConnected())if(i==="change"){let{newCid:V,_target:j}=n;j=j||(p.isFormInput(s)?s.name:void 0),j&&(S._target=j),F.pushInput(s,L,V,o||e,S,_)}else if(i==="submit"){let{submitter:V}=n;F.submitForm(s,L,o||e,V,S,_)}else F.pushEvent(i,s,L,o||e,a,S,_)})},exec_navigate(i,e,t,s,r,{href:n,replace:o}){t.liveSocket.historyRedirect(n,o?"replace":"push")},exec_patch(i,e,t,s,r,{href:n,replace:o}){t.liveSocket.pushHistoryPatch(n,o?"replace":"push",s)},exec_focus(i,e,t,s,r){window.requestAnimationFrame(()=>Be.attemptFocus(r))},exec_focus_first(i,e,t,s,r){window.requestAnimationFrame(()=>Be.focusFirstInteractive(r)||Be.focusFirst(r))},exec_push_focus(i,e,t,s,r){window.requestAnimationFrame(()=>_i=r||s)},exec_pop_focus(i,e,t,s,r){window.requestAnimationFrame(()=>{_i&&_i.focus(),_i=null})},exec_add_class(i,e,t,s,r,{names:n,transition:o,time:a}){this.addOrRemoveClasses(r,n,[],o,a,t)},exec_remove_class(i,e,t,s,r,{names:n,transition:o,time:a}){this.addOrRemoveClasses(r,[],n,o,a,t)},exec_toggle_class(i,e,t,s,r,{to:n,names:o,transition:a,time:l}){this.toggleClasses(r,o,a,t)},exec_toggle_attr(i,e,t,s,r,{attr:[n,o,a]}){r.hasAttribute(n)?a!==void 0?r.getAttribute(n)===o?this.setOrRemoveAttrs(r,[[n,a]],[]):this.setOrRemoveAttrs(r,[[n,o]],[]):this.setOrRemoveAttrs(r,[],[n]):this.setOrRemoveAttrs(r,[[n,o]],[])},exec_transition(i,e,t,s,r,{time:n,transition:o}){this.addOrRemoveClasses(r,[],[],o,n,t)},exec_toggle(i,e,t,s,r,{display:n,ins:o,outs:a,time:l}){this.toggle(i,t,r,n,o,a,l)},exec_show(i,e,t,s,r,{display:n,transition:o,time:a}){this.show(i,t,r,n,o,a)},exec_hide(i,e,t,s,r,{display:n,transition:o,time:a}){this.hide(i,t,r,n,o,a)},exec_set_attr(i,e,t,s,r,{attr:[n,o]}){this.setOrRemoveAttrs(r,[[n,o]],[])},exec_remove_attr(i,e,t,s,r,{attr:n}){this.setOrRemoveAttrs(r,[],[n])},show(i,e,t,s,r,n){this.isVisible(t)||this.toggle(i,e,t,s,r,null,n)},hide(i,e,t,s,r,n){this.isVisible(t)&&this.toggle(i,e,t,s,null,r,n)},toggle(i,e,t,s,r,n,o){o=o||Fr;let[a,l,c]=r||[[],[],[]],[f,m,w]=n||[[],[],[]];if(a.length>0||f.length>0)if(this.isVisible(t)){let _=()=>{this.addOrRemoveClasses(t,m,a.concat(l).concat(c)),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(t,f,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(t,w,m))})};t.dispatchEvent(new Event(`${B}:hide-start`)),e.transition(o,_,()=>{this.addOrRemoveClasses(t,[],f.concat(w)),p.putSticky(t,"toggle",S=>S.style.display="none"),t.dispatchEvent(new Event(`${B}:hide-end`))})}else{if(i==="remove")return;let _=()=>{this.addOrRemoveClasses(t,l,f.concat(m).concat(w));let S=s||this.defaultDisplay(t);p.putSticky(t,"toggle",E=>E.style.display=S),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(t,a,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(t,c,l))})};t.dispatchEvent(new Event(`${B}:show-start`)),e.transition(o,_,()=>{this.addOrRemoveClasses(t,[],a.concat(c)),t.dispatchEvent(new Event(`${B}:show-end`))})}else this.isVisible(t)?window.requestAnimationFrame(()=>{t.dispatchEvent(new Event(`${B}:hide-start`)),p.putSticky(t,"toggle",_=>_.style.display="none"),t.dispatchEvent(new Event(`${B}:hide-end`))}):window.requestAnimationFrame(()=>{t.dispatchEvent(new Event(`${B}:show-start`));let _=s||this.defaultDisplay(t);p.putSticky(t,"toggle",S=>S.style.display=_),t.dispatchEvent(new Event(`${B}:show-end`))})},toggleClasses(i,e,t,s,r){window.requestAnimationFrame(()=>{let[n,o]=p.getSticky(i,"classes",[[],[]]),a=e.filter(c=>n.indexOf(c)<0&&!i.classList.contains(c)),l=e.filter(c=>o.indexOf(c)<0&&i.classList.contains(c));this.addOrRemoveClasses(i,a,l,t,s,r)})},addOrRemoveClasses(i,e,t,s,r,n){r=r||Fr;let[o,a,l]=s||[[],[],[]];if(o.length>0){let c=()=>{this.addOrRemoveClasses(i,a,[].concat(o).concat(l)),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(i,o,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(i,l,a))})},f=()=>this.addOrRemoveClasses(i,e.concat(l),t.concat(o).concat(a));return n.transition(r,c,f)}window.requestAnimationFrame(()=>{let[c,f]=p.getSticky(i,"classes",[[],[]]),m=e.filter(E=>c.indexOf(E)<0&&!i.classList.contains(E)),w=t.filter(E=>f.indexOf(E)<0&&i.classList.contains(E)),_=c.filter(E=>t.indexOf(E)<0).concat(m),S=f.filter(E=>e.indexOf(E)<0).concat(w);p.putSticky(i,"classes",E=>(E.classList.remove(...S),E.classList.add(..._),[_,S]))})},setOrRemoveAttrs(i,e,t){let[s,r]=p.getSticky(i,"attrs",[[],[]]),n=e.map(([l,c])=>l).concat(t),o=s.filter(([l,c])=>!n.includes(l)).concat(e),a=r.filter(l=>!n.includes(l)).concat(t);p.putSticky(i,"attrs",l=>(a.forEach(c=>l.removeAttribute(c)),o.forEach(([c,f])=>l.setAttribute(c,f)),[o,a]))},hasAllClasses(i,e){return e.every(t=>i.classList.contains(t))},isToggledOut(i,e){return!this.isVisible(i)||this.hasAllClasses(i,e)},filterToEls(i,{to:e}){return e?p.all(document,e):[i]},defaultDisplay(i){return{tr:"table-row",td:"table-cell"}[i.tagName.toLowerCase()]||"block"}},te=xo;var be={byId(i){return document.getElementById(i)||se(`no id found for ${i}`)},removeClass(i,e){i.classList.remove(e),i.classList.length===0&&i.removeAttribute("class")},all(i,e,t){if(!i)return[];let s=Array.from(i.querySelectorAll(e));return t?s.forEach(t):s},childNodeLength(i){let e=document.createElement("template");return e.innerHTML=i,e.content.childElementCount},isUploadInput(i){return i.type==="file"&&i.getAttribute(pe)!==null},isAutoUpload(i){return i.hasAttribute("data-phx-auto-upload")},findUploadInputs(i){let e=i.id,t=this.all(document,`input[type="file"][${pe}][form="${e}"]`);return this.all(i,`input[type="file"][${pe}]`).concat(t)},findComponentNodeList(i,e){return this.filterWithinSameLiveView(this.all(i,`[${fe}="${e}"]`),i)},isPhxDestroyed(i){return!!(i.id&&be.private(i,"destroyed"))},wantsNewTab(i){let e=i.ctrlKey||i.shiftKey||i.metaKey||i.button&&i.button===1,t=i.target instanceof HTMLAnchorElement&&i.target.hasAttribute("download"),s=i.target.hasAttribute("target")&&i.target.getAttribute("target").toLowerCase()==="_blank";return e||s||t},isUnloadableFormSubmit(i){return i.target&&i.target.getAttribute("method")==="dialog"||i.submitter&&i.submitter.getAttribute("formmethod")==="dialog"?!1:!i.defaultPrevented&&!this.wantsNewTab(i)},isNewPageClick(i,e){let t=i.target instanceof HTMLAnchorElement?i.target.getAttribute("href"):null,s;if(i.defaultPrevented||t===null||this.wantsNewTab(i)||t.startsWith("mailto:")||t.startsWith("tel:")||i.target.isContentEditable)return!1;try{s=new URL(t)}catch(r){try{s=new URL(t,e)}catch(n){return!0}}return s.host===e.host&&s.protocol===e.protocol&&s.pathname===e.pathname&&s.search===e.search?s.hash===""&&!s.href.endsWith("#"):s.protocol.startsWith("http")},markPhxChildDestroyed(i){this.isPhxChild(i)&&i.setAttribute(_e,""),this.putPrivate(i,"destroyed",!0)},findPhxChildrenInFragment(i,e){let t=document.createElement("template");return t.innerHTML=i,this.findPhxChildren(t.content,e)},isIgnored(i,e){return(i.getAttribute(e)||i.getAttribute("data-phx-update"))==="ignore"},isPhxUpdate(i,e,t){return i.getAttribute&&t.indexOf(i.getAttribute(e))>=0},findPhxSticky(i){return this.all(i,`[${ds}]`)},findPhxChildren(i,e){return this.all(i,`${He}[${ze}="${e}"]`)},findParentCIDs(i,e){let t=new Set(e),s=e.reduce((r,n)=>{let o=`[${fe}="${n}"] [${fe}]`;return this.filterWithinSameLiveView(this.all(i,o),i).map(a=>parseInt(a.getAttribute(fe))).forEach(a=>r.delete(a)),r},t);return s.size===0?new Set(e):s},filterWithinSameLiveView(i,e){return e.querySelector(He)?i.filter(t=>this.withinSameLiveView(t,e)):i},withinSameLiveView(i,e){for(;i=i.parentNode;){if(i.isSameNode(e))return!0;if(i.getAttribute(_e)!==null)return!1}},private(i,e){return i[Ee]&&i[Ee][e]},deletePrivate(i,e){i[Ee]&&delete i[Ee][e]},putPrivate(i,e,t){i[Ee]||(i[Ee]={}),i[Ee][e]=t},updatePrivate(i,e,t,s){let r=this.private(i,e);r===void 0?this.putPrivate(i,e,s(t)):this.putPrivate(i,e,s(r))},copyPrivates(i,e){e[Ee]&&(i[Ee]=e[Ee])},putTitle(i){let e=document.querySelector("title");if(e){let{prefix:t,suffix:s}=e.dataset;document.title=`${t||""}${i}${s||""}`}else document.title=i},debounce(i,e,t,s,r,n,o,a){let l=i.getAttribute(t),c=i.getAttribute(r);l===""&&(l=s),c===""&&(c=n);let f=l||c;switch(f){case null:return a();case"blur":this.once(i,"debounce-blur")&&i.addEventListener("blur",()=>a());return;default:let m=parseInt(f),w=()=>c?this.deletePrivate(i,pt):a(),_=this.incCycle(i,ft,w);if(isNaN(m))return se(`invalid throttle/debounce value: ${f}`);if(c){let E=!1;if(e.type==="keydown"){let R=this.private(i,ps);this.putPrivate(i,ps,e.key),E=R!==e.key}if(!E&&this.private(i,pt))return!1;{a();let R=setTimeout(()=>{o()&&this.triggerCycle(i,ft)},m);this.putPrivate(i,pt,R)}}else setTimeout(()=>{o()&&this.triggerCycle(i,ft,_)},m);let S=i.form;S&&this.once(S,"bind-debounce")&&S.addEventListener("submit",()=>{Array.from(new FormData(S).entries(),([E])=>{let R=S.querySelector(`[name="${E}"]`);this.incCycle(R,ft),this.deletePrivate(R,pt)})}),this.once(i,"bind-debounce")&&i.addEventListener("blur",()=>{clearTimeout(this.private(i,pt)),this.triggerCycle(i,ft)})}},triggerCycle(i,e,t){let[s,r]=this.private(i,e);t||(t=s),t===s&&(this.incCycle(i,e),r())},once(i,e){return this.private(i,e)===!0?!1:(this.putPrivate(i,e,!0),!0)},incCycle(i,e,t=function(){}){let[s]=this.private(i,e)||[0,t];return s++,this.putPrivate(i,e,[s,t]),s},isFeedbackContainer(i,e){return i.hasAttribute&&i.hasAttribute(e)},maybeHideFeedback(i,e,t,s){let r={};e.forEach(n=>{if(!i.contains(n))return;let o=n.getAttribute(t);if(!o){te.addOrRemoveClasses(n,[],[Rt]);return}if(r[o]===!0){this.hideFeedback(n);return}r[o]=this.shouldHideFeedback(i,o,s),r[o]===!0&&this.hideFeedback(n)})},hideFeedback(i){te.addOrRemoveClasses(i,[Rt],[])},shouldHideFeedback(i,e,t){let s=`[name="${e}"],
                   [name="${e}[]"],
                   [${t}="${e}"]`,r=!1;return be.all(i,s,n=>{(this.private(n,Lt)||this.private(n,ct))&&(r=!0)}),!r},feedbackSelector(i,e,t){let s=`[${e}="${i.name}"],
                 [${e}="${i.name.replace(/\[\]$/,"")}"]`;return i.getAttribute(t)&&(s+=`,[${e}="${i.getAttribute(t)}"]`),s},resetForm(i,e,t){Array.from(i.elements).forEach(s=>{let r=this.feedbackSelector(s,e,t);this.deletePrivate(s,Lt),this.deletePrivate(s,ct),this.all(document,r,n=>{te.addOrRemoveClasses(n,[Rt],[])})})},showError(i,e,t){if(i.name){let s=this.feedbackSelector(i,e,t);this.all(document,s,r=>{te.addOrRemoveClasses(r,[],[Rt])})}},isPhxChild(i){return i.getAttribute&&i.getAttribute(ze)},isPhxSticky(i){return i.getAttribute&&i.getAttribute(ds)!==null},isChildOfAny(i,e){return!!e.find(t=>t.contains(i))},firstPhxChild(i){return this.isPhxChild(i)?i:this.all(i,`[${ze}]`)[0]},dispatchEvent(i,e,t={}){let s=!0;i.nodeName==="INPUT"&&i.type==="file"&&e==="click"&&(s=!1);let o={bubbles:t.bubbles===void 0?s:!!t.bubbles,cancelable:!0,detail:t.detail||{}},a=e==="click"?new MouseEvent("click",o):new CustomEvent(e,o);i.dispatchEvent(a)},cloneNode(i,e){if(typeof e=="undefined")return i.cloneNode(!0);{let t=i.cloneNode(!1);return t.innerHTML=e,t}},mergeAttrs(i,e,t={}){let s=new Set(t.exclude||[]),r=t.isIgnored,n=e.attributes;for(let a=n.length-1;a>=0;a--){let l=n[a].name;if(s.has(l))l==="value"&&i.value===e.value&&i.setAttribute("value",e.getAttribute(l));else{let c=e.getAttribute(l);i.getAttribute(l)!==c&&(!r||r&&l.startsWith("data-"))&&i.setAttribute(l,c)}}let o=i.attributes;for(let a=o.length-1;a>=0;a--){let l=o[a].name;r?l.startsWith("data-")&&!e.hasAttribute(l)&&![ae,ke].includes(l)&&i.removeAttribute(l):e.hasAttribute(l)||i.removeAttribute(l)}},mergeFocusedInput(i,e){i instanceof HTMLSelectElement||be.mergeAttrs(i,e,{exclude:["value"]}),e.readOnly?i.setAttribute("readonly",!0):i.removeAttribute("readonly")},hasSelectionRange(i){return i.setSelectionRange&&(i.type==="text"||i.type==="textarea")},restoreFocus(i,e,t){if(i instanceof HTMLSelectElement&&i.focus(),!be.isTextualInput(i))return;let s=i.matches(":focus");i.readOnly&&i.blur(),s||i.focus(),this.hasSelectionRange(i)&&i.setSelectionRange(e,t)},isFormInput(i){return/^(?:input|select|textarea)$/i.test(i.tagName)&&i.type!=="button"},syncAttrsToProps(i){i instanceof HTMLInputElement&&li.indexOf(i.type.toLocaleLowerCase())>=0&&(i.checked=i.getAttribute("checked")!==null)},isTextualInput(i){return Er.indexOf(i.type)>=0},isNowTriggerFormExternal(i,e){return i.getAttribute&&i.getAttribute(e)!==null},syncPendingRef(i,e,t){let s=i.getAttribute(ae);if(s===null)return!0;let r=i.getAttribute(ke);return be.isFormInput(i)||i.getAttribute(t)!==null?(be.isUploadInput(i)&&be.mergeAttrs(i,e,{isIgnored:!0}),be.putPrivate(i,ae,e),!1):(ei.forEach(n=>{i.classList.contains(n)&&e.classList.add(n)}),e.setAttribute(ae,s),e.setAttribute(ke,r),!0)},cleanChildNodes(i,e){if(be.isPhxUpdate(i,e,["append","prepend"])){let t=[];i.childNodes.forEach(s=>{s.id||(!(s.nodeType===Node.TEXT_NODE&&s.nodeValue.trim()==="")&&s.nodeType!==s.COMMENT_NODE&&se(`only HTML element tags with an id are allowed inside containers with phx-update.

removing illegal node: "${(s.outerHTML||s.nodeValue).trim()}"

`),t.push(s))}),t.forEach(s=>s.remove())}},replaceRootContainer(i,e,t){let s=new Set(["id",_e,Ue,ni,Pe]);if(i.tagName.toLowerCase()===e.toLowerCase())return Array.from(i.attributes).filter(r=>!s.has(r.name.toLowerCase())).forEach(r=>i.removeAttribute(r.name)),Object.keys(t).filter(r=>!s.has(r.toLowerCase())).forEach(r=>i.setAttribute(r,t[r])),i;{let r=document.createElement(e);return Object.keys(t).forEach(n=>r.setAttribute(n,t[n])),s.forEach(n=>r.setAttribute(n,i.getAttribute(n))),r.innerHTML=i.innerHTML,i.replaceWith(r),r}},getSticky(i,e,t){let s=(be.private(i,"sticky")||[]).find(([r])=>e===r);if(s){let[r,n,o]=s;return o}else return typeof t=="function"?t():t},deleteSticky(i,e){this.updatePrivate(i,"sticky",[],t=>t.filter(([s,r])=>s!==e))},putSticky(i,e,t){let s=t(i);this.updatePrivate(i,"sticky",[],r=>{let n=r.findIndex(([o])=>e===o);return n>=0?r[n]=[e,t,s]:r.push([e,t,s]),r})},applyStickyOperations(i){let e=be.private(i,"sticky");!e||e.forEach(([t,s,r])=>this.putSticky(i,t,s))}},p=be;var Ie=class{static isActive(e,t){let s=t._phxRef===void 0,r=Ie.isPreflightInProgress(t),o=e.getAttribute(Pt).split(",").indexOf(q.genFileRef(t))>=0;return t.size>0&&(s||o||!r)}static isPreflighted(e,t){return e.getAttribute(at).split(",").indexOf(q.genFileRef(t))>=0&&this.isActive(e,t)}static isPreflightInProgress(e){return e._preflightInProgress===!0}static markPreflightInProgress(e){e._preflightInProgress=!0}constructor(e,t,s){this.ref=q.genFileRef(t),this.fileEl=e,this.file=t,this.view=s,this.meta=null,this._isCancelled=!1,this._isDone=!1,this._progress=0,this._lastProgressSent=-1,this._onDone=function(){},this._onElUpdated=this.onElUpdated.bind(this),this.fileEl.addEventListener(lt,this._onElUpdated)}metadata(){return this.meta}progress(e){this._progress=Math.floor(e),this._progress>this._lastProgressSent&&(this._progress>=100?(this._progress=100,this._lastProgressSent=100,this._isDone=!0,this.view.pushFileProgress(this.fileEl,this.ref,100,()=>{q.untrackFile(this.fileEl,this.file),this._onDone()})):(this._lastProgressSent=this._progress,this.view.pushFileProgress(this.fileEl,this.ref,this._progress)))}cancel(){this._isCancelled=!0,this._isDone=!0,this._onDone()}isDone(){return this._isDone}error(e="failed"){this.fileEl.removeEventListener(lt,this._onElUpdated),this.view.pushFileProgress(this.fileEl,this.ref,{error:e}),p.isAutoUpload(this.fileEl)||q.clearFiles(this.fileEl)}onDone(e){this._onDone=()=>{this.fileEl.removeEventListener(lt,this._onElUpdated),e()}}onElUpdated(){this.fileEl.getAttribute(Pt).split(",").indexOf(this.ref)===-1&&this.cancel()}toPreflightPayload(){return{last_modified:this.file.lastModified,name:this.file.name,relative_path:this.file.webkitRelativePath,size:this.file.size,type:this.file.type,ref:this.ref,meta:typeof this.file.meta=="function"?this.file.meta():void 0}}uploader(e){if(this.meta.uploader){let t=e[this.meta.uploader]||se(`no uploader configured for ${this.meta.uploader}`);return{name:this.meta.uploader,callback:t}}else return{name:"channel",callback:Mr}}zipPostFlight(e){this.meta=e.entries[this.ref],this.meta||se(`no preflight upload response returned with ref ${this.ref}`,{input:this.fileEl,response:e})}};var Co=0,q=class{static genFileRef(e){let t=e._phxRef;return t!==void 0?t:(e._phxRef=(Co++).toString(),e._phxRef)}static getEntryDataURL(e,t,s){let r=this.activeFiles(e).find(n=>this.genFileRef(n)===t);s(URL.createObjectURL(r))}static hasUploadsInProgress(e){let t=0;return p.findUploadInputs(e).forEach(s=>{s.getAttribute(at)!==s.getAttribute(yr)&&t++}),t>0}static serializeUploads(e){let t=this.activeFiles(e),s={};return t.forEach(r=>{let n={path:e.name},o=e.getAttribute(pe);s[o]=s[o]||[],n.ref=this.genFileRef(r),n.last_modified=r.lastModified,n.name=r.name||n.ref,n.relative_path=r.webkitRelativePath,n.type=r.type,n.size=r.size,typeof r.meta=="function"&&(n.meta=r.meta()),s[o].push(n)}),s}static clearFiles(e){e.value=null,e.removeAttribute(pe),p.putPrivate(e,"files",[])}static untrackFile(e,t){p.putPrivate(e,"files",p.private(e,"files").filter(s=>!Object.is(s,t)))}static trackFiles(e,t,s){if(e.getAttribute("multiple")!==null){let r=t.filter(n=>!this.activeFiles(e).find(o=>Object.is(o,n)));p.putPrivate(e,"files",this.activeFiles(e).concat(r)),e.value=null}else s&&s.files.length>0&&(e.files=s.files),p.putPrivate(e,"files",t)}static activeFileInputs(e){let t=p.findUploadInputs(e);return Array.from(t).filter(s=>s.files&&this.activeFiles(s).length>0)}static activeFiles(e){return(p.private(e,"files")||[]).filter(t=>Ie.isActive(e,t))}static inputsAwaitingPreflight(e){let t=p.findUploadInputs(e);return Array.from(t).filter(s=>this.filesAwaitingPreflight(s).length>0)}static filesAwaitingPreflight(e){return this.activeFiles(e).filter(t=>!Ie.isPreflighted(e,t)&&!Ie.isPreflightInProgress(t))}static markPreflightInProgress(e){e.forEach(t=>Ie.markPreflightInProgress(t.file))}constructor(e,t,s){this.view=t,this.onComplete=s,this._entries=Array.from(q.filesAwaitingPreflight(e)||[]).map(r=>new Ie(e,r,t)),q.markPreflightInProgress(this._entries),this.numEntriesInProgress=this._entries.length}entries(){return this._entries}initAdapterUpload(e,t,s){this._entries=this._entries.map(n=>(n.zipPostFlight(e),n.onDone(()=>{this.numEntriesInProgress--,this.numEntriesInProgress===0&&this.onComplete()}),n));let r=this._entries.reduce((n,o)=>{if(!o.meta)return n;let{name:a,callback:l}=o.uploader(s.uploaders);return n[a]=n[a]||{callback:l,entries:[]},n[a].entries.push(o),n},{});for(let n in r){let{callback:o,entries:a}=r[n];o(a,t,e,s)}}};var ko={LiveFileUpload:{activeRefs(){return this.el.getAttribute(Pt)},preflightedRefs(){return this.el.getAttribute(at)},mounted(){this.preflightedWas=this.preflightedRefs()},updated(){let i=this.preflightedRefs();this.preflightedWas!==i&&(this.preflightedWas=i,i===""&&this.__view.cancelSubmit(this.el.form)),this.activeRefs()===""&&(this.el.value=null),this.el.dispatchEvent(new CustomEvent(lt))}},LiveImgPreview:{mounted(){this.ref=this.el.getAttribute("data-phx-entry-ref"),this.inputEl=document.getElementById(this.el.getAttribute(pe)),q.getEntryDataURL(this.inputEl,this.ref,i=>{this.url=i,this.el.src=i})},destroyed(){URL.revokeObjectURL(this.url)}},FocusWrap:{mounted(){this.focusStart=this.el.firstElementChild,this.focusEnd=this.el.lastElementChild,this.focusStart.addEventListener("focus",()=>Be.focusLast(this.el)),this.focusEnd.addEventListener("focus",()=>Be.focusFirst(this.el)),this.el.addEventListener(`${B}:show-end`,()=>this.el.focus()),window.getComputedStyle(this.el).display!=="none"&&Be.focusFirst(this.el)}}},$r=ko;var vi=class{constructor(e,t,s){let r=new Set,n=new Set([...t.children].map(a=>a.id)),o=[];Array.from(e.children).forEach(a=>{if(a.id&&(r.add(a.id),n.has(a.id))){let l=a.previousElementSibling&&a.previousElementSibling.id;o.push({elementId:a.id,previousElementId:l})}}),this.containerId=t.id,this.updateType=s,this.elementsToModify=o,this.elementIdsToAdd=[...n].filter(a=>!r.has(a))}perform(){let e=p.byId(this.containerId);this.elementsToModify.forEach(t=>{t.previousElementId?Ae(document.getElementById(t.previousElementId),s=>{Ae(document.getElementById(t.elementId),r=>{r.previousElementSibling&&r.previousElementSibling.id==s.id||s.insertAdjacentElement("afterend",r)})}):Ae(document.getElementById(t.elementId),s=>{s.previousElementSibling==null||e.insertAdjacentElement("afterbegin",s)})}),this.updateType=="prepend"&&this.elementIdsToAdd.reverse().forEach(t=>{Ae(document.getElementById(t),s=>e.insertAdjacentElement("afterbegin",s))})}};var Ur=11;function Po(i,e){var t=e.attributes,s,r,n,o,a;if(!(e.nodeType===Ur||i.nodeType===Ur)){for(var l=t.length-1;l>=0;l--)s=t[l],r=s.name,n=s.namespaceURI,o=s.value,n?(r=s.localName||r,a=i.getAttributeNS(n,r),a!==o&&(s.prefix==="xmlns"&&(r=s.name),i.setAttributeNS(n,r,o))):(a=i.getAttribute(r),a!==o&&i.setAttribute(r,o));for(var c=i.attributes,f=c.length-1;f>=0;f--)s=c[f],r=s.name,n=s.namespaceURI,n?(r=s.localName||r,e.hasAttributeNS(n,r)||i.removeAttributeNS(n,r)):e.hasAttribute(r)||i.removeAttribute(r)}}var bi,Ro="http://www.w3.org/1999/xhtml",de=typeof document=="undefined"?void 0:document,Io=!!de&&"content"in de.createElement("template"),Lo=!!de&&de.createRange&&"createContextualFragment"in de.createRange();function Do(i){var e=de.createElement("template");return e.innerHTML=i,e.content.childNodes[0]}function Oo(i){bi||(bi=de.createRange(),bi.selectNode(de.body));var e=bi.createContextualFragment(i);return e.childNodes[0]}function Ho(i){var e=de.createElement("body");return e.innerHTML=i,e.childNodes[0]}function Mo(i){return i=i.trim(),Io?Do(i):Lo?Oo(i):Ho(i)}function yi(i,e){var t=i.nodeName,s=e.nodeName,r,n;return t===s?!0:(r=t.charCodeAt(0),n=s.charCodeAt(0),r<=90&&n>=97?t===s.toUpperCase():n<=90&&r>=97?s===t.toUpperCase():!1)}function No(i,e){return!e||e===Ro?de.createElement(i):de.createElementNS(e,i)}function Fo(i,e){for(var t=i.firstChild;t;){var s=t.nextSibling;e.appendChild(t),t=s}return e}function ys(i,e,t){i[t]!==e[t]&&(i[t]=e[t],i[t]?i.setAttribute(t,""):i.removeAttribute(t))}var Br={OPTION:function(i,e){var t=i.parentNode;if(t){var s=t.nodeName.toUpperCase();s==="OPTGROUP"&&(t=t.parentNode,s=t&&t.nodeName.toUpperCase()),s==="SELECT"&&!t.hasAttribute("multiple")&&(i.hasAttribute("selected")&&!e.selected&&(i.setAttribute("selected","selected"),i.removeAttribute("selected")),t.selectedIndex=-1)}ys(i,e,"selected")},INPUT:function(i,e){ys(i,e,"checked"),ys(i,e,"disabled"),i.value!==e.value&&(i.value=e.value),e.hasAttribute("value")||i.removeAttribute("value")},TEXTAREA:function(i,e){var t=e.value;i.value!==t&&(i.value=t);var s=i.firstChild;if(s){var r=s.nodeValue;if(r==t||!t&&r==i.placeholder)return;s.nodeValue=t}},SELECT:function(i,e){if(!e.hasAttribute("multiple")){for(var t=-1,s=0,r=i.firstChild,n,o;r;)if(o=r.nodeName&&r.nodeName.toUpperCase(),o==="OPTGROUP")n=r,r=n.firstChild;else{if(o==="OPTION"){if(r.hasAttribute("selected")){t=s;break}s++}r=r.nextSibling,!r&&n&&(r=n.nextSibling,n=null)}i.selectedIndex=t}}},Nt=1,Vr=11,jr=3,Xr=8;function Ve(){}function $o(i){if(i)return i.getAttribute&&i.getAttribute("id")||i.id}function Uo(i){return function(t,s,r){if(r||(r={}),typeof s=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var n=s;s=de.createElement("html"),s.innerHTML=n}else s=Mo(s);else s.nodeType===Vr&&(s=s.firstElementChild);var o=r.getNodeKey||$o,a=r.onBeforeNodeAdded||Ve,l=r.onNodeAdded||Ve,c=r.onBeforeElUpdated||Ve,f=r.onElUpdated||Ve,m=r.onBeforeNodeDiscarded||Ve,w=r.onNodeDiscarded||Ve,_=r.onBeforeElChildrenUpdated||Ve,S=r.skipFromChildren||Ve,E=r.addChild||function(k,x){return k.appendChild(x)},R=r.childrenOnly===!0,F=Object.create(null),L=[];function V(k){L.push(k)}function j(k,x){if(k.nodeType===Nt)for(var J=k.firstChild;J;){var D=void 0;x&&(D=o(J))?V(D):(w(J),J.firstChild&&j(J,x)),J=J.nextSibling}}function z(k,x,J){m(k)!==!1&&(x&&x.removeChild(k),w(k),j(k,J))}function Q(k){if(k.nodeType===Nt||k.nodeType===Vr)for(var x=k.firstChild;x;){var J=o(x);J&&(F[J]=x),Q(x),x=x.nextSibling}}Q(t);function X(k){l(k);for(var x=k.firstChild;x;){var J=x.nextSibling,D=o(x);if(D){var M=F[D];M&&yi(x,M)?(x.parentNode.replaceChild(M,x),g(M,x)):X(x)}else X(x);x=J}}function Z(k,x,J){for(;x;){var D=x.nextSibling;(J=o(x))?V(J):z(x,k,!0),x=D}}function g(k,x,J){var D=o(x);if(D&&delete F[D],!J){var M=c(k,x);if(M===!1||(M instanceof HTMLElement&&(k=M,Q(k)),i(k,x),f(k),_(k,x)===!1))return}k.nodeName!=="TEXTAREA"?P(k,x):Br.TEXTAREA(k,x)}function P(k,x){var J=S(k,x),D=x.firstChild,M=k.firstChild,Le,Se,Fe,$e,ge;e:for(;D;){for($e=D.nextSibling,Le=o(D);!J&&M;){if(Fe=M.nextSibling,D.isSameNode&&D.isSameNode(M)){D=$e,M=Fe;continue e}Se=o(M);var qe=M.nodeType,ne=void 0;if(qe===D.nodeType&&(qe===Nt?(Le?Le!==Se&&((ge=F[Le])?Fe===ge?ne=!1:(k.insertBefore(ge,M),Se?V(Se):z(M,k,!0),M=ge,Se=o(M)):ne=!1):Se&&(ne=!1),ne=ne!==!1&&yi(M,D),ne&&g(M,D)):(qe===jr||qe==Xr)&&(ne=!0,M.nodeValue!==D.nodeValue&&(M.nodeValue=D.nodeValue))),ne){D=$e,M=Fe;continue e}Se?V(Se):z(M,k,!0),M=Fe}if(Le&&(ge=F[Le])&&yi(ge,D))J||E(k,ge),g(ge,D);else{var Et=a(D);Et!==!1&&(Et&&(D=Et),D.actualize&&(D=D.actualize(k.ownerDocument||de)),E(k,D),X(D))}D=$e,M=Fe}Z(k,M,Se);var wt=Br[k.nodeName];wt&&wt(k,x)}var O=t,ee=O.nodeType,ye=s.nodeType;if(!R){if(ee===Nt)ye===Nt?yi(t,s)||(w(t),O=Fo(t,No(s.nodeName,s.namespaceURI))):O=s;else if(ee===jr||ee===Xr){if(ye===ee)return O.nodeValue!==s.nodeValue&&(O.nodeValue=s.nodeValue),O;O=s}}if(O===s)w(t);else{if(s.isSameNode&&s.isSameNode(O))return;if(g(O,s,R),L)for(var ot=0,yt=L.length;ot<yt;ot++){var St=F[L[ot]];St&&z(St,St.parentNode,!1)}}return!R&&O!==t&&t.parentNode&&(O.actualize&&(O=O.actualize(t.ownerDocument||de)),t.parentNode.replaceChild(O,t)),O}}var Bo=Uo(Po),Ss=Bo;var et=class{static patchEl(e,t,s){Ss(e,t,{childrenOnly:!1,onBeforeElUpdated:(r,n)=>{if(s&&s.isSameNode(r)&&p.isFormInput(r))return p.mergeFocusedInput(r,n),!1}})}constructor(e,t,s,r,n,o){this.view=e,this.liveSocket=e.liveSocket,this.container=t,this.id=s,this.rootID=e.root.id,this.html=r,this.streams=n,this.streamInserts={},this.streamComponentRestore={},this.targetCID=o,this.cidPatch=ve(this.targetCID),this.pendingRemoves=[],this.phxRemove=this.liveSocket.binding("remove"),this.callbacks={beforeadded:[],beforeupdated:[],beforephxChildAdded:[],afteradded:[],afterupdated:[],afterdiscarded:[],afterphxChildAdded:[],aftertransitionsDiscarded:[]}}before(e,t){this.callbacks[`before${e}`].push(t)}after(e,t){this.callbacks[`after${e}`].push(t)}trackBefore(e,...t){this.callbacks[`before${e}`].forEach(s=>s(...t))}trackAfter(e,...t){this.callbacks[`after${e}`].forEach(s=>s(...t))}markPrunableContentForRemoval(){let e=this.liveSocket.binding(ut);p.all(this.container,`[${e}=append] > *, [${e}=prepend] > *`,t=>{t.setAttribute(as,"")})}perform(e){let{view:t,liveSocket:s,container:r,html:n}=this,o=this.isCIDPatch()?this.targetCIDContainer(n):r;if(this.isCIDPatch()&&!o)return;let a=s.getActiveElement(),{selectionStart:l,selectionEnd:c}=a&&p.hasSelectionRange(a)?a:{},f=s.binding(ut),m=s.binding(Ge),w=s.binding(Ye),_=s.binding(Dt),S=s.binding(oi),E=s.binding(ai),R=s.binding(Sr),F=[],L=[],V=[],j=[],z=null;function Q(X,Z){Ss(X,Z,{childrenOnly:X.getAttribute(fe)===null,getNodeKey:g=>p.isPhxDestroyed(g)?null:e?g.id:g.id||g.getAttribute&&g.getAttribute(si),skipFromChildren:g=>g.getAttribute(f)===ci,addChild:(g,P)=>{let{ref:O,streamAt:ee}=this.getStreamInsert(P);if(O===void 0)return g.appendChild(P);if(this.setStreamRef(P,O),ee===0)g.insertAdjacentElement("afterbegin",P);else if(ee===-1)g.appendChild(P);else if(ee>0){let ye=Array.from(g.children)[ee];g.insertBefore(P,ye)}},onBeforeNodeAdded:g=>{this.trackBefore("added",g);let P=g;return!e&&this.streamComponentRestore[g.id]&&(P=this.streamComponentRestore[g.id],delete this.streamComponentRestore[g.id],Q.bind(this)(P,g)),P},onNodeAdded:g=>{g.getAttribute&&this.maybeReOrderStream(g,!0),p.isFeedbackContainer(g,m)&&L.push(g),g instanceof HTMLImageElement&&g.srcset?g.srcset=g.srcset:g instanceof HTMLVideoElement&&g.autoplay&&g.play(),p.isNowTriggerFormExternal(g,R)&&(z=g),(p.isPhxChild(g)&&t.ownsElement(g)||p.isPhxSticky(g)&&t.ownsElement(g.parentNode))&&this.trackAfter("phxChildAdded",g),F.push(g)},onNodeDiscarded:g=>this.onNodeDiscarded(g),onBeforeNodeDiscarded:g=>g.getAttribute&&g.getAttribute(as)!==null?!0:!(g.parentElement!==null&&g.id&&p.isPhxUpdate(g.parentElement,f,[ci,"append","prepend"])||this.maybePendingRemove(g)||this.skipCIDSibling(g)),onElUpdated:g=>{p.isNowTriggerFormExternal(g,R)&&(z=g),V.push(g),this.maybeReOrderStream(g,!1)},onBeforeElUpdated:(g,P)=>{if((p.isFeedbackContainer(g,m)||p.isFeedbackContainer(P,m))&&(L.push(g),L.push(P)),p.cleanChildNodes(P,f),this.skipCIDSibling(P))return this.maybeReOrderStream(g),!1;if(p.isPhxSticky(g))return!1;if(p.isIgnored(g,f)||g.form&&g.form.isSameNode(z))return this.trackBefore("updated",g,P),p.mergeAttrs(g,P,{isIgnored:!0}),V.push(g),p.applyStickyOperations(g),!1;if(g.type==="number"&&g.validity&&g.validity.badInput)return!1;if(!p.syncPendingRef(g,P,_))return p.isUploadInput(g)&&(this.trackBefore("updated",g,P),V.push(g)),p.applyStickyOperations(g),!1;if(p.isPhxChild(P)){let ye=g.getAttribute(_e);return p.mergeAttrs(g,P,{exclude:[Ue]}),ye!==""&&g.setAttribute(_e,ye),g.setAttribute(Pe,this.rootID),p.applyStickyOperations(g),!1}p.copyPrivates(P,g);let O=a&&g.isSameNode(a)&&p.isFormInput(g),ee=O&&this.isChangedSelect(g,P);return O&&g.type!=="hidden"&&!ee?(this.trackBefore("updated",g,P),p.mergeFocusedInput(g,P),p.syncAttrsToProps(g),V.push(g),p.applyStickyOperations(g),!1):(ee&&g.blur(),p.isPhxUpdate(P,f,["append","prepend"])&&j.push(new vi(g,P,P.getAttribute(f))),p.syncAttrsToProps(P),p.applyStickyOperations(P),this.trackBefore("updated",g,P),!0)}})}return this.trackBefore("added",r),this.trackBefore("updated",r,r),s.time("morphdom",()=>{this.streams.forEach(([X,Z,g,P])=>{Z.forEach(([O,ee,ye])=>{this.streamInserts[O]={ref:X,streamAt:ee,limit:ye,reset:P}}),P!==void 0&&p.all(r,`[${di}="${X}"]`,O=>{this.removeStreamChildElement(O)}),g.forEach(O=>{let ee=r.querySelector(`[id="${O}"]`);ee&&this.removeStreamChildElement(ee)})}),e&&p.all(this.container,`[${f}=${ci}]`,X=>{this.liveSocket.owner(X,Z=>{Z===this.view&&Array.from(X.children).forEach(g=>{this.removeStreamChildElement(g)})})}),Q.bind(this)(o,n)}),s.isDebugEnabled()&&Dr(s.doofinderMount),j.length>0&&s.time("post-morph append/prepend restoration",()=>{j.forEach(X=>X.perform())}),p.maybeHideFeedback(o,L,m,w),s.silenceEvents(()=>p.restoreFocus(a,l,c)),p.dispatchEvent(document,`${B}:update`),F.forEach(X=>this.trackAfter("added",X)),V.forEach(X=>this.trackAfter("updated",X)),this.transitionPendingRemoves(),z&&(s.unload(),Object.getPrototypeOf(z).submit.call(z)),!0}onNodeDiscarded(e){(p.isPhxChild(e)||p.isPhxSticky(e))&&this.liveSocket.destroyViewByEl(e),this.trackAfter("discarded",e)}maybePendingRemove(e){return e.getAttribute&&e.getAttribute(this.phxRemove)!==null?(this.pendingRemoves.push(e),!0):!1}removeStreamChildElement(e){this.streamInserts[e.id]?(this.streamComponentRestore[e.id]=e,e.remove()):this.maybePendingRemove(e)||(e.remove(),this.onNodeDiscarded(e))}getStreamInsert(e){return(e.id?this.streamInserts[e.id]:{})||{}}setStreamRef(e,t){p.putSticky(e,di,s=>s.setAttribute(di,t))}maybeReOrderStream(e,t){let{ref:s,streamAt:r,reset:n}=this.getStreamInsert(e);if(r!==void 0&&(this.setStreamRef(e,s),!(!n&&!t)&&!!e.parentElement)){if(r===0)e.parentElement.insertBefore(e,e.parentElement.firstElementChild);else if(r>0){let o=Array.from(e.parentElement.children),a=o.indexOf(e);if(r>=o.length-1)e.parentElement.appendChild(e);else{let l=o[r];a>r?e.parentElement.insertBefore(e,l):e.parentElement.insertBefore(e,l.nextElementSibling)}}this.maybeLimitStream(e)}}maybeLimitStream(e){let{limit:t}=this.getStreamInsert(e),s=t!==null&&Array.from(e.parentElement.children);t&&t<0&&s.length>t*-1?s.slice(0,s.length+t).forEach(r=>this.removeStreamChildElement(r)):t&&t>=0&&s.length>t&&s.slice(t).forEach(r=>this.removeStreamChildElement(r))}transitionPendingRemoves(){let{pendingRemoves:e,liveSocket:t}=this;e.length>0&&(t.transitionRemoves(e),t.requestDOMUpdate(()=>{e.forEach(s=>{let r=p.firstPhxChild(s);r&&t.destroyViewByEl(r),s.remove()}),this.trackAfter("transitionsDiscarded",e)}))}isChangedSelect(e,t){if(!(e instanceof HTMLSelectElement)||e.multiple)return!1;if(e.options.length!==t.options.length)return!0;let s=e.selectedOptions[0],r=t.selectedOptions[0];return s&&s.hasAttribute("selected")&&r.setAttribute("selected",s.getAttribute("selected")),!e.isEqualNode(t)}isCIDPatch(){return this.cidPatch}skipCIDSibling(e){return e.nodeType===Node.ELEMENT_NODE&&e.hasAttribute(ii)}targetCIDContainer(e){if(!this.isCIDPatch())return;let[t,...s]=p.findComponentNodeList(this.container,this.targetCID);return s.length===0&&p.childNodeLength(e)===1?t:t&&t.parentNode}indexOf(e,t){return Array.from(e.children).indexOf(t)}};var Vo=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),jo=new Set(["'",'"']),Jr=(i,e,t)=>{let s=0,r=!1,n,o,a,l,c,f,m=i.match(/^(\s*(?:<!--.*?-->\s*)*)<([^\s\/>]+)/);if(m===null)throw new Error(`malformed html ${i}`);for(s=m[0].length,n=m[1],a=m[2],l=s,s;s<i.length&&i.charAt(s)!==">";s++)if(i.charAt(s)==="="){let S=i.slice(s-3,s)===" id";s++;let E=i.charAt(s);if(jo.has(E)){let R=s;for(s++,s;s<i.length&&i.charAt(s)!==E;s++);if(S){c=i.slice(R+1,s);break}}}let w=i.length-1;for(r=!1;w>=n.length+a.length;){let S=i.charAt(w);if(r)S==="-"&&i.slice(w-3,w)==="<!-"?(r=!1,w-=4):w-=1;else if(S===">"&&i.slice(w-2,w)==="--")r=!0,w-=3;else{if(S===">")break;w-=1}}o=i.slice(w+1,i.length);let _=Object.keys(e).map(S=>e[S]===!0?S:`${S}="${e[S]}"`).join(" ");if(t){let S=c?` id="${c}"`:"";Vo.has(a)?f=`<${a}${S}${_===""?"":" "}${_}/>`:f=`<${a}${S}${_===""?"":" "}${_}></${a}>`}else{let S=i.slice(l,w+1);f=`<${a}${_===""?"":" "}${_}${S}`}return[f,n,o]},Ft=class{static extract(e){let{[gs]:t,[ms]:s,[_s]:r}=e;return delete e[gs],delete e[ms],delete e[_s],{diff:e,title:r,reply:t||null,events:s||[]}}constructor(e,t){this.viewId=e,this.rendered={},this.magicId=0,this.mergeDiff(t)}parentViewId(){return this.viewId}toString(e){let[t,s]=this.recursiveToString(this.rendered,this.rendered[le],e,!0,{});return[t,s]}recursiveToString(e,t=e[le],s,r,n){s=s?new Set(s):null;let o={buffer:"",components:t,onlyCids:s,streams:new Set};return this.toOutputBuffer(e,null,o,r,n),[o.buffer,o.streams]}componentCIDs(e){return Object.keys(e[le]||{}).map(t=>parseInt(t))}isComponentOnlyDiff(e){return e[le]?Object.keys(e).length===1:!1}getComponent(e,t){return e[le][t]}resetRender(e){this.rendered[le][e]&&(this.rendered[le][e].reset=!0)}mergeDiff(e){let t=e[le],s={};if(delete e[le],this.rendered=this.mutableMerge(this.rendered,e),this.rendered[le]=this.rendered[le]||{},t){let r=this.rendered[le];for(let n in t)t[n]=this.cachedFindComponent(n,t[n],r,t,s);for(let n in t)r[n]=t[n];e[le]=t}}cachedFindComponent(e,t,s,r,n){if(n[e])return n[e];{let o,a,l=t[we];if(ve(l)){let c;l>0?c=this.cachedFindComponent(l,r[l],s,r,n):c=s[-l],a=c[we],o=this.cloneMerge(c,t,!0),o[we]=a}else o=t[we]!==void 0||s[e]===void 0?t:this.cloneMerge(s[e],t,!1);return n[e]=o,o}}mutableMerge(e,t){return t[we]!==void 0?t:(this.doMutableMerge(e,t),e)}doMutableMerge(e,t){for(let s in t){let r=t[s],n=e[s];Ze(r)&&r[we]===void 0&&Ze(n)?this.doMutableMerge(n,r):e[s]=r}e[pi]&&(e.newRender=!0)}cloneMerge(e,t,s){let r=H(H({},e),t);for(let n in r){let o=t[n],a=e[n];Ze(o)&&o[we]===void 0&&Ze(a)?r[n]=this.cloneMerge(a,o,s):o===void 0&&Ze(a)&&(r[n]=this.cloneMerge(a,{},s))}return s?(delete r.magicId,delete r.newRender):e[pi]&&(r.newRender=!0),r}componentToString(e){let[t,s]=this.recursiveCIDToString(this.rendered[le],e,null),[r,n,o]=Jr(t,{});return[r,s]}pruneCIDs(e){e.forEach(t=>delete this.rendered[le][t])}get(){return this.rendered}isNewFingerprint(e={}){return!!e[we]}templateStatic(e,t){return typeof e=="number"?t[e]:e}nextMagicID(){return this.magicId++,`m${this.magicId}-${this.parentViewId()}`}toOutputBuffer(e,t,s,r,n={}){if(e[Mt])return this.comprehensionToBuffer(e,t,s);let{[we]:o}=e;o=this.templateStatic(o,t);let a=e[pi],l=s.buffer;a&&(s.buffer=""),r&&a&&!e.magicId&&(e.newRender=!0,e.magicId=this.nextMagicID()),s.buffer+=o[0];for(let c=1;c<o.length;c++)this.dynamicToBuffer(e[c-1],t,s,r),s.buffer+=o[c];if(a){let c=!1,f;r||e.magicId?(c=r&&!e.newRender,f=H({[si]:e.magicId},n)):f=n,c&&(f[ii]=!0);let[m,w,_]=Jr(s.buffer,f,c);e.newRender=!1,s.buffer=l+w+m+_}}comprehensionToBuffer(e,t,s){let{[Mt]:r,[we]:n,[vs]:o}=e,[a,l,c,f]=o||[null,{},[],null];n=this.templateStatic(n,t);let m=t||e[Lr];for(let w=0;w<r.length;w++){let _=r[w];s.buffer+=n[0];for(let S=1;S<n.length;S++){let E=!1;this.dynamicToBuffer(_[S-1],m,s,E),s.buffer+=n[S]}}o!==void 0&&(e[Mt].length>0||c.length>0||f)&&(delete e[vs],e[Mt]=[],s.streams.add(o))}dynamicToBuffer(e,t,s,r){if(typeof e=="number"){let[n,o]=this.recursiveCIDToString(s.components,e,s.onlyCids);s.buffer+=n,s.streams=new Set([...s.streams,...o])}else Ze(e)?this.toOutputBuffer(e,t,s,r,{}):s.buffer+=e}recursiveCIDToString(e,t,s){let r=e[t]||se(`no component for CID ${t}`,e),n={[fe]:t},o=s&&!s.has(t);r.newRender=!o,r.magicId=`c${t}-${this.parentViewId()}`;let a=!r.reset,[l,c]=this.recursiveToString(r,e,s,a,n);return delete r.reset,[l,c]}};var Xo=1,je=class{static makeID(){return Xo++}static elementID(e){return e.phxHookId}constructor(e,t,s){this.__view=e,this.liveSocket=e.liveSocket,this.__callbacks=s,this.__listeners=new Set,this.__isDisconnected=!1,this.el=t,this.el.phxHookId=this.constructor.makeID();for(let r in this.__callbacks)this[r]=this.__callbacks[r]}__mounted(){this.mounted&&this.mounted()}__updated(){this.updated&&this.updated()}__beforeUpdate(){this.beforeUpdate&&this.beforeUpdate()}__destroyed(){this.destroyed&&this.destroyed()}__reconnected(){this.__isDisconnected&&(this.__isDisconnected=!1,this.reconnected&&this.reconnected())}__disconnected(){this.__isDisconnected=!0,this.disconnected&&this.disconnected()}pushEvent(e,t={},s=function(){}){return this.__view.pushHookEvent(this.el,null,e,t,s)}pushEventTo(e,t,s={},r=function(){}){return this.__view.withinTargets(e,(n,o)=>n.pushHookEvent(this.el,o,t,s,r))}handleEvent(e,t){let s=(r,n)=>n?e:t(r.detail);return this.liveSocket.doofinderMount.addEventListener(`${B}:${e}`,s),this.__listeners.add(s),s}removeHandleEvent(e){let t=e(null,!0);this.liveSocket.doofinderMount.removeEventListener(`${B}:${t}`,e),this.__listeners.delete(e)}upload(e,t){return this.__view.dispatchUploads(null,e,t)}uploadTo(e,t,s){return this.__view.withinTargets(e,(r,n)=>{r.dispatchUploads(n,t,s)})}__cleanup__(){this.__listeners.forEach(e=>this.removeHandleEvent(e))}};var Si=(i,e,t=[])=>{let c=e,{submitter:s}=c,r=lr(c,["submitter"]),n;if(s&&s.name){let f=document.createElement("input");f.type="hidden";let m=s.getAttribute("form");m&&f.setAttribute("form",m),f.name=s.name,f.value=s.value,s.parentElement.insertBefore(f,s),n=f}let o=new FormData(i),a=[];o.forEach((f,m,w)=>{f instanceof File&&a.push(m)}),a.forEach(f=>o.delete(f));let l=new URLSearchParams;for(let[f,m]of o.entries())(t.length===0||t.indexOf(f)>=0)&&l.append(f,m);s&&n&&s.parentElement.removeChild(n);for(let f in r)l.append(f,r[f]);return l.toString()},_t=class{constructor(e,t,s,r,n){this.isDead=!1,this.liveSocket=t,this.flash=r,this.parent=s,this.root=s?s.root:this,this.el=e,this.id=this.el.id,this.ref=0,this.childJoins=0,this.loaderTimer=null,this.pendingDiffs=[],this.redirect=!1,this.href=null,this.joinCount=this.parent?this.parent.joinCount-1:0,this.joinPending=!0,this.destroyed=!1,this.joinCallback=function(o){o&&o()},this.stopCallback=function(){},this.pendingJoinOps=this.parent?null:[],this.viewHooks={},this.formSubmits=[],this.children=this.parent?null:{},this.root.children[this.id]={},this.channel=this.liveSocket.channel(`lv:${this.id}`,()=>{let o=this.href&&this.expandURL(this.href);return{redirect:this.redirect?o:void 0,url:this.redirect?void 0:o||void 0,params:this.connectParams(n),session:this.getSession(),static:this.getStatic(),flash:this.flash}})}setHref(e){this.href=e}setRedirect(e){this.redirect=!0,this.href=e}isMain(){return this.el.hasAttribute(ni)}connectParams(e){let t=this.liveSocket.params(this.el),s=p.all(document,`[${this.binding(br)}]`).map(r=>r.src||r.href).filter(r=>typeof r=="string");return s.length>0&&(t._track_static=s),t._mounts=this.joinCount,t._live_referer=e,t}isConnected(){return this.channel.canPush()}getSession(){return this.el.getAttribute(_e)}getStatic(){let e=this.el.getAttribute(Ue);return e===""?null:e}destroy(e=function(){}){this.destroyAllChildren(),this.destroyed=!0,delete this.root.children[this.id],this.parent&&delete this.root.children[this.parent.id][this.id],clearTimeout(this.loaderTimer);let t=()=>{e();for(let s in this.viewHooks)this.destroyHook(this.viewHooks[s])};p.markPhxChildDestroyed(this.el),this.log("destroyed",()=>["the child has been removed from the parent"]),this.channel.leave().receive("ok",t).receive("error",t).receive("timeout",t)}setContainerClasses(...e){this.el.classList.remove(hs,ht,It,cs,ri),this.el.classList.add(...e)}showLoader(e){if(clearTimeout(this.loaderTimer),e)this.loaderTimer=setTimeout(()=>this.showLoader(),e);else{for(let t in this.viewHooks)this.viewHooks[t].__disconnected();this.setContainerClasses(ht)}}execAll(e){p.all(this.el,`[${e}]`,t=>this.liveSocket.execJS(t,t.getAttribute(e)))}hideLoader(){clearTimeout(this.loaderTimer),this.setContainerClasses(hs),this.execAll(this.binding("connected"))}triggerReconnected(){for(let e in this.viewHooks)this.viewHooks[e].__reconnected()}log(e,t){this.liveSocket.log(this,e,t)}transition(e,t,s=function(){}){this.liveSocket.transition(e,t,s)}withinTargets(e,t){if(e instanceof HTMLElement||e instanceof SVGElement)return this.liveSocket.owner(e,s=>t(s,e));if(ve(e))p.findComponentNodeList(this.el,e).length===0?se(`no component found matching phx-target of ${e}`):t(this,parseInt(e));else{let s=Array.from(document.querySelectorAll(e));s.length===0&&se(`nothing found matching the phx-target selector "${e}"`),s.forEach(r=>this.liveSocket.owner(r,n=>t(n,r)))}}applyDiff(e,t,s){this.log(e,()=>["",mt(t)]);let{diff:r,reply:n,events:o,title:a}=Ft.extract(t);s({diff:r,reply:n,events:o}),a&&window.requestAnimationFrame(()=>p.putTitle(a))}onJoin(e){let{rendered:t,container:s}=e;if(s){let[r,n]=s;this.el=p.replaceRootContainer(this.el,r,n)}this.childJoins=0,this.joinPending=!0,this.flash=null,Re.dropLocal(this.liveSocket.localStorage,window.location.pathname,Zt),this.applyDiff("mount",t,({diff:r,events:n})=>{this.rendered=new Ft(this.id,r);let[o,a]=this.renderContainer(null,"join");this.dropPendingRefs();let l=this.formsForRecovery(o);this.joinCount++,l.length>0?l.forEach(([c,f,m],w)=>{this.pushFormRecovery(c,m,_=>{w===l.length-1&&this.onJoinComplete(_,o,a,n)})}):this.onJoinComplete(e,o,a,n)})}dropPendingRefs(){p.all(document,`[${ke}="${this.id}"][${ae}]`,e=>{e.removeAttribute(ae),e.removeAttribute(ke)})}onJoinComplete({live_patch:e},t,s,r){if(this.joinCount>1||this.parent&&!this.parent.isJoinPending())return this.applyJoinPatch(e,t,s,r);p.findPhxChildrenInFragment(t,this.id).filter(o=>{let a=o.id&&this.el.querySelector(`[id="${o.id}"]`),l=a&&a.getAttribute(Ue);return l&&o.setAttribute(Ue,l),a&&a.setAttribute(Pe,this.root.id),this.joinChild(o)}).length===0?this.parent?(this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,t,s,r)]),this.parent.ackJoin(this)):(this.onAllChildJoinsComplete(),this.applyJoinPatch(e,t,s,r)):this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,t,s,r)])}attachTrueDocEl(){this.el=p.byId(this.id),this.el.setAttribute(Pe,this.root.id)}execNewMounted(){let e=this.binding(oi),t=this.binding(ai);p.all(this.el,`[${e}], [${t}]`,s=>{this.maybeAddNewHook(s)}),p.all(this.el,`[${this.binding(dt)}], [data-phx-${dt}]`,s=>{this.maybeAddNewHook(s)}),p.all(this.el,`[${this.binding(fs)}]`,s=>this.maybeMounted(s))}applyJoinPatch(e,t,s,r){this.attachTrueDocEl();let n=new et(this,this.el,this.id,t,s,null);if(n.markPrunableContentForRemoval(),this.performPatch(n,!1,!0),this.joinNewChildren(),this.execNewMounted(),this.joinPending=!1,this.liveSocket.dispatchEvents(r),this.applyPendingUpdates(),e){let{kind:o,to:a}=e;this.liveSocket.historyPatch(a,o)}this.hideLoader(),this.joinCount>1&&this.triggerReconnected(),this.stopCallback()}triggerBeforeUpdateHook(e,t){this.liveSocket.triggerDOM("onBeforeElUpdated",[e,t]);let s=this.getHook(e),r=s&&p.isIgnored(e,this.binding(ut));if(s&&!e.isEqualNode(t)&&!(r&&Hr(e.dataset,t.dataset)))return s.__beforeUpdate(),s}maybeMounted(e){let t=e.getAttribute(this.binding(fs)),s=t&&p.private(e,"mounted");t&&!s&&(this.liveSocket.execJS(e,t),p.putPrivate(e,"mounted",!0))}maybeAddNewHook(e,t){let s=this.addHook(e);s&&s.__mounted()}performPatch(e,t,s=!1){let r=[],n=!1,o=new Set;return e.after("added",a=>{this.liveSocket.triggerDOM("onNodeAdded",[a]),this.maybeAddNewHook(a),a.getAttribute&&this.maybeMounted(a)}),e.after("phxChildAdded",a=>{p.isPhxSticky(a)?this.liveSocket.joinRootViews():n=!0}),e.before("updated",(a,l)=>{this.triggerBeforeUpdateHook(a,l)&&o.add(a.id)}),e.after("updated",a=>{o.has(a.id)&&this.getHook(a).__updated()}),e.after("discarded",a=>{a.nodeType===Node.ELEMENT_NODE&&r.push(a)}),e.after("transitionsDiscarded",a=>this.afterElementsRemoved(a,t)),e.perform(s),this.afterElementsRemoved(r,t),n}afterElementsRemoved(e,t){let s=[];e.forEach(r=>{let n=p.all(r,`[${fe}]`),o=p.all(r,`[${this.binding(dt)}]`);n.concat(r).forEach(a=>{let l=this.componentID(a);ve(l)&&s.indexOf(l)===-1&&s.push(l)}),o.concat(r).forEach(a=>{let l=this.getHook(a);l&&this.destroyHook(l)})}),t&&this.maybePushComponentsDestroyed(s)}joinNewChildren(){p.findPhxChildren(this.el,this.id).forEach(e=>this.joinChild(e))}getChildById(e){return this.root.children[this.id][e]}getDescendentByEl(e){return e.id===this.id?this:this.children[e.getAttribute(ze)][e.id]}destroyDescendent(e){for(let t in this.root.children)for(let s in this.root.children[t])if(s===e)return this.root.children[t][s].destroy()}joinChild(e){if(!this.getChildById(e.id)){let s=new _t(e,this.liveSocket,this);return this.root.children[this.id][s.id]=s,s.join(),this.childJoins++,!0}}isJoinPending(){return this.joinPending}ackJoin(e){this.childJoins--,this.childJoins===0&&(this.parent?this.parent.ackJoin(this):this.onAllChildJoinsComplete())}onAllChildJoinsComplete(){this.joinCallback(()=>{this.pendingJoinOps.forEach(([e,t])=>{e.isDestroyed()||t()}),this.pendingJoinOps=[]})}update(e,t){if(this.isJoinPending()||this.liveSocket.hasPendingLink()&&this.root.isMain())return this.pendingDiffs.push({diff:e,events:t});this.rendered.mergeDiff(e);let s=!1;this.rendered.isComponentOnlyDiff(e)?this.liveSocket.time("component patch complete",()=>{p.findParentCIDs(this.el,this.rendered.componentCIDs(e)).forEach(n=>{this.componentPatch(this.rendered.getComponent(e,n),n)&&(s=!0)})}):bs(e)||this.liveSocket.time("full patch complete",()=>{let[r,n]=this.renderContainer(e,"update"),o=new et(this,this.el,this.id,r,n,null);s=this.performPatch(o,!0)}),this.liveSocket.dispatchEvents(t),s&&this.joinNewChildren()}renderContainer(e,t){return this.liveSocket.time(`toString diff (${t})`,()=>{let s=this.el.tagName,r=e?this.rendered.componentCIDs(e):null,[n,o]=this.rendered.toString(r);return[`<${s}>${n}</${s}>`,o]})}componentPatch(e,t){if(bs(e))return!1;let[s,r]=this.rendered.componentToString(t),n=new et(this,this.el,this.id,s,r,t);return this.performPatch(n,!0)}getHook(e){return this.viewHooks[je.elementID(e)]}addHook(e){if(je.elementID(e)||!e.getAttribute)return;let t=e.getAttribute(`data-phx-${dt}`)||e.getAttribute(this.binding(dt));if(t&&!this.ownsElement(e))return;let s=this.liveSocket.getHookCallbacks(t);if(s){e.id||se(`no DOM ID for hook "${t}". Hooks require a unique ID on each element.`,e);let r=new je(this,e,s);return this.viewHooks[je.elementID(r.el)]=r,r}else t!==null&&se(`unknown hook found for "${t}"`,e)}destroyHook(e){e.__destroyed(),e.__cleanup__(),delete this.viewHooks[je.elementID(e.el)]}applyPendingUpdates(){this.pendingDiffs.forEach(({diff:e,events:t})=>this.update(e,t)),this.pendingDiffs=[],this.eachChild(e=>e.applyPendingUpdates())}eachChild(e){let t=this.root.children[this.id]||{};for(let s in t)e(this.getChildById(s))}onChannel(e,t){this.liveSocket.onChannel(this.channel,e,s=>{this.isJoinPending()?this.root.pendingJoinOps.push([this,()=>t(s)]):this.liveSocket.requestDOMUpdate(()=>t(s))})}bindChannel(){this.liveSocket.onChannel(this.channel,"diff",e=>{this.liveSocket.requestDOMUpdate(()=>{this.applyDiff("update",e,({diff:t,events:s})=>this.update(t,s))})}),this.onChannel("redirect",({to:e,flash:t})=>this.onRedirect({to:e,flash:t})),this.onChannel("live_patch",e=>this.onLivePatch(e)),this.onChannel("live_redirect",e=>this.onLiveRedirect(e)),this.channel.onError(e=>this.onError(e)),this.channel.onClose(e=>this.onClose(e))}destroyAllChildren(){this.eachChild(e=>e.destroy())}onLiveRedirect(e){let{to:t,kind:s,flash:r}=e,n=this.expandURL(t);this.liveSocket.historyRedirect(n,s,r)}onLivePatch(e){let{to:t,kind:s}=e;this.href=this.expandURL(t),this.liveSocket.historyPatch(t,s)}expandURL(e){return e.startsWith("/")?`${window.location.protocol}//${window.location.host}${e}`:e}onRedirect({to:e,flash:t}){this.liveSocket.redirect(e,t)}isDestroyed(){return this.destroyed}joinDead(){this.isDead=!0}join(e){this.showLoader(this.liveSocket.loaderTimeout),this.bindChannel(),this.isMain()&&(this.stopCallback=this.liveSocket.withPageLoading({to:this.href,kind:"initial"})),this.joinCallback=t=>{t=t||function(){},e?e(this.joinCount,t):t()},this.liveSocket.wrapPush(this,{timeout:!1},()=>this.channel.join().receive("ok",t=>{this.isDestroyed()||this.liveSocket.requestDOMUpdate(()=>this.onJoin(t))}).receive("error",t=>!this.isDestroyed()&&this.onJoinError(t)).receive("timeout",()=>!this.isDestroyed()&&this.onJoinError({reason:"timeout"})))}onJoinError(e){if(e.reason==="reload"){this.log("error",()=>[`failed mount with ${e.status}. Falling back to page request`,e]),this.isMain()&&this.onRedirect({to:this.href});return}else if(e.reason==="unauthorized"||e.reason==="stale"){this.log("error",()=>["unauthorized live_redirect. Falling back to page request",e]),this.isMain()&&this.onRedirect({to:this.href});return}if((e.redirect||e.live_redirect)&&(this.joinPending=!1,this.channel.leave()),e.redirect)return this.onRedirect(e.redirect);if(e.live_redirect)return this.onLiveRedirect(e.live_redirect);this.displayError([ht,It,ri]),this.log("error",()=>["unable to join",e]),this.liveSocket.isConnected()&&this.liveSocket.reloadWithJitter(this)}onClose(e){if(!this.isDestroyed()){if(this.liveSocket.hasPendingLink()&&e!=="leave")return this.liveSocket.reloadWithJitter(this);this.destroyAllChildren(),this.liveSocket.dropActiveElement(this),document.activeElement&&document.activeElement.blur(),this.liveSocket.isUnloaded()&&this.showLoader(kr)}}onError(e){this.onClose(e),this.liveSocket.isConnected()&&this.log("error",()=>["view crashed",e]),this.liveSocket.isUnloaded()||(this.liveSocket.isConnected()?this.displayError([ht,It,ri]):this.displayError([ht,It,cs]))}displayError(e){this.isMain()&&p.dispatchEvent(window,`${B}:page-loading-start`,{detail:{to:this.href,kind:"error"}}),this.showLoader(),this.setContainerClasses(...e),this.execAll(this.binding("disconnected"))}pushWithReply(e,t,s,r=function(){}){if(!this.isConnected())return;let[n,[o],a]=e?e():[null,[],{}],l=function(){};return(a.page_loading||o&&o.getAttribute(this.binding(ls))!==null)&&(l=this.liveSocket.withPageLoading({kind:"element",target:o})),typeof s.cid!="number"&&delete s.cid,this.liveSocket.wrapPush(this,{timeout:!0},()=>this.channel.push(t,s,Rr).receive("ok",c=>{let f=m=>{c.redirect&&this.onRedirect(c.redirect),c.live_patch&&this.onLivePatch(c.live_patch),c.live_redirect&&this.onLiveRedirect(c.live_redirect),l(),r(c,m)};c.diff?this.liveSocket.requestDOMUpdate(()=>{this.applyDiff("update",c.diff,({diff:m,reply:w,events:_})=>{n!==null&&this.undoRefs(n),this.update(m,_),f(w)})}):(n!==null&&this.undoRefs(n),f(null))}))}undoRefs(e){!this.isConnected()||p.all(document,`[${ke}="${this.id}"][${ae}="${e}"]`,t=>{let s=t.getAttribute(Qe),r=t.getAttribute(hi);t.removeAttribute(ae),t.removeAttribute(ke),r!==null&&(t.readOnly=r==="true",t.removeAttribute(hi)),s!==null&&(t.disabled=s==="true",t.removeAttribute(Qe)),ei.forEach(a=>p.removeClass(t,a));let n=t.getAttribute(Ot);n!==null&&(t.innerText=n,t.removeAttribute(Ot));let o=p.private(t,ae);if(o){let a=this.triggerBeforeUpdateHook(t,o);et.patchEl(t,o,this.liveSocket.getActiveElement()),a&&a.__updated(),p.deletePrivate(t,ae)}})}putRef(e,t,s={}){let r=this.ref++,n=this.binding(Dt);return s.loading&&(e=e.concat(p.all(document,s.loading))),e.forEach(o=>{o.classList.add(`phx-${t}-loading`),o.setAttribute(ae,r),o.setAttribute(ke,this.el.id);let a=o.getAttribute(n);a!==null&&(o.getAttribute(Ot)||o.setAttribute(Ot,o.innerText),a!==""&&(o.innerText=a),o.setAttribute(Qe,o.getAttribute(Qe)||o.disabled),o.setAttribute("disabled",""))}),[r,e,s]}componentID(e){let t=e.getAttribute&&e.getAttribute(fe);return t?parseInt(t):null}targetComponentID(e,t,s={}){if(ve(t))return t;let r=s.target||e.getAttribute(this.binding("target"));return ve(r)?parseInt(r):t&&(r!==null||s.target)?this.closestComponentID(t):null}closestComponentID(e){return ve(e)?e:e?Ae(e.closest(`[${fe}]`),t=>this.ownsElement(t)&&this.componentID(t)):null}pushHookEvent(e,t,s,r,n){if(!this.isConnected())return this.log("hook",()=>["unable to push hook event. LiveView not connected",s,r]),!1;let[o,a,l]=this.putRef([e],"hook");return this.pushWithReply(()=>[o,a,l],"event",{type:"hook",event:s,value:r,cid:this.closestComponentID(t)},(c,f)=>n(f,o)),o}extractMeta(e,t,s){let r=this.binding("value-");for(let n=0;n<e.attributes.length;n++){t||(t={});let o=e.attributes[n].name;o.startsWith(r)&&(t[o.replace(r,"")]=e.getAttribute(o))}if(e.value!==void 0&&!(e instanceof HTMLFormElement)&&(t||(t={}),t.value=e.value,e.tagName==="INPUT"&&li.indexOf(e.type)>=0&&!e.checked&&delete t.value),s){t||(t={});for(let n in s)t[n]=s[n]}return t}pushEvent(e,t,s,r,n,o={},a){this.pushWithReply(()=>this.putRef([t],e,o),"event",{type:e,event:r,value:this.extractMeta(t,n,o.value),cid:this.targetComponentID(t,s,o)},(l,c)=>a&&a(c))}pushFileProgress(e,t,s,r=function(){}){this.liveSocket.withinOwners(e.form,(n,o)=>{n.pushWithReply(null,"progress",{event:e.getAttribute(n.binding(xr)),ref:e.getAttribute(pe),entry_ref:t,progress:s,cid:n.targetComponentID(e.form,o)},r)})}pushInput(e,t,s,r,n,o){let a,l=ve(s)?s:this.targetComponentID(e.form,t,n),c=()=>this.putRef([e,e.form],"change",n),f,m=this.extractMeta(e.form);e instanceof HTMLButtonElement&&(m.submitter=e),e.getAttribute(this.binding("change"))?f=Si(e.form,H({_target:n._target},m),[e.name]):f=Si(e.form,H({_target:n._target},m)),p.isUploadInput(e)&&e.files&&e.files.length>0&&q.trackFiles(e,Array.from(e.files)),a=q.serializeUploads(e);let w={type:"form",event:r,value:f,uploads:a,cid:l};this.pushWithReply(c,"event",w,_=>{if(p.showError(e,this.liveSocket.binding(Ge),this.liveSocket.binding(Ye)),p.isUploadInput(e)&&p.isAutoUpload(e)){if(q.filesAwaitingPreflight(e).length>0){let[S,E]=c();this.uploadFiles(e.form,t,S,l,R=>{o&&o(_),this.triggerAwaitingSubmit(e.form),this.undoRefs(S)})}}else o&&o(_)})}triggerAwaitingSubmit(e){let t=this.getScheduledSubmit(e);if(t){let[s,r,n,o]=t;this.cancelSubmit(e),o()}}getScheduledSubmit(e){return this.formSubmits.find(([t,s,r,n])=>t.isSameNode(e))}scheduleSubmit(e,t,s,r){if(this.getScheduledSubmit(e))return!0;this.formSubmits.push([e,t,s,r])}cancelSubmit(e){this.formSubmits=this.formSubmits.filter(([t,s,r])=>t.isSameNode(e)?(this.undoRefs(s),!1):!0)}disableForm(e,t={}){let s=m=>!(gt(m,`${this.binding(ut)}=ignore`,m.form)||gt(m,"data-phx-update=ignore",m.form)),r=m=>m.hasAttribute(this.binding(Dt)),n=m=>m.tagName=="BUTTON",o=m=>["INPUT","TEXTAREA","SELECT"].includes(m.tagName),a=Array.from(e.elements),l=a.filter(r),c=a.filter(n).filter(s),f=a.filter(o).filter(s);return c.forEach(m=>{m.setAttribute(Qe,m.disabled),m.disabled=!0}),f.forEach(m=>{m.setAttribute(hi,m.readOnly),m.readOnly=!0,m.files&&(m.setAttribute(Qe,m.disabled),m.disabled=!0)}),e.setAttribute(this.binding(ls),""),this.putRef([e].concat(l).concat(c).concat(f),"submit",t)}pushFormSubmit(e,t,s,r,n,o){let a=()=>this.disableForm(e,n),l=this.targetComponentID(e,t);if(q.hasUploadsInProgress(e)){let[c,f]=a(),m=()=>this.pushFormSubmit(e,t,s,r,n,o);return this.scheduleSubmit(e,c,n,m)}else if(q.inputsAwaitingPreflight(e).length>0){let[c,f]=a(),m=()=>[c,f,n];this.uploadFiles(e,t,c,l,w=>{let _=this.extractMeta(e),S=Si(e,H({submitter:r},_));this.pushWithReply(m,"event",{type:"form",event:s,value:S,cid:l},o)})}else if(!(e.hasAttribute(ae)&&e.classList.contains("phx-submit-loading"))){let c=this.extractMeta(e),f=Si(e,H({submitter:r},c));this.pushWithReply(a,"event",{type:"form",event:s,value:f,cid:l},o)}}uploadFiles(e,t,s,r,n){let o=this.joinCount,a=q.activeFileInputs(e),l=a.length;a.forEach(c=>{let f=new q(c,this,()=>{l--,l===0&&n()}),m=f.entries().map(_=>_.toPreflightPayload());if(m.length===0){l--;return}let w={ref:c.getAttribute(pe),entries:m,cid:this.targetComponentID(c.form,t)};this.log("upload",()=>["sending preflight request",w]),this.pushWithReply(null,"allow_upload",w,_=>{if(this.log("upload",()=>["got preflight response",_]),_.error){this.undoRefs(s);let[S,E]=_.error;this.log("upload",()=>[`error for entry ${S}`,E])}else{let S=E=>{this.channel.onError(()=>{this.joinCount===o&&E()})};f.initAdapterUpload(_,S,this.liveSocket)}})})}dispatchUploads(e,t,s){let r=this.targetCtxElement(e)||this.el,n=p.findUploadInputs(r).filter(o=>o.name===t);n.length===0?se(`no live file inputs found matching the name "${t}"`):n.length>1?se(`duplicate live file inputs found matching the name "${t}"`):p.dispatchEvent(n[0],ti,{detail:{files:s}})}targetCtxElement(e){if(ve(e)){let[t]=p.findComponentNodeList(this.el,e);return t}else return e||null}pushFormRecovery(e,t,s){this.liveSocket.withinOwners(e,(r,n)=>{let o=this.binding("change"),a=Array.from(e.elements).filter(f=>p.isFormInput(f)&&f.name&&!f.hasAttribute(o));if(a.length===0)return;a.forEach(f=>f.hasAttribute(pe)&&q.clearFiles(f));let l=a.find(f=>f.type!=="hidden")||a[0],c=e.getAttribute(this.binding(us))||e.getAttribute(this.binding("change"));te.exec("change",c,r,l,["push",{_target:l.name,newCid:t,callback:s}])})}pushLinkPatch(e,t,s){let r=this.liveSocket.setPendingLink(e),n=t?()=>this.putRef([t],"click"):null,o=()=>this.liveSocket.redirect(window.location.href),a=e.startsWith("/")?`${location.protocol}//${location.host}${e}`:e,l=this.pushWithReply(n,"live_patch",{url:a},c=>{this.liveSocket.requestDOMUpdate(()=>{c.link_redirect?this.liveSocket.replaceMain(e,null,s,r):(this.liveSocket.commitPendingLink(r)&&(this.href=e),this.applyPendingUpdates(),s&&s(r))})});l?l.receive("timeout",o):o()}formsForRecovery(e){if(this.joinCount===0)return[];let t=this.binding("change"),s=document.createElement("template");return s.innerHTML=e,p.all(this.el,`form[${t}]`).filter(r=>r.id&&this.ownsElement(r)).filter(r=>r.elements.length>0).filter(r=>r.getAttribute(this.binding(us))!=="ignore").map(r=>{let n=CSS.escape(r.getAttribute(t)),o=s.content.querySelector(`form[id="${r.id}"][${t}="${n}"]`);return o?[r,o,this.targetComponentID(o)]:[r,r,this.targetComponentID(r)]}).filter(([r,n,o])=>n)}maybePushComponentsDestroyed(e){let t=e.filter(s=>p.findComponentNodeList(this.el,s).length===0);t.length>0&&(t.forEach(s=>this.rendered.resetRender(s)),this.pushWithReply(null,"cids_will_destroy",{cids:t},()=>{let s=t.filter(r=>p.findComponentNodeList(this.el,r).length===0);s.length>0&&this.pushWithReply(null,"cids_destroyed",{cids:s},r=>{this.rendered.pruneCIDs(r.cids)})}))}ownsElement(e){let t=e.closest(He);return e.getAttribute(ze)===this.id||t&&t.id===this.id||!t&&this.isDead}submitForm(e,t,s,r,n={}){p.putPrivate(e,ct,!0);let o=this.liveSocket.binding(Ge),a=this.liveSocket.binding(Ye),l=Array.from(e.elements);l.forEach(c=>p.putPrivate(c,ct,!0)),this.liveSocket.blurActiveElement(this),this.pushFormSubmit(e,t,s,r,n,()=>{l.forEach(c=>p.showError(c,o,a)),this.liveSocket.restorePreviouslyActiveFocus()})}binding(e){return this.liveSocket.binding(e)}};var $t=class{constructor(e,t,s={}){if(this.unloaded=!1,!t||t.constructor.name==="Object")throw new Error(`
      a phoenix Socket must be provided as the second argument to the LiveSocket constructor. For example:

          import {Socket} from "phoenix"
          import {LiveSocket} from "phoenix_live_view"
          let liveSocket = new LiveSocket("/live", Socket, {...})
      `);this.socket=new t(e,s),this.bindingPrefix=s.bindingPrefix||Pr,this.opts=s,this.params=gi(s.params||{}),this.viewLogger=s.viewLogger,this.metadataCallbacks=s.metadata||{},this.defaults=Object.assign(mt(Ir),s.defaults||{}),this.activeElement=null,this.prevActive=null,this.silenced=!1,this.main=null,this.outgoingMainEl=null,this.clickStartedAtTarget=null,this.linkRef=1,this.roots={},this.href=window.location.href,this.pendingLink=null,this.currentLocation=mt(window.location),this.hooks=s.hooks||{},this.uploaders=s.uploaders||{},this.loaderTimeout=s.loaderTimeout||Cr,this.reloadWithJitterTimer=null,this.maxReloads=s.maxReloads||mr,this.reloadJitterMin=s.reloadJitterMin||gr,this.reloadJitterMax=s.reloadJitterMax||_r,this.failsafeJitter=s.failsafeJitter||vr,this.localStorage=s.localStorage||window.localStorage,this.sessionStorage=s.sessionStorage||window.sessionStorage,this.boundTopLevelEvents=!1,this.domCallbacks=Object.assign({onNodeAdded:gi(),onBeforeElUpdated:gi()},s.dom||{}),this.doofinderMount=s.doofinderMount,this.connectCallback=s.connectCallback||(()=>{}),this.disconnectCallback=s.disconnectCallback||(()=>{}),this.unbindFunctions=[],this.transitions=new qr,window.addEventListener("pagehide",r=>{this.unloaded=!0}),this.socket.onOpen(()=>{this.isUnloaded()&&window.location.reload()}),this.socket.onOpen(()=>{this.connectCallback()})}isProfileEnabled(){return this.sessionStorage.getItem(ui)==="true"}isDebugEnabled(){return this.sessionStorage.getItem(Ht)==="true"}isDebugDisabled(){return this.sessionStorage.getItem(Ht)==="false"}enableDebug(){this.sessionStorage.setItem(Ht,"true")}enableProfiling(){this.sessionStorage.setItem(ui,"true")}disableDebug(){this.sessionStorage.setItem(Ht,"false")}disableProfiling(){this.sessionStorage.removeItem(ui)}enableLatencySim(e){this.enableDebug(),console.log("latency simulator enabled for the duration of this browser session. Call disableLatencySim() to disable"),this.sessionStorage.setItem(fi,e)}disableLatencySim(){this.sessionStorage.removeItem(fi)}getLatencySim(){let e=this.sessionStorage.getItem(fi);return e?parseInt(e):null}getSocket(){return this.socket}connect(){window.location.hostname==="localhost"&&!this.isDebugDisabled()&&this.enableDebug(),this.joinRootViews()&&(this.bindTopLevelEvents(),this.socket.connect())}disconnect(e){clearTimeout(this.reloadWithJitterTimer),this.socket.disconnect(e)}replaceTransport(e){clearTimeout(this.reloadWithJitterTimer),this.socket.replaceTransport(e),this.connect()}execJS(e,t,s=null){this.owner(e,r=>te.exec(s,t,r,e))}execJSHookPush(e,t,s,r){this.withinOwners(e,n=>{te.exec("hook",t,n,e,["push",{data:s,callback:r}])})}unload(){this.unloaded||(this.main&&this.isConnected()&&this.log(this.main,"socket",()=>["disconnect for page nav"]),this.unloaded=!0,this.destroyAllViews(),this.disconnect())}triggerDOM(e,t){this.domCallbacks[e](...t)}time(e,t){if(!this.isProfileEnabled()||!console.time)return t();console.time(e);let s=t();return console.timeEnd(e),s}log(e,t,s){if(this.viewLogger){let[r,n]=s();this.viewLogger(e,t,r,n)}else if(this.isDebugEnabled()){let[r,n]=s();Or(e,t,r,n)}}requestDOMUpdate(e){this.transitions.after(e)}transition(e,t,s=function(){}){this.transitions.addTransition(e,t,s)}onChannel(e,t,s){e.on(t,r=>{let n=this.getLatencySim();n?setTimeout(()=>s(r),n):s(r)})}wrapPush(e,t,s){let r=this.getLatencySim(),n=e.joinCount;if(!r)return this.isConnected()&&t.timeout?s().receive("timeout",()=>{e.joinCount===n&&!e.isDestroyed()&&this.reloadWithJitter(e,()=>{this.log(e,"timeout",()=>["received timeout while communicating with server. Falling back to hard refresh for recovery"])})}):s();let o={receives:[],receive(a,l){this.receives.push([a,l])}};return setTimeout(()=>{e.isDestroyed()||o.receives.reduce((a,[l,c])=>a.receive(l,c),s())},r),o}reloadWithJitter(e,t){clearTimeout(this.reloadWithJitterTimer),this.disconnect();let s=this.reloadJitterMin,r=this.reloadJitterMax,n=Math.floor(Math.random()*(r-s+1))+s;Re.updateLocal(this.localStorage,window.location.pathname,Zt,0,a=>a+1)>this.maxReloads&&(n=this.failsafeJitter),this.reloadWithJitterTimer=setTimeout(()=>{this.disconnectCallback()},n)}getHookCallbacks(e){return e&&e.startsWith("Phoenix.")?$r[e.split(".")[1]]:this.hooks[e]}isUnloaded(){return this.unloaded}isConnected(){return this.socket.isConnected()}getBindingPrefix(){return this.bindingPrefix}binding(e){return`${this.getBindingPrefix()}${e}`}channel(e,t){return this.socket.channel(e,t)}joinRootViews(){if(this.doofinderMount){let e=this.newRootView(this.doofinderMount);return e.setHref(this.getHref()),e.join(),this.main=e,!0}else return!1}redirect(e,t){this.disconnect(this.disconnectCallback),Re.redirect(e,t)}replaceMain(e,t,s=null,r=this.setPendingLink(e)){let n=this.currentLocation.href;this.outgoingMainEl=this.outgoingMainEl||this.main.el;let o=p.cloneNode(this.outgoingMainEl,"");this.main.showLoader(this.loaderTimeout),this.main.destroy(),this.main=this.newRootView(o,t,n),this.main.setRedirect(e),this.transitionRemoves(null,!0),this.main.join((a,l)=>{a===1&&this.commitPendingLink(r)&&this.requestDOMUpdate(()=>{p.findPhxSticky(document).forEach(c=>o.appendChild(c)),this.outgoingMainEl.replaceWith(o),this.outgoingMainEl=null,s&&s(r),l()})})}transitionRemoves(e,t){let s=this.binding("remove");if(e=e||p.all(document,`[${s}]`),t){let r=p.findPhxSticky(document)||[];e=e.filter(n=>!p.isChildOfAny(n,r))}e.forEach(r=>{this.execJS(r,r.getAttribute(s),"remove")})}isPhxView(e){return e.getAttribute&&e.getAttribute(_e)!==null}newRootView(e,t,s){let r=new _t(e,this,null,t,s);return this.roots[r.id]=r,r}owner(e,t){let s=Ae(e.closest(He),r=>this.getViewByEl(r))||this.main;s&&t(s)}withinOwners(e,t){this.owner(e,s=>t(s,e))}getViewByEl(e){let t=e.getAttribute(Pe);return Ae(this.getRootById(t),s=>s.getDescendentByEl(e))}getRootById(e){return this.roots[e]}destroyAllViews(){for(let e in this.roots)this.roots[e].destroy(),delete this.roots[e];this.main=null}destroyViewByEl(e){let t=this.getRootById(e.getAttribute(Pe));t&&t.id===e.id?(t.destroy(),delete this.roots[t.id]):t&&t.destroyDescendent(e.id)}setActiveElement(e){if(this.activeElement===e)return;this.activeElement=e;let t=()=>{e===this.activeElement&&(this.activeElement=null),e.removeEventListener("mouseup",this),e.removeEventListener("touchend",this)};e.addEventListener("mouseup",t),e.addEventListener("touchend",t)}getActiveElement(){return document.activeElement===document.body?this.activeElement||document.activeElement:document.activeElement||document.body}dropActiveElement(e){this.prevActive&&e.ownsElement(this.prevActive)&&(this.prevActive=null)}restorePreviouslyActiveFocus(){this.prevActive&&this.prevActive!==document.body&&this.prevActive.focus()}blurActiveElement(){this.prevActive=this.getActiveElement(),this.prevActive!==document.body&&this.prevActive.blur()}bindTopLevelEvents({dead:e}={}){this.boundTopLevelEvents||(this.boundTopLevelEvents=!0,this.socket.onClose(t=>{if(t&&t.code===1e3&&this.main)return this.reloadWithJitter(this.main)}),this.unbindFunctions.push((()=>{let t=function(){};return document.body.addEventListener("click",t),function(){document.body.removeEventListener("click",t)}})()),window.addEventListener("pageshow",t=>{t.persisted&&(this.getSocket().disconnect(),this.withPageLoading({to:window.location.href,kind:"redirect"}),window.location.reload())},!0),this.bindClicks(),e||this.bindForms(),this.bind({keyup:"keyup",keydown:"keydown"},(t,s,r,n,o,a)=>{let l=n.getAttribute(this.binding(Tr)),c=t.key&&t.key.toLowerCase();if(l&&l.toLowerCase()!==c)return;let f=H({key:t.key},this.eventMeta(s,t,n));te.exec(s,o,r,n,["push",{data:f}])}),this.bind({blur:"focusout",focus:"focusin"},(t,s,r,n,o,a)=>{if(!a){let l=H({key:t.key},this.eventMeta(s,t,n));te.exec(s,o,r,n,["push",{data:l}])}}),this.bind({blur:"blur",focus:"focus"},(t,s,r,n,o,a)=>{if(a==="window"){let l=this.eventMeta(s,t,n);te.exec(s,o,r,n,["push",{data:l}])}}),this.unbindFunctions.push((()=>{let t=s=>s.preventDefault();return this.doofinderMount.addEventListener("dragover",t),()=>this.doofinderMount.removeEventListener("dragover",t)})()),this.unbindFunctions.push((()=>{let t=s=>{s.preventDefault();let r=Ae(gt(s.target,this.binding(os)),a=>a.getAttribute(this.binding(os))),n=r&&document.getElementById(r),o=Array.from(s.dataTransfer.files||[]);!n||n.disabled||o.length===0||!(n.files instanceof FileList)||(q.trackFiles(n,o,s.dataTransfer),n.dispatchEvent(new Event("input",{bubbles:!0})))};return this.doofinderMount.addEventListener("drop",t),()=>this.doofinderMount.removeEventListener("drop",t)})()),this.on(ti,t=>{let s=t.target;if(!p.isUploadInput(s))return;let r=Array.from(t.detail.files||[]).filter(n=>n instanceof File||n instanceof Blob);q.trackFiles(s,r),s.dispatchEvent(new Event("input",{bubbles:!0}))},this.doofinderMount))}unbindTopLevelEvents(){this.unbindFunctions.forEach(e=>e()),this.unbindFunctions=[]}eventMeta(e,t,s){let r=this.metadataCallbacks[e];return r?r(t,s):{}}setPendingLink(e){return this.linkRef++,this.pendingLink=e,this.linkRef}commitPendingLink(e){return this.linkRef!==e?!1:(this.href=this.pendingLink,this.pendingLink=null,!0)}getHref(){return this.href}hasPendingLink(){return!!this.pendingLink}bind(e,t){for(let s in e){let r=e[s];this.on(r,n=>{let o=this.binding(s),a=this.binding(`window-${s}`),l=n.target.getAttribute&&n.target.getAttribute(o);l?this.debounce(n.target,n,r,()=>{this.withinOwners(n.target,c=>{t(n,s,c,n.target,l,null)})}):p.all(document,`[${a}]`,c=>{let f=c.getAttribute(a);this.debounce(c,n,r,()=>{this.withinOwners(c,m=>{t(n,s,m,c,f,"window")})})})},this.doofinderMount)}}bindClicks(){let e=t=>{this.clickStartedAtTarget=t.target};this.doofinderMount.addEventListener("click",e),this.unbindFunctions.push(()=>this.doofinderMount.removeEventListener("click",e)),this.bindClick("click","click",!1),this.bindClick("mousedown","capture-click",!0)}bindClick(e,t,s){let r=this.binding(t),n=o=>{if(!this.isConnected())return;let a=null;if(s)a=o.target.matches(`[${r}]`)?o.target:o.target.querySelector(`[${r}]`);else{o.detail===0&&(this.clickStartedAtTarget=o.target);let c=this.clickStartedAtTarget||o.target;a=gt(c,r),this.dispatchClickAway(o,c),this.clickStartedAtTarget=null}let l=a&&a.getAttribute(r);if(!l){!s&&p.isNewPageClick(o,window.location)&&this.unload();return}a.getAttribute("href")==="#"&&o.preventDefault(),!a.hasAttribute(ae)&&(a.disabled||this.debounce(a,o,"click",()=>{this.withinOwners(a,c=>{te.exec("click",l,c,a,["push",{data:this.eventMeta("click",o,a)}])})}))};this.doofinderMount.addEventListener(e,n,s),this.unbindFunctions.push(()=>this.doofinderMount.removeEventListener(e,n,s))}dispatchClickAway(e,t){let s=this.binding("click-away");p.all(document,`[${s}]`,r=>{r.isSameNode(t)||r.contains(t)||this.withinOwners(r,n=>{let o=r.getAttribute(s);te.isVisible(r)&&te.isInViewport(r)&&te.exec("click",o,n,r,["push",{data:this.eventMeta("click",e,e.target)}])})})}maybeScroll(e){typeof e=="number"&&requestAnimationFrame(()=>{window.scrollTo(0,e)})}dispatchEvent(e,t={}){p.dispatchEvent(this.doofinderMount,`${B}:${e}`,{detail:t})}dispatchEvents(e){e.forEach(([t,s])=>this.dispatchEvent(t,s))}withPageLoading(e,t){p.dispatchEvent(this.doofinderMount,`${B}:page-loading-start`,{detail:e});let s=()=>p.dispatchEvent(this.doofinderMount,`${B}:page-loading-stop`,{detail:e});return t?t(s):s}pushHistoryPatch(e,t,s){if(!this.isConnected()||!this.main.isMain())return Re.redirect(e);this.withPageLoading({to:e,kind:"patch"},r=>{this.main.pushLinkPatch(e,s,n=>{this.historyPatch(e,t,n),r()})})}historyPatch(e,t,s=this.setPendingLink(e)){!this.commitPendingLink(s)||(Re.pushState(t,{type:"patch",id:this.main.id},e),p.dispatchEvent(window,`${B}:navigate`,{detail:{patch:!0,href:e,pop:!1}}),this.registerNewLocation(window.location))}historyRedirect(e,t,s){if(!this.isConnected()||!this.main.isMain())return Re.redirect(e,s);if(/^\/$|^\/[^\/]+.*$/.test(e)){let{protocol:n,host:o}=window.location;e=`${n}//${o}${e}`}let r=window.scrollY;this.withPageLoading({to:e,kind:"redirect"},n=>{this.replaceMain(e,s,o=>{o===this.linkRef&&(Re.pushState(t,{type:"redirect",id:this.main.id,scroll:r},e),p.dispatchEvent(window,`${B}:navigate`,{detail:{href:e,patch:!1,pop:!1}}),this.registerNewLocation(window.location)),n()})})}replaceRootHistory(){Re.pushState("replace",{root:!0,type:"patch",id:this.main.id})}registerNewLocation(e){let{pathname:t,search:s}=this.currentLocation;return t+s===e.pathname+e.search?!1:(this.currentLocation=mt(e),!0)}bindForms(){let e=0,t=!1;this.on("submit",s=>{let r=s.target.getAttribute(this.binding("submit")),n=s.target.getAttribute(this.binding("change"));!t&&n&&!r&&(t=!0,s.preventDefault(),s.stopPropagation(),this.withinOwners(s.target,o=>{o.disableForm(s.target),window.requestAnimationFrame(()=>{p.isUnloadableFormSubmit(s)&&this.unload(),s.target.submit()})}))},this.doofinderMount),this.on("submit",s=>{let r=s.target.getAttribute(this.binding("submit"));if(!r){p.isUnloadableFormSubmit(s)&&this.unload();return}s.preventDefault(),s.stopPropagation(),s.target.disabled=!0,this.withinOwners(s.target,n=>{te.exec("submit",r,n,s.target,["push",{submitter:s.submitter}])})},this.doofinderMount);for(let s of["change","input"])this.on(s,r=>{r.stopPropagation();let n=this.binding("change"),o=r.target,a=o.getAttribute(n),l=o.form&&o.form.getAttribute(n),c=a||l;if(!c||o.type==="number"&&o.validity&&o.validity.badInput)return;let f=a?o:o.form,m=e;e++;let{at:w,type:_}=p.private(o,"prev-iteration")||{};w===m-1&&s==="change"&&_==="input"||(p.putPrivate(o,"prev-iteration",{at:m,type:s}),this.debounce(o,r,s,()=>{this.withinOwners(f,S=>{p.putPrivate(o,Lt,!0),p.isTextualInput(o)||this.setActiveElement(o),te.exec("change",c,S,o,["push",{_target:r.target.name,dispatcher:f}])})}))},this.doofinderMount);this.on("reset",s=>{let r=s.target;p.resetForm(r,this.binding(Ge),this.binding(Ye));let n=Array.from(r.elements).find(o=>o.type==="reset");n&&window.requestAnimationFrame(()=>{n.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!1}))})})}debounce(e,t,s,r){if(s==="blur"||s==="focusout")return r();let n=this.binding(wr),o=this.binding(Ar),a=this.defaults.debounce.toString(),l=this.defaults.throttle.toString();this.withinOwners(e,c=>{let f=()=>!c.isDestroyed()&&document.body.contains(e);p.debounce(e,t,n,a,o,l,f,()=>{r()})})}silenceEvents(e){this.silenced=!0,e(),this.silenced=!1}on(e,t,s=window){let r=n=>{this.silenced||t(n)};s.addEventListener(e,r),this.unbindFunctions.push(function(){s.removeEventListener(e,r)})}},qr=class{constructor(){this.transitions=new Set,this.pendingOps=[]}reset(){this.transitions.forEach(e=>{clearTimeout(e),this.transitions.delete(e)}),this.flushPendingOps()}after(e){this.size()===0?e():this.pushPendingOp(e)}addTransition(e,t,s){t();let r=setTimeout(()=>{this.transitions.delete(r),s(),this.flushPendingOps()},e);this.transitions.add(r)}pushPendingOp(e){this.pendingOps.push(e)}size(){return this.transitions.size}flushPendingOps(){if(this.size()>0)return;let e=this.pendingOps.shift();e&&(e(),this.flushPendingOps())}};var Es=class{constructor(e){let{url:t,mount:s,hooks:r,params:n,mainHook:o,appName:a,disconnectCallback:l}=e,c={hooks:r,doofinderMount:s,params:n,metadata:{click:function(f){return{keys:{altKey:f.altKey,shiftKey:f.shiftKey,ctrlKey:f.ctrlKey,metaKey:f.metaKey}}}},disconnectCallback:l};this.__mainHook=o,this.__socket=new $t(t,ns,c),this.__appName=a}get connected(){return this.__socket.isConnected()}enableDebug(){this.__socket.enableDebug()}disableDebug(){this.__socket.disableDebug()}setPreventReconnect(e=!1){this.__socket.preventReconnect=e}getHooksByName(e){if(this.connected){let t=this.__socket.doofinderMount,s=this.__socket.getViewByEl(t);return Array.from(t.querySelectorAll(`[dfd-hook="${e}"]`)).map(n=>s.getHook(n))}else return[]}connect(e){this.connected||this.__socket.connect(),Doofinder.Session.setLive(this.__appName),e()}disconnect(e){this.__socket.unbindTopLevelEvents(),this.__socket.destroyAllViews(),this.__socket.disconnect(e),this.__socket=null}pushEvent(e,t={},s=void 0){let[r]=this.getHooksByName(this.__mainHook);if(!r)throw new Error(`${this.__mainHook} hook is not ready!`);r.pushEvent(e,t,s)}};var Jo="df-cookies-allowed",qo=window.localStorage;function Wr(){return JSON.parse(qo.getItem(Jo)||"false")}var vt=class{constructor(e,t){this._bucket=e,this._store=t||window.localStorage}get data(){return JSON.parse(this._store.getItem(this._bucket))||{}}set data(e){!Wr()||this._store.setItem(this._bucket,JSON.stringify(e))}getItem(e){return this.data[e]}setItem(e,t){let s=this.data;s[e]=t,this.data=s}removeItem(e){let t=this.data;delete t[e],this.data=t}clear(){this.data={}}destroy(){this._store.removeItem(this._bucket)}popItem(e){let t=this.data,s=t[e];return delete t[e],this.data=t,s}};var ws="dfd-animate",As="dfd-fixed-layout",Me="hidden",Ei="floating",wi="fullscreen",tt="static";function Ai(i){let e=["left","top","right","bottom","width","height","scrollLeft","scrollTop","scrollWidth","scrollHeight"],t=e.reduce((r,n)=>(r[n]=0,r),{}),s=i;if(s===window)t=xe(H({},t),{width:s.outerWidth,height:s.outerHeight,clientWidth:s.innerWidth,clientHeight:s.innerHeight,scrollLeft:s.scrollX,scrollTop:s.scrollY,scrollWidth:document.scrollWidth,scrollHeight:document.scrollHeight});else{if(s===document)s=document.documentElement,t=xe(H({},t),{width:s.offsetWidth,height:s.offsetHeight});else if(s.getBoundingClientRect){let r=s.getBoundingClientRect();t=e.reduce((n,o)=>(n[o]=r[o],n),{})}t=xe(H({},t),{clientWidth:s.clientWidth,clientHeight:s.clientHeight,scrollLeft:s.scrollLeft,scrollTop:s.scrollTop,scrollWidth:s.scrollWidth,scrollHeight:s.scrollHeight})}return t}function Kr(i){let e=i;for(;e&&getComputedStyle(e).position!=="fixed";)e=e.offsetParent;return!!e}"use strict";var Ts=class{constructor(e,t={}){this.options=H({align:t.align,offsetX:0,offsetY:4,marginY:20,marginX:20,fillViewPortWidth:768},t),this.element=e}__origin__(e){let t=Ai(e),s=Ai(document),r=s.width<=this.options.fillViewPortWidth,n={width:t.width,top:t.top+t.height,left:t.left,fixed:Kr(e),align:function(){let o=Math.abs(t.left)*100/s.width,a=Math.abs(s.clientWidth-t.right)*100/s.width;switch(!0){case r:case Math.abs(o-a)<=15:return"center";case o<a:return"left";default:return"right"}}(),fillViewPort:r};return n.fixed||(n.top+=Math.abs(s.scrollTop),n.left+=Math.abs(s.scrollLeft)),n}update(e){let t=this.__origin__(e),s=document.documentElement,r=this.options.align||t.align,n=s.clientHeight-t.top-this.options.marginY,o=this.options.offsetX,a=this.options.offsetY;if(this.element.style.maxWidth=null,this.element.style.height=null,r!=="center"&&(this.element.style.marginLeft=null),this.element.style.position=t.fixed?"fixed":"absolute",r==="left"){let l=s.clientWidth-t.left-this.options.marginX,c=t.left;this.element.style.maxWidth=`${l-o}px`,this.element.style.left=`${c+o}px`,this.element.style.right=null}else if(r==="right"){let l=t.left+t.width-this.options.marginX+o,c=s.clientWidth-t.left-t.width;this.element.style.maxWidth=`${l+o}px`,this.element.style.right=`${c-o}px`,this.element.style.left=null}else{let l=s.clientWidth-t.left-t.width,c=Math.min(this.options.marginX,t.left,l);this.element.style.maxWidth=`${s.clientWidth-2*c}px`,this.element.style.left="50%",this.element.style.marginLeft=`-${Ai(this.element).width/2}px`}this.element.style.top=`${t.top+a}px`,this.element.getAttribute("data-dfd-screen")=="brand-categories"?this.element.offsetHeight>n-a&&(this.element.style.height=`${n-a}px`):this.element.style.height=`${n-a}px`}destroy(){["position","top","left","right","height","maxWidth","marginLeft"].forEach(e=>this.element.style[e]=null),this.options=null,this.element=null}};function Ti(i,e=66,t=!1){let s;return function(...r){s?Date.now()-s>=e?(i(...r),s=Date.now()):t&&console.log("throttle: discard execution"):(i(...r),s=Date.now())}}var it=class{constructor(e){this.mount=e,this._positionReference=null}__animate__(){return new Promise(e=>{setTimeout(()=>{this.mount.classList.add(ws),e()},10)})}get positionReference(){return this._positionReference}show(){return I(this,null,function*(){let e=this.hidden();return e&&(this.mount.removeAttribute(Me),yield this.__animate__()),e})}hide(){return I(this,null,function*(){let e=!this.hidden();return e&&(this.mount.setAttribute(Me,""),this.mount.classList.remove(ws),this.mount.innerHTML=""),e})}updatePosition(e){return I(this,null,function*(){this._positionReference=e.positionReference})}destroy(){this.mount=void 0}hidden(){return this.mount.hasAttribute(Me)}};var xs=class extends it{constructor(e,t={}){super(e);this.handleWindowChange=Ti(this.handleWindowChange.bind(this)),this._position=new Ts(this.mount,t)}__addListeners__(){window.addEventListener("resize",this.handleWindowChange,{passive:!0})}__removeListeners__(){window.removeEventListener("resize",this.handleWindowChange)}get position(){return this._position}handleWindowChange(){this._position.update(this._positionReference)}show(){var e=t=>super[t];return I(this,null,function*(){let s=this.hidden();return s&&(this.mount.style.opacity="0",this.mount.removeAttribute(Me)),this._position.update(this._positionReference),s&&(this.mount.setAttribute(Me,""),this.mount.style.opacity=null,yield e("show").call(this),this.__addListeners__()),s})}hide(){var e=t=>super[t];return I(this,null,function*(){let s=!this.hidden();return s&&(this.__removeListeners__(),yield e("hide").call(this)),s})}updatePosition(e){var t=s=>super[s];return I(this,null,function*(){t("updatePosition").call(this,e),setTimeout(()=>{this._position.update(this._positionReference)},100)})}destroy(){this.__removeListeners__(),this._position.destroy(),this._position=null,super.destroy()}};var Cs=class extends it{show(){var e=t=>super[t];return I(this,null,function*(){let s=this.hidden();return s&&(document.documentElement.classList.add(As),yield e("show").call(this)),s})}hide(){var e=t=>super[t];return I(this,null,function*(){let s=yield e("hide").call(this);return s&&document.documentElement.classList.remove(As),s})}};function bt(i=8){let e="";for(;e.length<i;)e=`${e}${Math.random().toString(36).substring(2)}`;return e.substr(0,i)}var Wo=10,Ko=500;function ks(i,e={}){let t=document.querySelector(i);return t?Promise.resolve(t):new Promise((s,r)=>{let n=0,o=null,a=e.interval||Ko,l=e.times||Wo;o=setInterval(function(){n++<l?(t=document.querySelector(i),t&&(clearInterval(o),s(t))):(clearInterval(o),r(`selector '${i}' not found`))},a)})}var Ps="data-dfd-id",xi="data-dfd-display",Ci="data-dfd-mount-id",ki="wrapper",Pi="wrapper-source",zo=`insertion method should be one of ${["append","prepend","before","after","replace","replace-content"].join(" | ")}`,Rs=class{constructor(e,t=tt,s={}){this._type=null,this._insertionPoint=null,this._insertionMethod=null,this._screenType=null,this._theme=null,this._mount=e,this._displayMethod=null,this.setType(t,s)}__place__(){return I(this,arguments,function*(e={}){if(!(e.insertionPoint===this._insertionPoint&&e.insertionMethod===this._insertionMethod)){this._insertionPoint=e.insertionPoint||"body",this._insertionMethod=this.__resolveInsertionMethod__(e.insertionMethod);try{this.__placeMount__()}catch(t){console.warn("insertion point not found, falling back to body",t),this._insertionPoint="body",this._insertionMethod="append",this.__placeMount__()}}})}__resolveInsertionMethod__(e="append"){return this._insertionPoint==="body"&&!["append","prepend"].includes(e)?"append":e}__resolveInsertionPoint__(){return I(this,null,function*(){let e=yield ks(this._insertionPoint);return this._insertionMethod==="replace"?this.__wrapMount__(e):(this.__unwrapMount__(),e)})}__resolveInsertionPosition__(){switch(this._insertionMethod){case"before":return"beforebegin";case"replace":case"replace-content":case"prepend":return"afterbegin";case"append":return"beforeend";case"after":return"afterend";default:throw zo}}__placeMount__(){return I(this,null,function*(){let e=yield this.__resolveInsertionPoint__(),t=this.__resolveInsertionPosition__();this._insertionMethod==="replace-content"&&(e.innerHTML=""),e.insertAdjacentElement(t,this._mount)})}__getWrapperElement__(e){return document.querySelector(`[${xi}="${e}"][${Ci}="${this._mount.id}"]`)}__ensureElementId__(e){return e.setAttribute("id",e.getAttribute("id")||`dfd-${bt(16)}`),e.getAttribute("id")}__wrapMount__(e){let t=this.__ensureElementId__(e),s=e.cloneNode(!1);return s.setAttribute(Ps,t),s.setAttribute(xi,ki),s.setAttribute(Ci,this._mount.id),e.setAttribute(Ps,t),e.setAttribute(xi,Pi),e.setAttribute(Ci,this._mount.id),e.insertAdjacentElement("beforebegin",s),this.__updateWrap__(),s}__unwrapMount__(){let e=this.__getWrapperElement__(ki),t=this.__getWrapperElement__(Pi);e&&(e.insertAdjacentElement("beforebegin",this._mount),e.remove(),t&&(t.setAttribute("id",t.dataset.dfdId),t.removeAttribute(Ps),t.removeAttribute(xi),t.removeAttribute(Ci),t.removeAttribute("hidden")))}__updateWrap__(){let e=this.__getWrapperElement__(this.hidden?Pi:ki),t=this.__getWrapperElement__(this.hidden?ki:Pi);!e||!t||(e.setAttribute("id",e.dataset.dfdId),e.removeAttribute("hidden"),t.removeAttribute("id"),t.setAttribute("hidden",""))}get type(){return this._type}get method(){return this._displayMethod}get hidden(){return this._displayMethod.hidden()}get screenType(){return this._screenType}set screenType(e){this._mount.setAttribute("data-dfd-screen",e),this._screenType=e}show(){return I(this,null,function*(){yield this._displayMethod.show(),this.__updateWrap__()})}hide(){return I(this,null,function*(){yield this._displayMethod.hide(),this.__updateWrap__()})}setType(e,t={}){var s;if(e!==this._type)switch(this._type=e,(s=this._displayMethod)==null||s.destroy(),e){case Ei:this._displayMethod=new xs(this._mount,{align:t.align});break;case wi:this._displayMethod=new Cs(this._mount);break;case tt:default:this._displayMethod=new it(this._mount)}this.__place__(t.placement)}updateTheme(e){if(e!==this._theme){let t=`dfd-${e}`,s=`dfd-${this._theme}`;e&&this._theme?this._mount.classList.replace(s,t):e?this._mount.classList.add(t):this._theme&&this._mount.classList.remove(s),this._theme=e}}updatePosition(e){var t;(t=this._displayMethod)==null||t.updatePosition(e)}destroy(){return I(this,null,function*(){var e;yield this.hide(),(e=this._displayMethod)==null||e.destroy(),this._displayMethod=null,this._mount=null,this._type=null,this._insertionPoint=null,this._insertionMethod=null,this._theme=null})}};var Is=class{constructor(e){this.el=document.createComment(e),document.body.appendChild(this.el)}on(e,t){if(this._checkReady())return this.el.addEventListener(e,t,{passive:!0}),()=>this.off(e,t)}once(e,t){if(this._checkReady())return this.el.addEventListener(e,t,{once:!0,passive:!0}),()=>this.off(e,t)}off(e,t){this._checkReady()&&this.el.removeEventListener(e,t)}emit(e,t){if(this._checkReady()){let s=new CustomEvent(e,{detail:t,bubbles:!1,cancelable:!1,composed:!1});this.el.dispatchEvent(s)}}teardown(){this._checkReady()&&(this.el=this.el.remove())}_checkReady(){if(this.el)return!0;throw new Error("tried to access a dead event bus!")}};var Ls="__DF_DEBUG_MODE__",zr="true",Ri=window.sessionStorage;function Gr(){Ri.setItem(Ls,zr)}function Yr(){Ri.removeItem(Ls)}function Qr(){return Ri.getItem(Ls)===zr}function Ds(i){return Ri.getItem(i)||window[i]}function C(...i){Qr()&&console.log("[doofinder]",...i)}var Zr=function(i){let e=i.slice(0,4);return RegExp(`#${e}/(brand-categories|classic|classic-initial|embedded|fullscreen|fullscreen-brand-categories|fullscreen-initial|mobile|mobile-brand-categories|mobile-initial)/`)},en=function(i){let e=i.slice(0,4);return RegExp(`#${e}/(category-pages|mobile-category-pages)/`)};"use strict";var Ne=window.history,Ii=class{constructor({installationId:e,autoload:t,urlHash:s,layerType:r}){this._installationId=e,this._layerType=r,this._autoload=t?Object.freeze(t):null,this._urlHash=s,this._storage=new vt(`${e}.data`,window.sessionStorage),this.__initialSetup__()}get hasAutoloadQueryParam(){return this.__getQueryFromAutoload__()!==null}get isTransitory(){return this._isTransitory}get query(){return this.__getQuery__()}get targetItemId(){return this._targetItemId}get value(){return this._value}set targetItemId(e){this._targetItemId=e}saveTransitory(e){if(!this.__valid__(this._value)){C(`[state] [${this._layerType}] saveTransitory: not valid for `,this._value);return}C(`[state] [${this._layerType}] saveTransitory:`,this._value),this._storage.setItem(this.__getStateKey__(),{value:this.__simplify__(this._value),location:e})}update(e,t,s){if(!this.__hasChanged__(e,t,s))return C(`[state] [${this._layerType}] update not performed, the state has not changed.`,e,t,s),!1;this.__valid__(e)&&(C(`[state] [${this._layerType}] new state value: `,e),this._value=e),this._targetItemId=t,this._isTransitory=s;let r=window.location.origin+window.location.pathname+window.location.search;this._urlHash&&(r=r+this._value),C(`[state] [${this._layerType}] replaceState:`,r),Ne.replaceState(this.__getNewStateObject__(),"",r)}__hasChanged__(e,t,s){return e!=this._value||t!=this._targetItemId||s!=this._isTransitory}__initialSetup__(){let e=this.__fromStorage__(),t=this.__fromHistory__()||e||this.__fromHash__()||this.__fromAutoload__()||"";t=t.match("^#([A-Za-z0-9-]+)/(embedded|classic)/$")?"":t,this._value=t,this._targetItemId=this.__getTargetItem__(),this._isTransitory=this.__isTransitory__(!!e),e&&Ne.replaceState(this.__getNewStateObject__(),"",window.location.href)}__fromAutoload__(){if(!this._autoload)return C(`[state] [${this._layerType}] __fromAutoload__ with autoload false - state:`,null),null;let e=this.__getQueryFromAutoload__(),t=e!=null?`#/${this._autoload.screen}/q=${e.trim()}`:null;return C(`[state] [${this._layerType}] __fromAutoload__ (query) state:`,t),t}__fromHash__(){let e=this.__validHash__(window.location.hash)?`#${window.location.hash.split("#",2)[1]}`:null;return C(`[state] [${this._layerType}] __fromHash__ state:`,e),e}__fromHistory__(){let e=null;return this.__validDoofinderStateInHistory__()&&(e=Ne.state[this.__getStateKey__()].value),C(`[state] [${this._layerType}] __fromHistory__ state:`,e),e}__fromStorage__(){let e=this._storage.popItem(this.__getStateKey__());return!!e&&!window.location.href.includes(e.location)?(C(`[state] [${this._layerType}] __fromStorage__ discarded as it is from diferent location:`,e),null):(C(`[state] [${this._layerType}] __fromStorage__ state:`,e),!!e&&e.value)}__getNewStateObject__(){let e={[this.__getStateKey__()]:{value:this._value,transitory:this._isTransitory,targetItemId:this._targetItemId}};return C(`[state] [${this._layerType}] __getNewStateObject__:`,e),this.__validHistoryState__()?H(H({},Ne.state),e):e}__getQuery__(){if(this._value){let e=this._value.split("/"),t=e[e.length-1];return Object.fromEntries(new URLSearchParams(t)).q}return""}__getQueryFromAutoload__(){return this._autoload?new URLSearchParams(window.location.search).get(this._autoload.param):null}__getTargetItem__(){let e=null;return this.__validDoofinderStateInHistory__()&&(e=Ne.state[this.__getStateKey__()].targetItemId),C(`[state] [${this._layerType}] __getTargetItem__:`,e),e}__getStateKey__(){return this._layerType=="category_pages"?Ii.CP_STATE_KEY:Ii.STATE_KEY}__isTransitory__(e){let t=e;return this.__validDoofinderStateInHistory__()&&(t=Ne.state[this.__getStateKey__()].transitory),C(`[state] [${this._layerType}] __isTransitory__:`,t),t}__simplify__(e){var o;let s=new URL(window.location.origin+window.location.pathname+window.location.search+e).hash.split("/"),r=(o=s.pop())!=null?o:"",n=Object.fromEntries(r.split("&").map(a=>a.split("=")));return(n==null?void 0:n.q)?`${s.join("/")}/m=${n.m}&q=${n.q}`:""}__valid__(e){return this.__validHash__(e)||e===""}__validHistoryState__(){return typeof Ne.state=="object"&&Ne.state!==null}__validDoofinderStateInHistory__(){return this.__validHistoryState__()&&Ne.state[this.__getStateKey__()]!=null}__validHash__(e){let t=this._layerType!=="category_pages"?Zr(this._installationId):en(this._installationId);return typeof e=="string"&&(t.test(e)||e.startsWith(`#/${this._installationId}/`))}},st=Ii;is(st,"STATE_KEY","dfState"),is(st,"CP_STATE_KEY","dfCpState");var Os="df:trigger:click",Ut="df:trigger:focus",Bt="df:trigger:input",Hs="df:trigger:submit";var rt=1;"use strict";var Go="[dfd-carousel-btn-left]",Yo="[dfd-carousel-btn-right]",tn="[dfd-carousel-content]",Li="ltr",sn={mounted(){this.btnLeftEl=this.el.querySelector(Go),this.btnRightEl=this.el.querySelector(Yo),this.contentEl=this.el.querySelector(tn),getComputedStyle(this.contentEl).direction==="rtl"&&(Li="rtl"),this.getVisibleChildren=()=>{let i=this.contentEl.getBoundingClientRect();return Array.from(this.contentEl.children).filter(e=>{let t=e.getBoundingClientRect();return i.left<=t.left&&i.right>=t.right})},this.nextPage=()=>{let i=this.getVisibleChildren();if(i.length<=0)return;let e=i.slice(-1).pop(),t=e.nextElementSibling;if(!t)return;let s=this.contentEl.getBoundingClientRect(),r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=r.width,a=t?n.x-r.x-r.width:0,l;Li==="ltr"?l=this.contentEl.scrollLeft+(r.x-s.x):l=this.contentEl.scrollLeft-(r.x+s.x),this.contentEl.scroll({left:l+o+a/2,behavior:"smooth"})},this.previousPage=()=>{let i=this.getVisibleChildren();if(i.length<=0)return;let e=i[0],t=e.previousElementSibling;if(!t)return;let s=this.contentEl.getBoundingClientRect(),r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=n.width-(s.x-n.x),a=t?r.x-n.x-n.width:0,l;Li==="ltr"?l=this.contentEl.scrollLeft-s.width:l=this.contentEl.scrollLeft+s.width,this.contentEl.scroll({left:l+o+a/2,behavior:"smooth"})},this.btnLeftEl.addEventListener("click",this.previousPage),this.btnRightEl.addEventListener("click",this.nextPage),this.tag.dispatch("doofinder.carousel.load")},updated(){this.contentEl=this.el.querySelector(tn),getComputedStyle(this.contentEl).direction==="rtl"&&(Li="rtl"),this.tag.dispatch("doofinder.carousel.update")},destroyed(){this.btnLeftEl.removeEventListener("click",this.previousPage),this.btnRightEl.removeEventListener("click",this.nextPage)}};var Di=240;function Qo(i){return!!i.type.match(/image\/.*/)}function rn(i){return I(this,null,function*(){if(!Qo(i))throw"invalid image, can't search";let e=yield nn(i),t=yield Zo(e);return yield nn(t)})}function nn(i){return new Promise(function(e,t){let s=new FileReader;s.onload=function(){e(s.result)},s.onerror=function(){t(s.error)},s.readAsDataURL(i)})}function Zo(i){return new Promise(function(e,t){let s=new Image;s.onload=function(){let r=document.createElement("canvas");r.width=Di,r.height=Di,r.getContext("2d").drawImage(s,0,0,Di,Di),r.toBlob(function(n){e(n)},"image/jpeg")},s.onerror=function(r){t("resize image error")},s.src=i})}var on={mounted(){this.search=i=>I(this,null,function*(){this.el.dataset.status="loading";try{let e=yield rn(i);this.pushEvent("search",{search:{image:e}},t=>{delete this.el.dataset.status})}catch(e){delete this.el.dataset.status}}),this.el.addEventListener("change",i=>this.search(i.target.files[0]))}};function Ms(i){setTimeout(()=>{i.focus()},0)}function an(i){setTimeout(()=>{i.select()},0)}"use strict";var ln={mounted(){an(this.el),this.search=i=>{let e=this.el.dataset.dfdAction||"search";this.pushEvent(e,{search:{query:i}})},this.handleEvent("set-input-value",i=>this.el.value=i.query),this.handleEvent("set-input-focus",()=>Ms(this.el)),this.handleEvent("unset-input-focus",()=>{setTimeout(()=>{var i;(i=document.activeElement)==null||i.blur()},0)}),this.el.addEventListener("input",()=>this.search(this.el.value)),this.el.addEventListener("keydown",i=>{let e=this.el.getAttribute("dfd-value-suggestion");i.key==="Tab"&&e&&e!==this.el.value&&(this.el.value=e,Ms(this.el),this.search(e))})}};"use strict";var hn={mounted(){let i={add_to_cart:e=>()=>{let t=JSON.parse(e.dataset.item);if(this.el.querySelectorAll("[data-role=variant_selected][value='']").length>0){let s=this.el.querySelector("[data-role=variant_selected][value='']").dataset.variant,r=this.evaluate_filters(s);this.pushEvent("get-variants",{item:t,filters:r},()=>{this.execJS(`[data-role=selector][data-variant="${s}"]`,"show")})}else this.el.dataset.quantity=="true"&&this.el.dataset.status=="initial"?(this.execJS(null,"set_attr",["data-status","quantity"]),this.execJS("[data-role=decrease_quantity]","hide"),this.execJS("[data-role=delete_quantity]","show"),this.execJS("[data-role=amount_selected]","set_attr",["value","1"])):(this.send(t),this.execJS(null,"set_attr",["data-status","initial"]),this.execJS("[data-role=amount_selected]","set_attr",["value",1]),this.el.querySelector("[data-role=select_variant].selected")&&this.execJS("[data-role=select_variant].selected","remove_class","selected"),this.el.querySelectorAll("[data-role=open_selector]").forEach(r=>{this.execJS(`[data-role=open_selector][data-variant="${r.dataset.variant}"] input`,"set_attr",["value",r.dataset.variant])}),this.el.querySelectorAll("[data-role=open_selector]").forEach(r=>{this.execJS(`[data-role=variant_selected][data-variant="${r.dataset.variant}"]`,"remove_attr","data-index"),this.execJS(`[data-role=variant_selected][data-variant="${r.dataset.variant}"]`,"set_attr",["value",""])}))},increase_quantity:e=>()=>{let t=this.el.querySelector("[data-role=amount_selected]"),s=parseInt(t.value)+1;this.update_quantity(t,s)},decrease_quantity:e=>()=>{let t=this.el.querySelector("[data-role=amount_selected]"),s=parseInt(t.value)-1;this.update_quantity(t,s)},delete_quantity:e=>()=>{this.execJS(null,"set_attr",["data-status","initial"])},open_selector:e=>()=>{if(!e.dataset.item){this.execJS(`[data-role=selector][data-variant="${e.dataset.variant}"]`,"show");return}let t=this.evaluate_filters(e.dataset.variant),s=JSON.parse(e.dataset.item);this.pushEvent("get-variants",{item:s,filters:t},()=>{this.execJS(`[data-role=selector][data-variant="${e.dataset.variant}"]`,"show")})},select_variant:e=>()=>{let t=e.closest("[data-role=selector]").dataset.variant;this.el.querySelector("[data-role=select_variant].selected")&&this.execJS("[data-role=select_variant].selected","remove_class","selected"),this.execJS(`[data-role=selector][data-variant="${t}"]`,"hide"),this.execJS(`[data-role=selector][data-variant="${t}"] [data-id="${e.dataset.id}"]`,"add_class","selected"),this.execJS(`[data-role=open_selector][data-variant="${t}] input`,"set_attr",["value",e.dataset.val]),this.execJS(`[data-role=variant_selected][data-variant="${t}"]`,"set_attr",["value",e.dataset.val]),this.restore_filters(t),this.execJS(null,"set_attr",["data-status","initial"])},close_selector:e=>()=>{let t=e.closest("[data-role=selector]").dataset.variant;this.execJS(`[data-role=selector][data-variant="${t}"]`,"hide"),this.execJS(null,"set_attr",["data-status","initial"])},send:e=>()=>{let t=Array.from(this.el.querySelectorAll("[data-role=variant_selected]")).map(n=>n.value),s=this.el.querySelector("[data-role=amount_selected]").value,r=JSON.parse(e.dataset.item);s&&!t.includes("")?this.send(r):alert("Falta alg\xFAn dato")}};this.el.addEventListener("click",e=>{if(e.target.closest("[data-role]")){let t=Object.keys(i).find(s=>e.target.closest("[data-role]").dataset.role.match(s));t&&i[t](e.target.closest("[data-role]"))()}}),this.el.addEventListener("input",e=>{let t=e.target.closest("[data-role=amount_selected]");t&&t.value!=""&&this.update_quantity(t,parseInt(t.value))}),this.execJS=(e,t,s)=>{let r=this.el.querySelector(e);e==null&&(r=this.el),r!=null&&(t=="set_attr"?this.liveSocket.execJS(r,'[["'+t+'",{"to": null, "attr":["'+s[0]+'","'+s[1]+'"]}]]'):t=="remove_class"||t=="add_class"?this.liveSocket.execJS(r,'[["'+t+'",{"to": null, "time":200,"names":["'+s+'"],"transition":[[],[],[]]}]]'):this.liveSocket.execJS(r,'[["'+t+'",{"to": null}]]'))},this.update_quantity=(e,t)=>{this.execJS("[data-role=amount_selected]","set_attr",["value",parseInt(t)]),e.value=t,this.evaluate_quantity(t)},this.evaluate_quantity=e=>{e<=1?(this.execJS("[data-role=decrease_quantity]","hide"),this.execJS("[data-role=delete_quantity]","show"),this.execJS("[data-role=increase_quantity]","show")):(this.execJS("[data-role=decrease_quantity]","show"),this.execJS("[data-role=delete_quantity]","hide"),this.execJS("[data-role=increase_quantity]","show"))},this.evaluate_filters=e=>{let t=this.el.querySelector(`[data-role=variant_selected][data-variant="${e}"]`).dataset.index;return Array.from(this.el.querySelectorAll("[data-role=variant_selected][data-index]")).filter(s=>t==null||parseInt(s.dataset.index)<parseInt(t)).map(s=>({key:s.dataset.variant,value:s.value}))},this.restore_filters=e=>{let t=this.el.querySelector(`[data-role=variant_selected][data-variant="${e}"]`).dataset.index,s=this.el.querySelectorAll("[data-role=variant_selected][data-index]").length;t===void 0&&this.execJS(`[data-role=variant_selected][data-variant="${e}"]`,"set_attr",["data-index",s+1]);for(let r=parseInt(t)+1;r<=s;r++){let n=this.el.querySelector(`[data-role=variant_selected][data-index="${r}"]`).dataset.variant;this.execJS(`[data-role=variant_selected][data-variant="${n}"]`,"set_attr",["value",""]),this.execJS(`[data-role=variant_selected][data-variant="${n}]`,"remove_attr","data-index"),this.execJS(`[data-role=open_selector][data-variant="${n}"] input`,"set_attr",["value",n])}},this.send=e=>{let t=Array.from(this.el.querySelectorAll("[data-role=variant_selected][data-index]")).map(r=>({key:r.dataset.variant,value:r.value})),s=this.el.querySelector("[data-role=amount_selected]").value;this.start_add_to_cart(),this.pushEvent("add-to-cart-beta",{item:e,amount:s,filters:t},r=>{r.statusPromise=new De({resolveTimeout:3e3,rejectTimeout:5e3}),r.statusPromise.then(this.finish_add_to_cart,this.finish_add_to_cart),document.dispatchEvent(new CustomEvent("doofinder.cart.add",{detail:r}))})},this.start_add_to_cart=()=>{this.execJS(".dfd-cart-check-button[data-role=add_to_cart]","add_class","dfd-btn-loading"),this.execJS(".dfd-cart-add-button [data-role=add_to_cart]","add_class","dfd-btn-loading")},this.finish_add_to_cart=e=>{this.execJS(".dfd-cart-check-button[data-role=add_to_cart]","remove_class","dfd-btn-loading"),this.execJS(".dfd-cart-add-button [data-role=add_to_cart]","remove_class","dfd-btn-loading"),this.execJS(".dfd-cart-check-button[data-role=add_to_cart]","add_class","dfd-btn-done"),this.execJS(".dfd-cart-add-button [data-role=add_to_cart]","add_class","dfd-btn-done"),setTimeout(()=>{this.execJS(".dfd-cart-check-button[data-role=add_to_cart]","remove_class","dfd-btn-done"),this.execJS(".dfd-cart-add-button [data-role=add_to_cart]","remove_class","dfd-btn-done")},500),typeof e=="function"&&e()}}};function nt(i){return`${B}:${i}`}"use strict";var Oi="doofinder.cart.add.click",ea="doofinder.cart.add",Hi="doofinder.cart.hide.price",Mi="doofinder.cart.display.price",Ns="dfd-btn-loading",cn="dfd-btn-done",dn="dfd-btn-error";function un(i){i.addToCartResolveTimeout=3e3,i.addToCartRejectTimeout=5e3,i.addToCartButtonFeedback=function(t,s){let r=ta.bind(null,t,s),n=ra.bind(null,t,t.innerHTML),o=ia.bind(null,t,n),a=sa.bind(null,t,n);r().then(o,a)},i.handleCartAddClick=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target,r=new De({resolveTimeout:i.addToCartResolveTimeout,rejectTimeout:i.addToCartRejectTimeout});r.then(n=>{i.pushEvent("add-to-cart",{item:t.detail.item,dfid:t.detail.dfid},()=>{typeof n=="function"&&n()}),i.pushEvent("close-add-to-cart-button",{item:t.detail.item,dfid:t.detail.dfid})},n=>{typeof n=="function"&&n(),i.pushEvent("close-add-to-cart-button",{item:t.detail.item,dfid:t.detail.dfid})}),setTimeout(()=>i.tag.dispatch(ea,xe(H({},t.detail.item),{statusPromise:r})),1e3),i.addToCartButtonFeedback&&i.addToCartButtonFeedback(s,r)},i.handleHidePrice=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target;s.closest(".dfd-card-row").querySelector(".dfd-card-pricing").style.display="none"},i.handleDisplayPrice=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target;s.closest(".dfd-card-row").querySelector(".dfd-card-pricing").style.display="flex"};let e=!!i.tag&&!!i.tag.dom?i.tag.dom.mount:i.tag.mount;e.addEventListener(Oi,i.handleCartAddClick),e.addEventListener(nt(Oi),i.handleCartAddClick),e.addEventListener(Hi,i.handleHidePrice),e.addEventListener(nt(Hi),i.handleHidePrice),e.addEventListener(Mi,i.handleDisplayPrice),e.addEventListener(nt(Mi),i.handleDisplayPrice)}function fn(i){let e=!!i.tag&&!!i.tag.dom?i.tag.dom.mount:i.tag.mount;e.removeEventListener(Oi,i.handleCartAddClick),e.removeEventListener(nt(Oi),i.handleCartAddClick),e.removeEventListener(Hi,i.handleHidePrice),e.removeEventListener(nt(Hi),i.handleHidePrice),e.removeEventListener(Mi,i.handleDisplayPrice),e.removeEventListener(nt(Mi),i.handleDisplayPrice)}function ta(i,e){return i.setAttribute("disabled",""),i.setAttribute("dfd-update","ignore"),i.innerHTML="",i.classList.add(Ns),e}function ia(i,e){i.classList.remove(Ns),i.classList.add(cn),setTimeout(e,1e3)}function sa(i,e){i.classList.remove(Ns),i.classList.add(dn),setTimeout(e,2e3)}function ra(i,e){i.classList.remove(cn),i.classList.remove(dn),i.innerHTML=e,i.removeAttribute("dfd-update"),i.removeAttribute("disabled")}"use strict";var pn={mounted(){this.close=()=>this.pushEvent("close-layer"),this.handleEvent("close",()=>{this.tag.disconnect()}),this.handleEvent("change-state",({state:i})=>{this.tag.updateState({value:i})}),this.handleEvent("disconnect",i=>{i.errors.forEach(e=>console.error("[Doofinder] error:",e)),this.tag.destroy()}),this.handleEvent("load",i=>{this.tag.onLoad(i),this.tag.dispatch("doofinder.layer.load",{display_type:i.display_type}),this.pushEvent("ready")}),this.handleEvent("click-suggestion",i=>I(this,null,function*(){var e;this.tag.trigger.updateQuery((e=i==null?void 0:i.search)==null?void 0:e.query)})),this.handleEvent("set-trigger-focus",()=>I(this,null,function*(){this.tag.trigger.focus()})),this.handleEvent("search",i=>{this.tag.dispatch("doofinder.layer.search",i)}),this.handleEvent("item-click",i=>{this.tag.dispatch("doofinder.layer.itemClick",i)}),this.handleEvent("update-latest-searches",({entries:i})=>{this.tag.updateLatestSearches(i)}),this.el.addEventListener("contextmenu",i=>{let e=i.target.closest('[dfd-click="item-click"]');if(e){let t=e.getAttribute("dfd-value-link"),s=e.getAttribute("dfd-value-dfid");this.pushEvent("item-click",{link:t,dfid:s},()=>{this.debug(`item-click sent for ${s} to ${t}`)})}}),this.el.addEventListener("error",({target:i})=>{if(i.tagName!=="IMG")return;let e=i.closest('[data-dfd-role="card-thumbnail"]');setTimeout(()=>{e==null||e.parentElement.setAttribute("dfd-update","ignore"),e==null||e.classList.add("dfd-card-thumbnail-404")},1)},!0),this.applyOperationBySelector=function(i,e){if(i.startsWith("#")){let t=document.getElementById(i);e(t)}else this.el.querySelectorAll(i).forEach(t=>{e(t)})},this.handleEvent("dom:add-class",({target:i,newClass:e})=>{this.applyOperationBySelector(i.selector,t=>t==null?void 0:t.classList.add(e))}),this.handleEvent("dom:remove-class",({target:i,oldClass:e})=>{this.applyOperationBySelector(i.selector,t=>t==null?void 0:t.classList.remove(e))}),this.handleEvent("dom:add-attribute",({target:i,name:e,value:t})=>{this.applyOperationBySelector(i.selector,s=>s==null?void 0:s.setAttribute(e,t))}),this.handleEvent("dom:remove-attribute",({target:i,name:e})=>{this.applyOperationBySelector(i.selector,t=>t==null?void 0:t.removeAttribute(e))}),this.handleEvent("redirection:update",({redirection:i})=>{this.tag.trigger.redirection=i}),un(this)},updated(){this.tag.dispatch("doofinder.layer.update")},destroyed(){fn(this)}},mn={mounted(){this.handleEvent("disconnect",i=>{i.errors.forEach(e=>console.error("[Doofinder] error:",e)),this.tag.destroy()})}};var gn=Object.freeze({Linear:function(i){return i},EaseInQuad:function(i){return i*i},EaseOutQuad:function(i){return i*(2-i)},EaseInOutQuad:function(i){return i<.5?2*i*i:-1+(4-2*i)*i},EaseInCubic:function(i){return i*i*i},EaseOutCubic:function(i){return--i*i*i+1},EaseInOutCubic:function(i){return i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},EaseInQuart:function(i){return i*i*i*i},EaseOutQuart:function(i){return 1- --i*i*i*i},EaseInOutQuart:function(i){return i<.5?8*i*i*i*i:1-8*--i*i*i*i},EaseInQuint:function(i){return i*i*i*i*i},EaseOutQuint:function(i){return 1+--i*i*i*i*i},EaseInOutQuint:function(i){return i<.5?16*i*i*i*i*i:1+16*--i*i*i*i*i}});function _n(i,e,t,s,r=gn.EaseInQuint){let n=Date.now(),o=e[i];return new Promise((a,l)=>{function c(){let f=Date.now(),m=Math.min(1,(f-n)/s),w=r(m);e[i]=o+w*(t-o),m<1?requestAnimationFrame(c):a()}o===t?a():requestAnimationFrame(c)})}var vn=_n.bind(null,"scrollTop"),$c=_n.bind(null,"scrollLeft");function na(i){let e=i.scrollHeight>i.clientHeight,s=window.getComputedStyle(i).overflowY.indexOf("hidden")!==-1;return e&&!s}function Ni(i){return!i||i===document.documentElement?document.documentElement:na(i)?i:Ni(i.parentNode)}function bn(i,e){return typeof i!="undefined"?i:e}var Vt=class{constructor(e,t,s={}){let{threshold:r}=s;this.handleIntersection=this.handleIntersection.bind(this),this._callback=t,this._io=new IntersectionObserver(this.handleIntersection,{root:e,threshold:bn(r,0)})}observe(e){this._io.disconnect(),e&&this._io.observe(e),C("[ScrollObserver][observe]",e)}unobserve(){this._io.disconnect(),C("[ScrollObserver][unobserve]")}handleIntersection([e]){C("[ScrollObserver][intersection detected] target:",e.target),this._callback(e)}};var yn='[data-dfd-role~="scroll-sentinel"]',Sn='[data-dfd-role~="scroll-top-sentinel"]',oa="div.dfd-card";function jt(i,e,t){t?i.scrollTop=e:vn(i,e,250)}function aa(i){var s,r;let e=((s=document.querySelector(oa))==null?void 0:s.offsetHeight)||0,t=((r=document.querySelector(yn))==null?void 0:r.offsetHeight)||0;return i.scrollHeight-t-e*2.6}var En={mounted(){this.sentinel=()=>this.el.querySelector(yn),this.scrollTopSentinel=()=>this.el.querySelector(Sn),this.scrollTarget=()=>this.el.dataset.dfdScrollTarget,this.refreshObservers=()=>{this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel())},this.changeBackToTopVisibility=i=>{this.pushEvent("change-back-to-top-visibility",{visible:i})},this.scrollObserver=new Vt(this.el,({target:i,isIntersecting:e})=>{if(!e)return;let t={index:i.dataset.index};this.debug('[push] "load-more", params:',t),this.pushEvent("load-more",t)}),this.scrollTopObserver=new Vt(this.el,({isIntersecting:i})=>{this.changeBackToTopVisibility(!i)}),this.handleEvent("search",i=>{this.debug('[handle] "search", params:',i);let{index:e,page:t}=i,s=this.sentinel();!la(i.filter)&&t===1&&e===(s==null?void 0:s.dataset.index)&&(this.changeBackToTopVisibility(!1),jt(this.el,0,!0)),this.refreshObservers()}),this.handleEvent("back-to-top",({id:i,fast:e})=>{this.debug(`[handle] "back-to-top", id: ${i}, fast: ${e}`),this.scrollTarget()==="window"?window.scrollTo(0,0):(!i||i===this.el.id)&&jt(this.el,0,!!e)}),this.handleEvent("change-current-index",()=>{this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel()),jt(this.el,0,!0)}),this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel())},destroyed(){this.scrollObserver.unobserve(),this.scrollObserver=null,this.scrollTopObserver.unobserve(),this.scrollTopObserver=null}},Fs={mounted(){this.hideVirtualKeyboard=Ti(()=>{let i=document.querySelector("input:focus");i?(this.debug("[hideVirtualKeyboard][blur] input:",i),i.blur()):this.debug("[hideVirtualKeyboard][noop]")},100),this.debug("[observe][touchstart] hideVirtualKeyboard()"),this.el.addEventListener("touchstart",this.hideVirtualKeyboard)},destroyed(){this.debug("[unobserve][touchstart] hideVirtualKeyboard()"),this.el.removeEventListener("touchstart",this.hideVirtualKeyboard)}},$s={mounted(){this.scrollTarget=()=>this.el.dataset.dfdScrollTarget,this.scrollTopSentinel=()=>this.el.querySelector(Sn),this.transientTargetCard=()=>this.el.querySelector(`[dfd-value-dfid="${this.tag.state.targetItemId}"]`),this.changeBackToTopVisibility=i=>{this.pushEvent("change-back-to-top-visibility",{visible:i})},this.scrollTopObserver=new Vt(null,({isIntersecting:i})=>{this.changeBackToTopVisibility(!i)}),this.scrollTopObserver.observe(this.scrollTopSentinel()),this.handleEvent("update-scroll",i=>{setTimeout((()=>{let e=this.transientTargetCard();this.debug('[handle] "update-scroll"',"params:",i,"card:",e),this.tag.targetItemId=null,e!=null?e.scrollIntoView({behavior:"smooth",block:"nearest"}):i.scroll_end&&jt(Ni(this.el),aa(this.el),!1)}).bind(this),1e3)}),this.handleEvent("back-to-top",({id:i,fast:e})=>{this.debug(`[handle] "back-to-top", id: ${i}, fast: ${e}`),this.scrollTarget()==="window"?window.scrollTo(0,0):(!i||i===this.el.id)&&jt(Ni(this.el),0,e)})}};function la(i){return!!i&&Object.keys(i).length>0}function Fi(i,e,t,s){return new Intl.NumberFormat(i,{style:"currency",maximumFractionDigits:parseInt(t,10),numberingSystem:s,currency:e})}function $i(i,e,t){return new Intl.NumberFormat(i,{maximumFractionDigits:parseInt(e,10),numberingSystem:t})}var Us=class{constructor(e,t,s,r,n){this.template=e,this.symbol=t,this.thousand=s,this.decimal=r,this.precision=n}format(e){let t=e<0,s=Math.pow(10,this.precision),r=(Math.round(e*s)/s).toFixed(this.precision),n=`${parseInt(Math.abs(r||0).toFixed(this.precision),10)}`,o=n.length>3?n.length%3:0,a=r.split(".")[1],l=[];return o>0&&l.push(`${n.substring(0,o)}${this.thousand}`),l.push(n.substring(o).replace(/(\d{3})(?=\d)/g,"$1"+this.thousand)),this.precision>0&&parseInt(a,10)>0&&l.push(`${this.decimal}${a}`),l=this.template.replace(/%s/g,this.symbol).replace(/%v/g,l.join("")),t&&(l=`-${l}`),l}};"use strict";var Xe;(function(i){i.Range="range",i.Steps="steps",i.Positions="positions",i.Count="count",i.Values="values"})(Xe||(Xe={}));var ce;(function(i){i[i.None=-1]="None",i[i.NoValue=0]="NoValue",i[i.LargeValue=1]="LargeValue",i[i.SmallValue=2]="SmallValue"})(ce||(ce={}));function ha(i){return Ui(i)&&typeof i.from=="function"}function Ui(i){return typeof i=="object"&&typeof i.to=="function"}function wn(i){i.parentElement.removeChild(i)}function Bs(i){return i!=null}function An(i){i.preventDefault()}function ca(i){return i.filter(function(e){return this[e]?!1:this[e]=!0},{})}function da(i,e){return Math.round(i/e)*e}function ua(i,e){var t=i.getBoundingClientRect(),s=i.ownerDocument,r=s.documentElement,n=Cn(s);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(n.x=0),e?t.top+n.y-r.clientTop:t.left+n.x-r.clientLeft}function Te(i){return typeof i=="number"&&!isNaN(i)&&isFinite(i)}function Tn(i,e,t){t>0&&(he(i,e),setTimeout(function(){Vi(i,e)},t))}function xn(i){return Math.max(Math.min(i,100),0)}function Bi(i){return Array.isArray(i)?i:[i]}function fa(i){i=String(i);var e=i.split(".");return e.length>1?e[1].length:0}function he(i,e){i.classList&&!/\s/.test(e)?i.classList.add(e):i.className+=" "+e}function Vi(i,e){i.classList&&!/\s/.test(e)?i.classList.remove(e):i.className=i.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function pa(i,e){return i.classList?i.classList.contains(e):new RegExp("\\b"+e+"\\b").test(i.className)}function Cn(i){var e=window.pageXOffset!==void 0,t=(i.compatMode||"")==="CSS1Compat",s=e?window.pageXOffset:t?i.documentElement.scrollLeft:i.body.scrollLeft,r=e?window.pageYOffset:t?i.documentElement.scrollTop:i.body.scrollTop;return{x:s,y:r}}function ma(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function ga(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("test",null,e)}catch(t){}return i}function _a(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function Vs(i,e){return 100/(e-i)}function js(i,e,t){return e*100/(i[t+1]-i[t])}function va(i,e){return js(i,i[0]<0?e+Math.abs(i[0]):e-i[0],0)}function ba(i,e){return e*(i[1]-i[0])/100+i[0]}function Xt(i,e){for(var t=1;i>=e[t];)t+=1;return t}function ya(i,e,t){if(t>=i.slice(-1)[0])return 100;var s=Xt(t,i),r=i[s-1],n=i[s],o=e[s-1],a=e[s];return o+va([r,n],t)/Vs(o,a)}function Sa(i,e,t){if(t>=100)return i.slice(-1)[0];var s=Xt(t,e),r=i[s-1],n=i[s],o=e[s-1],a=e[s];return ba([r,n],(t-o)*Vs(o,a))}function Ea(i,e,t,s){if(s===100)return s;var r=Xt(s,i),n=i[r-1],o=i[r];return t?s-n>(o-n)/2?o:n:e[r-1]?i[r-1]+da(s-i[r-1],e[r-1]):s}var kn=function(){function i(e,t,s){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[s||!1],this.xNumSteps=[!1],this.snap=t;var r,n=[];for(Object.keys(e).forEach(function(o){n.push([Bi(e[o]),o])}),n.sort(function(o,a){return o[0][0]-a[0][0]}),r=0;r<n.length;r++)this.handleEntryPoint(n[r][1],n[r][0]);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)this.handleStepPoint(r,this.xNumSteps[r])}return i.prototype.getDistance=function(e){for(var t=[],s=0;s<this.xNumSteps.length-1;s++)t[s]=js(this.xVal,e,s);return t},i.prototype.getAbsoluteDistance=function(e,t,s){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!s&&e===this.xPct[r+1]&&r++,t===null&&(t=[]);var n,o=1,a=t[r],l=0,c=0,f=0,m=0;for(s?n=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):n=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);a>0;)l=this.xPct[r+1+m]-this.xPct[r+m],t[r+m]*o+100-n*100>100?(c=l*n,o=(a-100*n)/t[r+m],n=1):(c=t[r+m]*l/100*o,o=0),s?(f=f-c,this.xPct.length+m>=1&&m--):(f=f+c,this.xPct.length-m>=1&&m++),a=t[r+m]*o;return e+f},i.prototype.toStepping=function(e){return e=ya(this.xVal,this.xPct,e),e},i.prototype.fromStepping=function(e){return Sa(this.xVal,this.xPct,e)},i.prototype.getStep=function(e){return e=Ea(this.xPct,this.xSteps,this.snap,e),e},i.prototype.getDefaultStep=function(e,t,s){var r=Xt(e,this.xPct);return(e===100||t&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/s},i.prototype.getNearbySteps=function(e){var t=Xt(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},i.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(fa);return Math.max.apply(null,e)},i.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},i.prototype.convert=function(e){return this.getStep(this.toStepping(e))},i.prototype.handleEntryPoint=function(e,t){var s;if(e==="min"?s=0:e==="max"?s=100:s=parseFloat(e),!Te(s)||!Te(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(s),this.xVal.push(t[0]);var r=Number(t[1]);s?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},i.prototype.handleStepPoint=function(e,t){if(!!t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=js([this.xVal[e],this.xVal[e+1]],t,0)/Vs(this.xPct[e],this.xPct[e+1]);var s=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(s.toFixed(3))-1),n=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=n}},i}(),Pn={to:function(i){return i===void 0?"":i.toFixed(2)},from:Number},Rn={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},Je={tooltips:".__tooltips",aria:".__aria"};function wa(i,e){if(!Te(e))throw new Error("noUiSlider: 'step' is not numeric.");i.singleStep=e}function Aa(i,e){if(!Te(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");i.keyboardPageMultiplier=e}function Ta(i,e){if(!Te(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");i.keyboardMultiplier=e}function xa(i,e){if(!Te(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");i.keyboardDefaultStep=e}function Ca(i,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");i.spectrum=new kn(e,i.snap||!1,i.singleStep)}function ka(i,e){if(e=Bi(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");i.handles=e.length,i.start=e}function Pa(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");i.snap=e}function Ra(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");i.animate=e}function Ia(i,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");i.animationDuration=e}function In(i,e){var t=[!1],s;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(s=1;s<i.handles;s++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==i.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}i.connect=t}function La(i,e){switch(e){case"horizontal":i.ort=0;break;case"vertical":i.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function Ln(i,e){if(!Te(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(i.margin=i.spectrum.getDistance(e))}function Da(i,e){if(!Te(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(i.limit=i.spectrum.getDistance(e),!i.limit||i.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function Oa(i,e){var t;if(!Te(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||Te(e[0])||Te(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),i.padding=[i.spectrum.getDistance(e[0]),i.spectrum.getDistance(e[1])],t=0;t<i.spectrum.xNumSteps.length-1;t++)if(i.padding[0][t]<0||i.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var s=e[0]+e[1],r=i.spectrum.xVal[0],n=i.spectrum.xVal[i.spectrum.xVal.length-1];if(s/(n-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Ha(i,e){switch(e){case"ltr":i.dir=0;break;case"rtl":i.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Ma(i,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,s=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,n=e.indexOf("snap")>=0,o=e.indexOf("hover")>=0,a=e.indexOf("unconstrained")>=0,l=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,f=e.indexOf("smooth-steps")>=0;if(r){if(i.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");Ln(i,i.start[1]-i.start[0])}if(l&&i.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(a&&(i.margin||i.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");i.events={tap:t||n,drag:s,dragAll:c,smoothSteps:f,fixed:r,snap:n,hover:o,unconstrained:a,invertConnects:l}}function Na(i,e){if(e!==!1)if(e===!0||Ui(e)){i.tooltips=[];for(var t=0;t<i.handles;t++)i.tooltips.push(e)}else{if(e=Bi(e),e.length!==i.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(s){if(typeof s!="boolean"&&!Ui(s))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),i.tooltips=e}}function Fa(i,e){if(e.length!==i.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");i.handleAttributes=e}function $a(i,e){if(!Ui(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");i.ariaFormat=e}function Ua(i,e){if(!ha(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");i.format=e}function Ba(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");i.keyboardSupport=e}function Va(i,e){i.documentElement=e}function ja(i,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");i.cssPrefix=e}function Xa(i,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof i.cssPrefix=="string"?(i.cssClasses={},Object.keys(e).forEach(function(t){i.cssClasses[t]=i.cssPrefix+e[t]})):i.cssClasses=e}function Dn(i){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:Pn,format:Pn},t={step:{r:!1,t:wa},keyboardPageMultiplier:{r:!1,t:Aa},keyboardMultiplier:{r:!1,t:Ta},keyboardDefaultStep:{r:!1,t:xa},start:{r:!0,t:ka},connect:{r:!0,t:In},direction:{r:!0,t:Ha},snap:{r:!1,t:Pa},animate:{r:!1,t:Ra},animationDuration:{r:!1,t:Ia},range:{r:!0,t:Ca},orientation:{r:!1,t:La},margin:{r:!1,t:Ln},limit:{r:!1,t:Da},padding:{r:!1,t:Oa},behaviour:{r:!0,t:Ma},ariaFormat:{r:!1,t:$a},format:{r:!1,t:Ua},tooltips:{r:!1,t:Na},keyboardSupport:{r:!0,t:Ba},documentElement:{r:!1,t:Va},cssPrefix:{r:!0,t:ja},cssClasses:{r:!0,t:Xa},handleAttributes:{r:!1,t:Fa}},s={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Rn,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};i.format&&!i.ariaFormat&&(i.ariaFormat=i.format),Object.keys(t).forEach(function(l){if(!Bs(i[l])&&s[l]===void 0){if(t[l].r)throw new Error("noUiSlider: '"+l+"' is required.");return}t[l].t(e,Bs(i[l])?i[l]:s[l])}),e.pips=i.pips;var r=document.createElement("div"),n=r.style.msTransform!==void 0,o=r.style.transform!==void 0;e.transformRule=o?"transform":n?"msTransform":"webkitTransform";var a=[["left","top"],["right","bottom"]];return e.style=a[e.dir][e.ort],e}function Ja(i,e,t){var s=ma(),r=_a(),n=r&&ga(),o=i,a,l,c,f,m,w,_=e.spectrum,S=[],E=[],R=[],F=0,L={},V=!1,j=i.ownerDocument,z=e.documentElement||j.documentElement,Q=j.body,X=j.dir==="rtl"||e.ort===1?0:100;function Z(h,d){var u=j.createElement("div");return d&&he(u,d),h.appendChild(u),u}function g(h,d){var u=Z(h,e.cssClasses.origin),v=Z(u,e.cssClasses.handle);if(Z(v,e.cssClasses.touchArea),v.setAttribute("data-handle",String(d)),e.keyboardSupport&&(v.setAttribute("tabindex","0"),v.addEventListener("keydown",function(y){return ro(y,d)})),e.handleAttributes!==void 0){var b=e.handleAttributes[d];Object.keys(b).forEach(function(y){v.setAttribute(y,b[y])})}return v.setAttribute("role","slider"),v.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),d===0?he(v,e.cssClasses.handleLower):d===e.handles-1&&he(v,e.cssClasses.handleUpper),u.handle=v,u}function P(h,d){return d?Z(h,e.cssClasses.connect):!1}function O(h,d){l=Z(d,e.cssClasses.connects),c=[],f=[],f.push(P(l,h[0]));for(var u=0;u<e.handles;u++)c.push(g(d,u)),R[u]=u,f.push(P(l,h[u+1]))}function ee(h){he(h,e.cssClasses.target),e.dir===0?he(h,e.cssClasses.ltr):he(h,e.cssClasses.rtl),e.ort===0?he(h,e.cssClasses.horizontal):he(h,e.cssClasses.vertical);var d=getComputedStyle(h).direction;return d==="rtl"?he(h,e.cssClasses.textDirectionRtl):he(h,e.cssClasses.textDirectionLtr),Z(h,e.cssClasses.base)}function ye(h,d){return!e.tooltips||!e.tooltips[d]?!1:Z(h.firstChild,e.cssClasses.tooltip)}function ot(){return o.hasAttribute("disabled")}function yt(h){var d=c[h];return d.hasAttribute("disabled")}function St(h){h!=null?(c[h].setAttribute("disabled",""),c[h].handle.removeAttribute("tabindex")):(o.setAttribute("disabled",""),c.forEach(function(d){d.handle.removeAttribute("tabindex")}))}function k(h){h!=null?(c[h].removeAttribute("disabled"),c[h].handle.setAttribute("tabindex","0")):(o.removeAttribute("disabled"),c.forEach(function(d){d.removeAttribute("disabled"),d.handle.setAttribute("tabindex","0")}))}function x(){w&&(At("update"+Je.tooltips),w.forEach(function(h){h&&wn(h)}),w=null)}function J(){x(),w=c.map(ye),Ki("update"+Je.tooltips,function(h,d,u){if(!(!w||!e.tooltips)&&w[d]!==!1){var v=h[d];e.tooltips[d]!==!0&&(v=e.tooltips[d].to(u[d])),w[d].innerHTML=v}})}function D(){At("update"+Je.aria),Ki("update"+Je.aria,function(h,d,u,v,b){R.forEach(function(y){var T=c[y],A=qt(E,y,0,!0,!0,!0),$=qt(E,y,100,!0,!0,!0),U=b[y],W=String(e.ariaFormat.to(u[y]));A=_.fromStepping(A).toFixed(1),$=_.fromStepping($).toFixed(1),U=_.fromStepping(U).toFixed(1),T.children[0].setAttribute("aria-valuemin",A),T.children[0].setAttribute("aria-valuemax",$),T.children[0].setAttribute("aria-valuenow",U),T.children[0].setAttribute("aria-valuetext",W)})})}function M(h){if(h.mode===Xe.Range||h.mode===Xe.Steps)return _.xVal;if(h.mode===Xe.Count){if(h.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var d=h.values-1,u=100/d,v=[];d--;)v[d]=d*u;return v.push(100),Le(v,h.stepped)}return h.mode===Xe.Positions?Le(h.values,h.stepped):h.mode===Xe.Values?h.stepped?h.values.map(function(b){return _.fromStepping(_.getStep(_.toStepping(b)))}):h.values:[]}function Le(h,d){return h.map(function(u){return _.fromStepping(d?_.getStep(u):u)})}function Se(h){function d(U,W){return Number((U+W).toFixed(7))}var u=M(h),v={},b=_.xVal[0],y=_.xVal[_.xVal.length-1],T=!1,A=!1,$=0;return u=ca(u.slice().sort(function(U,W){return U-W})),u[0]!==b&&(u.unshift(b),T=!0),u[u.length-1]!==y&&(u.push(y),A=!0),u.forEach(function(U,W){var K,N,Y,oe=U,ie=u[W+1],re,Yi,Qi,Zi,sr,es,rr,nr=h.mode===Xe.Steps;for(nr&&(K=_.xNumSteps[W]),K||(K=ie-oe),ie===void 0&&(ie=oe),K=Math.max(K,1e-7),N=oe;N<=ie;N=d(N,K)){for(re=_.toStepping(N),Yi=re-$,sr=Yi/(h.density||1),es=Math.round(sr),rr=Yi/es,Y=1;Y<=es;Y+=1)Qi=$+Y*rr,v[Qi.toFixed(5)]=[_.fromStepping(Qi),0];Zi=u.indexOf(N)>-1?ce.LargeValue:nr?ce.SmallValue:ce.NoValue,!W&&T&&N!==ie&&(Zi=0),N===ie&&A||(v[re.toFixed(5)]=[N,Zi]),$=re}}),v}function Fe(h,d,u){var v,b,y=j.createElement("div"),T=(v={},v[ce.None]="",v[ce.NoValue]=e.cssClasses.valueNormal,v[ce.LargeValue]=e.cssClasses.valueLarge,v[ce.SmallValue]=e.cssClasses.valueSub,v),A=(b={},b[ce.None]="",b[ce.NoValue]=e.cssClasses.markerNormal,b[ce.LargeValue]=e.cssClasses.markerLarge,b[ce.SmallValue]=e.cssClasses.markerSub,b),$=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],U=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];he(y,e.cssClasses.pips),he(y,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function W(N,Y){var oe=Y===e.cssClasses.value,ie=oe?$:U,re=oe?T:A;return Y+" "+ie[e.ort]+" "+re[N]}function K(N,Y,oe){if(oe=d?d(Y,oe):oe,oe!==ce.None){var ie=Z(y,!1);ie.className=W(oe,e.cssClasses.marker),ie.style[e.style]=N+"%",oe>ce.NoValue&&(ie=Z(y,!1),ie.className=W(oe,e.cssClasses.value),ie.setAttribute("data-value",String(Y)),ie.style[e.style]=N+"%",ie.innerHTML=String(u.to(Y)))}}return Object.keys(h).forEach(function(N){K(N,h[N][0],h[N][1])}),y}function $e(){m&&(wn(m),m=null)}function ge(h){$e();var d=Se(h),u=h.filter,v=h.format||{to:function(b){return String(Math.round(b))}};return m=o.appendChild(Fe(d,u,v)),m}function qe(){var h=a.getBoundingClientRect(),d="offset"+["Width","Height"][e.ort];return e.ort===0?h.width||a[d]:h.height||a[d]}function ne(h,d,u,v){var b=function(T){var A=Et(T,v.pageOffset,v.target||d);if(!A||ot()&&!v.doNotReject||pa(o,e.cssClasses.tap)&&!v.doNotReject||h===s.start&&A.buttons!==void 0&&A.buttons>1||v.hover&&A.buttons)return!1;n||A.preventDefault(),A.calcPoint=A.points[e.ort],u(A,v)},y=[];return h.split(" ").forEach(function(T){d.addEventListener(T,b,n?{passive:!0}:!1),y.push([T,b])}),y}function Et(h,d,u){var v=h.type.indexOf("touch")===0,b=h.type.indexOf("mouse")===0,y=h.type.indexOf("pointer")===0,T=0,A=0;if(h.type.indexOf("MSPointer")===0&&(y=!0),h.type==="mousedown"&&!h.buttons&&!h.touches)return!1;if(v){var $=function(K){var N=K.target;return N===u||u.contains(N)||h.composed&&h.composedPath().shift()===u};if(h.type==="touchstart"){var U=Array.prototype.filter.call(h.touches,$);if(U.length>1)return!1;T=U[0].pageX,A=U[0].pageY}else{var W=Array.prototype.find.call(h.changedTouches,$);if(!W)return!1;T=W.pageX,A=W.pageY}}return d=d||Cn(j),(b||y)&&(T=h.clientX+d.x,A=h.clientY+d.y),h.pageOffset=d,h.points=[T,A],h.cursor=b||y,h}function wt(h){var d=h-ua(a,e.ort),u=d*100/qe();return u=xn(u),e.dir?100-u:u}function Zn(h){var d=100,u=!1;return c.forEach(function(v,b){if(!yt(b)){var y=E[b],T=Math.abs(y-h),A=T===100&&d===100,$=T<d,U=T<=d&&h>y;($||U||A)&&(u=b,d=T)}}),u}function eo(h,d){h.type==="mouseout"&&h.target.nodeName==="HTML"&&h.relatedTarget===null&&qi(h,d)}function to(h,d){if(navigator.appVersion.indexOf("MSIE 9")===-1&&h.buttons===0&&d.buttonsProperty!==0)return qi(h,d);var u=(e.dir?-1:1)*(h.calcPoint-d.startCalcPoint),v=u*100/d.baseSize;Ys(u>0,v,d.locations,d.handleNumbers,d.connect)}function qi(h,d){d.handle&&(Vi(d.handle,e.cssClasses.active),F-=1),d.listeners.forEach(function(u){z.removeEventListener(u[0],u[1])}),F===0&&(Vi(o,e.cssClasses.drag),Gi(),h.cursor&&(Q.style.cursor="",Q.removeEventListener("selectstart",An))),e.events.smoothSteps&&(d.handleNumbers.forEach(function(u){We(u,E[u],!0,!0,!1,!1)}),d.handleNumbers.forEach(function(u){G("update",u)})),d.handleNumbers.forEach(function(u){G("change",u),G("set",u),G("end",u)})}function Wi(h,d){if(!d.handleNumbers.some(yt)){var u;if(d.handleNumbers.length===1){var v=c[d.handleNumbers[0]];u=v.children[0],F+=1,he(u,e.cssClasses.active)}h.stopPropagation();var b=[],y=ne(s.move,z,to,{target:h.target,handle:u,connect:d.connect,listeners:b,startCalcPoint:h.calcPoint,baseSize:qe(),pageOffset:h.pageOffset,handleNumbers:d.handleNumbers,buttonsProperty:h.buttons,locations:E.slice()}),T=ne(s.end,z,qi,{target:h.target,handle:u,listeners:b,doNotReject:!0,handleNumbers:d.handleNumbers}),A=ne("mouseout",z,eo,{target:h.target,handle:u,listeners:b,doNotReject:!0,handleNumbers:d.handleNumbers});b.push.apply(b,y.concat(T,A)),h.cursor&&(Q.style.cursor=getComputedStyle(h.target).cursor,c.length>1&&he(o,e.cssClasses.drag),Q.addEventListener("selectstart",An,!1)),d.handleNumbers.forEach(function($){G("start",$)})}}function io(h){h.stopPropagation();var d=wt(h.calcPoint),u=Zn(d);u!==!1&&(e.events.snap||Tn(o,e.cssClasses.tap,e.animationDuration),We(u,d,!0,!0),Gi(),G("slide",u,!0),G("update",u,!0),e.events.snap?Wi(h,{handleNumbers:[u]}):(G("change",u,!0),G("set",u,!0)))}function so(h){var d=wt(h.calcPoint),u=_.getStep(d),v=_.fromStepping(u);Object.keys(L).forEach(function(b){b.split(".")[0]==="hover"&&L[b].forEach(function(y){y.call(Kt,v)})})}function ro(h,d){if(ot()||yt(d))return!1;var u=["Left","Right"],v=["Down","Up"],b=["PageDown","PageUp"],y=["Home","End"];e.dir&&!e.ort?u.reverse():e.ort&&!e.dir&&(v.reverse(),b.reverse());var T=h.key.replace("Arrow",""),A=T===b[0],$=T===b[1],U=T===v[0]||T===u[0]||A,W=T===v[1]||T===u[1]||$,K=T===y[0],N=T===y[1];if(!U&&!W&&!K&&!N)return!0;h.preventDefault();var Y;if(W||U){var oe=U?0:1,ie=tr(d),re=ie[oe];if(re===null)return!1;re===!1&&(re=_.getDefaultStep(E[d],U,e.keyboardDefaultStep)),$||A?re*=e.keyboardPageMultiplier:re*=e.keyboardMultiplier,re=Math.max(re,1e-7),re=(U?-1:1)*re,Y=S[d]+re}else N?Y=e.spectrum.xVal[e.spectrum.xVal.length-1]:Y=e.spectrum.xVal[0];return We(d,_.toStepping(Y),!0,!0),G("slide",d),G("update",d),G("change",d),G("set",d),!1}function Gs(h){h.fixed||c.forEach(function(d,u){ne(s.start,d.children[0],Wi,{handleNumbers:[u]})}),h.tap&&ne(s.start,a,io,{}),h.hover&&ne(s.move,a,so,{hover:!0}),h.drag&&f.forEach(function(d,u){if(!(d===!1||u===0||u===f.length-1)){var v=c[u-1],b=c[u],y=[d],T=[v,b],A=[u-1,u];he(d,e.cssClasses.draggable),h.fixed&&(y.push(v.children[0]),y.push(b.children[0])),h.dragAll&&(T=c,A=R),y.forEach(function($){ne(s.start,$,Wi,{handles:T,handleNumbers:A,connect:d})})}})}function Ki(h,d){L[h]=L[h]||[],L[h].push(d),h.split(".")[0]==="update"&&c.forEach(function(u,v){G("update",v)})}function no(h){return h===Je.aria||h===Je.tooltips}function At(h){var d=h&&h.split(".")[0],u=d?h.substring(d.length):h;Object.keys(L).forEach(function(v){var b=v.split(".")[0],y=v.substring(b.length);(!d||d===b)&&(!u||u===y)&&(!no(y)||u===y)&&delete L[v]})}function G(h,d,u){Object.keys(L).forEach(function(v){var b=v.split(".")[0];h===b&&L[v].forEach(function(y){y.call(Kt,S.map(e.format.to),d,S.slice(),u||!1,E.slice(),Kt)})})}function qt(h,d,u,v,b,y,T){var A;return c.length>1&&!e.events.unconstrained&&(v&&d>0&&(A=_.getAbsoluteDistance(h[d-1],e.margin,!1),u=Math.max(u,A)),b&&d<c.length-1&&(A=_.getAbsoluteDistance(h[d+1],e.margin,!0),u=Math.min(u,A))),c.length>1&&e.limit&&(v&&d>0&&(A=_.getAbsoluteDistance(h[d-1],e.limit,!1),u=Math.min(u,A)),b&&d<c.length-1&&(A=_.getAbsoluteDistance(h[d+1],e.limit,!0),u=Math.max(u,A))),e.padding&&(d===0&&(A=_.getAbsoluteDistance(0,e.padding[0],!1),u=Math.max(u,A)),d===c.length-1&&(A=_.getAbsoluteDistance(100,e.padding[1],!0),u=Math.min(u,A))),T||(u=_.getStep(u)),u=xn(u),u===h[d]&&!y?!1:u}function zi(h,d){var u=e.ort;return(u?d:h)+", "+(u?h:d)}function Ys(h,d,u,v,b){var y=u.slice(),T=v[0],A=e.events.smoothSteps,$=[!h,h],U=[h,!h];v=v.slice(),h&&v.reverse(),v.length>1?v.forEach(function(K,N){var Y=qt(y,K,y[K]+d,$[N],U[N],!1,A);Y===!1?d=0:(d=Y-y[K],y[K]=Y)}):$=U=[!0];var W=!1;v.forEach(function(K,N){W=We(K,u[K]+d,$[N],U[N],!1,A)||W}),W&&(v.forEach(function(K){G("update",K),G("slide",K)}),b!=null&&G("drag",T))}function Qs(h,d){return e.dir?100-h-d:h}function oo(h,d){E[h]=d,S[h]=_.fromStepping(d);var u=Qs(d,0)-X,v="translate("+zi(u+"%","0")+")";if(c[h].style[e.transformRule]=v,e.events.invertConnects&&E.length>1){var b=E.every(function(y,T,A){return T===0||y>=A[T-1]});if(V!==!b){fo();return}}Tt(h),Tt(h+1),V&&(Tt(h-1),Tt(h+2))}function Gi(){R.forEach(function(h){var d=E[h]>50?-1:1,u=3+(c.length+d*h);c[h].style.zIndex=String(u)})}function We(h,d,u,v,b,y){return b||(d=qt(E,h,d,u,v,!1,y)),d===!1?!1:(oo(h,d),!0)}function Tt(h){if(!!f[h]){var d=E.slice();V&&d.sort(function(A,$){return A-$});var u=0,v=100;h!==0&&(u=d[h-1]),h!==f.length-1&&(v=d[h]);var b=v-u,y="translate("+zi(Qs(u,b)+"%","0")+")",T="scale("+zi(b/100,"1")+")";f[h].style[e.transformRule]=y+" "+T}}function Zs(h,d){return h===null||h===!1||h===void 0||(typeof h=="number"&&(h=String(h)),h=e.format.from(h),h!==!1&&(h=_.toStepping(h)),h===!1||isNaN(h))?E[d]:h}function Wt(h,d,u){var v=Bi(h),b=E[0]===void 0;d=d===void 0?!0:d,e.animate&&!b&&Tn(o,e.cssClasses.tap,e.animationDuration),R.forEach(function(A){We(A,Zs(v[A],A),!0,!1,u)});var y=R.length===1?0:1;if(b&&_.hasNoSize()&&(u=!0,E[0]=0,R.length>1)){var T=100/(R.length-1);R.forEach(function(A){E[A]=A*T})}for(;y<R.length;++y)R.forEach(function(A){We(A,E[A],!0,!0,u)});Gi(),R.forEach(function(A){G("update",A),v[A]!==null&&d&&G("set",A)})}function ao(h){Wt(e.start,h)}function lo(h,d,u,v){if(h=Number(h),!(h>=0&&h<R.length))throw new Error("noUiSlider: invalid handle number, got: "+h);We(h,Zs(d,h),!0,!0,v),G("update",h),u&&G("set",h)}function er(h){if(h===void 0&&(h=!1),h)return S.length===1?S[0]:S.slice(0);var d=S.map(e.format.to);return d.length===1?d[0]:d}function ho(){for(At(Je.aria),At(Je.tooltips),Object.keys(e.cssClasses).forEach(function(h){Vi(o,e.cssClasses[h])});o.firstChild;)o.removeChild(o.firstChild);delete o.noUiSlider}function tr(h){var d=E[h],u=_.getNearbySteps(d),v=S[h],b=u.thisStep.step,y=null;if(e.snap)return[v-u.stepBefore.startValue||null,u.stepAfter.startValue-v||null];b!==!1&&v+b>u.stepAfter.startValue&&(b=u.stepAfter.startValue-v),v>u.thisStep.startValue?y=u.thisStep.step:u.stepBefore.step===!1?y=!1:y=v-u.stepBefore.highestStep,d===100?b=null:d===0&&(y=null);var T=_.countStepDecimals();return b!==null&&b!==!1&&(b=Number(b.toFixed(T))),y!==null&&y!==!1&&(y=Number(y.toFixed(T))),[y,b]}function co(){return R.map(tr)}function uo(h,d){var u=er(),v=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];v.forEach(function(y){h[y]!==void 0&&(t[y]=h[y])});var b=Dn(t);v.forEach(function(y){h[y]!==void 0&&(e[y]=b[y])}),_=b.spectrum,e.margin=b.margin,e.limit=b.limit,e.padding=b.padding,e.pips?ge(e.pips):$e(),e.tooltips?J():x(),E=[],Wt(Bs(h.start)?h.start:u,d),h.connect&&ir()}function ir(){for(;l.firstChild;)l.removeChild(l.firstChild);for(var h=0;h<=e.handles;h++)f[h]=P(l,e.connect[h]),Tt(h);Gs({drag:e.events.drag,fixed:!0})}function fo(){V=!V,In(e,e.connect.map(function(h){return!h})),ir()}function po(){a=ee(o),O(e.connect,a),Gs(e.events),Wt(e.start),e.pips&&ge(e.pips),e.tooltips&&J(),D()}po();var Kt={destroy:ho,steps:co,on:Ki,off:At,get:er,set:Wt,setHandle:lo,reset:ao,disable:St,enable:k,__moveHandles:function(h,d,u){Ys(h,d,E,u)},options:t,updateOptions:uo,target:o,removePips:$e,removeTooltips:x,getPositions:function(){return E.slice()},getTooltips:function(){return w},getOrigins:function(){return c},pips:ge};return Kt}function qa(i,e){if(!i||!i.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+i);if(i.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=Dn(e),s=Ja(i,t,e);return i.noUiSlider=s,s}var On={__spectrum:kn,cssClasses:Rn,create:qa};function Hn(i){return i.filter((e,t)=>i.indexOf(e)===t)}function Mn(i){let e={};return{to(t){let s=i.format(t);return e[s]=t,s},from(t){return e[t]}}}function Xs(i,e){let{min:t,max:s,from:r,to:n}=i;return t=parseFloat(t),s=parseFloat(s),t===s&&s++,r=parseFloat(r)||t,n=parseFloat(n)||s,{range:{min:t,max:s},start:[e.to(r),e.to(n)]}}function Nn(i,e,t,s={}){return On.create(i,H({cssPrefix:"dfd-slider-",orientation:"horizontal",direction:s.rtl?"rtl":"ltr",tooltips:!0,padding:0,connect:!0,animate:!0,step:1,keyboardSupport:!0,format:e,pips:{mode:"count",values:3,density:6,stepped:!0,format:e}},t))}function Fn(i,e,t){let s=getComputedStyle(i).direction==="rtl",r=i.noUiSlider.options.direction==="rtl",n=i.noUiSlider.options.orientation==="vertical",a=i.noUiSlider.getTooltips().map(c=>c.cloneNode(!0)),l=i.noUiSlider.getOrigins();a.forEach(function(c,f){c&&l[f].appendChild(c)}),i.noUiSlider.on("update",function(c,f,m,w,_){let S=[[]],E=[[]],R=[[]],F=0;a[0]&&(S[0][0]=0,E[0][0]=_[0],R[0][0]=c[0]);for(let L=1;L<_.length;L++)(!a[L]||_[L]-_[L-1]>e)&&(F++,S[F]=[],R[F]=[],E[F]=[]),a[L]&&(S[F].push(L),R[F].push(c[L]),E[F].push(_[L]));S.forEach(function(L,V){let j=L.length;for(let z=0;z<j;z++){let Q=L[z];if(z===j-1){let X=0;E[V].forEach(function(O){X+=1e3-O});let Z=n?"bottom":"right",g=r?0:j-1,P=1e3-E[V][g];X=(s&&!n?100:0)+X/j-P,a[Q].innerHTML=Hn(R[V]).join(t),a[Q].style.display="block",a[Q].style[Z]=X+"%"}else a[Q].style.display="none"}})})}"use strict";var $n={mounted(){let{facet:i,language:e,currency:t,currencyDecimal:s,currencyFormat:r,currencyPrecision:n,currencySymbol:o,currencyThousand:a,decimalPrecision:l,min:c,max:f,from:m,to:w,target:_}=this.el.dataset,S=this.el.dataset.autohideTooltips==="true",E=this.options.numberingSystem||"latn",R=(document.documentElement.getAttribute("dir")||"").toLowerCase()==="rtl",F=(()=>typeof r=="string"?new Us(r,o,a,s,parseInt(n,10)):t?Fi(e,t,parseInt(n,10),E):$i(e,parseInt(l,10),E))();this.format=Mn(F),this.slider=Nn(this.el,this.format,Xs({min:c,max:f,from:m,to:w},this.format),{rtl:R}),this.slider.on("change",L=>{let[V,j]=L,Q={index:this.el.dataset.index,range:{[i]:{from:this.format.from(V),to:this.format.from(j)}}};_?this.pushEventTo(_,"slide",Q):this.pushEvent("slide",Q)}),S||Fn(this.el,25," - ")},updated(){let{min:i,max:e,from:t,to:s}=this.el.dataset;this.slider.updateOptions(Xs({min:i,max:e,from:t,to:s},this.format))},destroyed(){this.el.noUiSlider.destroy()}};"use strict";var Un={mounted(){let i=0,e=0;this.el.addEventListener("touchstart",t=>{i=t.changedTouches[0].screenY},!1),this.el.addEventListener("touchend",t=>{e=t.changedTouches[0].screenY,e>i&&this.pushEvent(this.el.dataset.action,{index:""})},!1)}};var ji=window.SpeechRecognition||window.webkitSpeechRecognition||null,Bn=["click"],Vn=["start","end","error","result"],Wa="voice-search",jn="voice-status-change";function Ka(i){return i.results.length>0?i.results[0][0].transcript:null}var Xn={mounted(){!ji||(this.recording=!1,this.driver=new ji,this.driver.continuous=!1,this.driver.interimResults=!1,this.handleVoiceEvent=i=>{switch(i.type){case"end":case"error":this.driver.stop(),this.recording=!1,this.pushEvent(jn,{recording:!1});break;case"click":this.driver[this.recording?"stop":"start"](),this.recording=!this.recording,this.pushEvent(jn,{recording:this.recording});break;case"result":{let e=Ka(i);e&&this.pushEvent(Wa,{query:e});break}}},Bn.forEach(i=>this.el.addEventListener(i,this.handleVoiceEvent)),Vn.forEach(i=>this.driver.addEventListener(i,this.handleVoiceEvent)))},destroyed(){Bn.forEach(i=>this.el.removeEventListener(i,this.handleVoiceEvent)),Vn.forEach(i=>this.driver.removeEventListener(i,this.handleVoiceEvent)),this.driver=null}};function me(i,e,...t){var o;let s=((o=t.find(a=>!!a.options))==null?void 0:o.options)||{},r={get tag(){return e},get options(){return s},debug(...a){C(`[hook][${i}]`,...a)}};return["mounted","beforeUpdate","updated","destroyed","disconnected","reconnected"].forEach(a=>{let l=t.map(c=>c[a]).filter(c=>!!c);r[a]=function(){l.length>0&&this.debug(`${a}()`),l.forEach(c=>c.call(this))}}),r}function Jn(i){return JSON.parse(JSON.stringify(i))}function Js(i,e,t){let s=t.x,r=s+t.width,n=t.y,o=n+t.height;return i>=s&&i<=r&&e>=n&&e<=o}function Jt(i,e=!1){let t=Ds("__DF_LAYER_SERVER__")||`https://${i.toLowerCase()}-layer.doofinder.com`;return e?t.replace(/^http/,"ws"):t}function qn(){var i;if("maxTouchPoints"in navigator)return navigator.maxTouchPoints>0;if("msMaxTouchPoints"in navigator)return navigator.msMaxTouchPoints>0;{let e=(i=window.matchMedia)==null?void 0:i.call(window,"(pointer:coarse)");if((e==null?void 0:e.media)==="(pointer:coarse)")return!!e.matches;if("orientation"in window)return!0;{let t=navigator.userAgent;return/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)}}}function qs(i){let e=document.cookie.match(new RegExp("(?:^|; )"+i.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));if(e)return decodeURIComponent(e[1])}function Wn(i){if(i instanceof PointerEvent)switch(i.pointerType){case"mouse":case"pen":case"touch":return!0;default:return!1}else if(i instanceof MouseEvent){let{pageX:e,pageY:t,target:s}=i;return!(e===t&&e===0&&za(s))}return!1}function za(i){return i.getAttribute("type")==="submit"&&(i.tagName==="BUTTON"||i.tagName==="INPUT")}function Ws(i){return typeof i=="undefined"?null:i}var Ga="Search",Kn=qn(),zn="latestSearches",Ya=10,Qa="dfd-root",Xi=class{constructor(e){this.__handleTriggerEvent__=this.__handleTriggerEvent__.bind(this),this.__handleLinkClick__=this.__handleLinkClick__.bind(this),this.__handleDocumentMousedown__=this.__handleDocumentMousedown__.bind(this),this.__handleDocumentKeyup__=this.__handleDocumentKeyup__.bind(this),this.__updateSocketParams__=this.__updateSocketParams__.bind(this),this.__afterConnect__=this.__afterConnect__.bind(this),this.__afterDisconnect__=this.__afterDisconnect__.bind(this);let{autoload:t,currency:s,exportResultsData:r,hashid:n,id:o,installationId:a,is_checkout:l,language:c,layerType:f,search_query_retention:m,trigger:w,urlHash:_,zone:S}=e;this._installationId=a,this._zone=S,this._hashid=n,this._language=c,this._currency=s,this._exportResultsData=r,this._layerType=f,l&&this.dispatch("doofinder.layer.checkout",{url:window.location.href}),this._mount=this.__createMount__(o),this._mount.addEventListener("click",this.__handleLinkClick__),this._eventBus=new Is(this._mount.id),this._eventBusSubscriptions=[Os,Ut,Bt,Hs].map(E=>this._eventBus.on(E,this.__handleTriggerEvent__)),this._trigger=w,this._trigger.setEventBus(this._eventBus),this._display=new Rs(this._mount),this._state=this.__defineNewState__(a,t,_,f),this._data=new vt(`${a}.data`),this._sessionData=new vt(`${a}.data`,window.sessionStorage),this._params=this.__buildSocketParams__(e),this._hooks=this.__buildSocketHooks__(e),this._connection=null,this._connectedPromise=new De,this._theme=null,this._searchQueryRetention=m,this._urlHash=_,this._autoload=t,this.closable&&this.mount.classList.add("dfd-closable"),this._trigger.flushMessages(),this.__loadState__().then(()=>this.dispatch("doofinder.ready"))}__createMount__(e){let t=document.createElement("div");return t.id=e||`df-${bt(32)}`,t.dataset.dfdView=Ga,t.setAttribute(Me,""),t.classList.add(Qa),Object.defineProperty(t,"doofinderTag",{value:this,writable:!1}),t}get mount(){return this._mount}get trigger(){return this._trigger}get display(){return this._display}get hashid(){return this._hashid}get installationId(){return this._installationId}get zone(){return this._zone}get language(){return this._language}get currency(){return this._currency}get exportResultsData(){return this._exportResultsData}get layerType(){return this._layerType}get searchQueryRetention(){return this._searchQueryRetention}get data(){return this._data}get state(){return this._state}get closable(){return this.display.type!==tt||!this._state.hasAutoloadQueryParam}set targetItemId(e){this.state.targetItemId=e}enableDebug(){return this._connection?(this._connection.enableDebug(),!0):!1}debug(...e){C("[tag]",...e)}updateState({value:e=this._state.targetItemId,itemId:t=this._state.targetItemId,isTransitory:s=this._state.isTransitory}){this._state.update(e,t,s)}__handleTriggerEvent__(e){let{source:t,originalEvent:s}=e.detail,{query:r}=e.detail,n=r?{query:r}:{};this.connect(n).then(()=>{this.__shouldDisplay__(e)?(this.show(t),e.type===Bt&&this.search(r)):e.type===Hs&&this.submit(r,o=>{var l;if(!o)return;let{submit:a}=o||{};a&&((l=s==null?void 0:s.target.closest("form"))==null||l.submit())})})}__shouldDisplay__(e){let{query:t}=e.detail;switch(this._display.type){case Ei:return(e.type===Bt||e.type===Ut)&&(this._display.screenType==="classic-initial"||!!t);case tt:return(e.type===Bt||e.type===Ut)&&!!t;case wi:return e.type===Os||e.type===Ut;default:return!1}}__handleLinkClick__(e){var r,n;if(this.dispatch("doofinder.layer.click",{originalEvent:e}),e.target.href===window.location.href){e.preventDefault(),this.__closeAndPreserveQuery__();return}if(!e.target.href){(r=this._connection)==null||r.setPreventReconnect(!1);return}let t=e.target.closest("[dfd-value-dfid]"),s=t==null?void 0:t.getAttribute("dfd-value-dfid");s&&this.updateState({itemId:s}),(n=this._connection)==null||n.setPreventReconnect(!0),this._layerType!=="category_pages"&&this._searchQueryRetention&&this._state.saveTransitory(e.target.href)}__closeAndPreserveQuery__(){if(this.searchQueryRetention){let e=this._state.query;setTimeout(()=>{this._trigger.updateQuery(e)},300)}this.close()}__handleDocumentMousedown__(e){if(this._display.hidden||this._display.type===tt||!Wn(e))return;let{clientX:t,clientY:s}=e;if(Js(t,s,this._mount.getBoundingClientRect()))return;let r=this._display.method.positionReference;!!r&&(Js(t,s,r.getBoundingClientRect())||e.target.closest('button[type="submit"]')&&e.target.closest("form")===r.closest("form"))||this.close()}__handleDocumentKeyup__(e){var t;e.key==="Escape"&&this.layerType!=="category_pages"&&((t=document.activeElement)==null||t.blur(),this.close())}__loadState__(){if(this._layerType==="category_pages"||(this.debug("load state:",this._state.value),this._trigger.updateQuery(this._searchQueryRetention?this._state.query:""),!this._state.value))return Promise.resolve();let e=this._state.value;return this.connect({state:e}).then(()=>{this._state.isTransitory?this.debug("Layer not opened because the state is transitory"):this.show()})}getLatestSearches(){return this._data.getItem(zn)||[]}updateLatestSearches(e){this._data.setItem(zn,e)}onLoad(e){let{min_capture_length:t,capture_submit:s,align:r,display_type:n,insertion_point:o,insertion_method:a,screen_type:l,theme:c}=e;this.__updateTrigger__({min_capture_length:t,capture_submit:s}),this.__updateDisplay__({display_type:n,insertion_point:o,insertion_method:a,screen_type:l,theme:c,align:r}),this._connectedPromise.resolve(e)}__updateTrigger__({min_capture_length:e,capture_submit:t}){this._trigger.setCaptureLength(e),this._trigger.captureSubmit=t}__updateDisplay__({display_type:e,insertion_point:t,insertion_method:s,screen_type:r,theme:n,align:o}){this._display.setType(e,{placement:{insertionPoint:t,insertionMethod:s},align:o}),this._display.screenType=r,this._display.updateTheme(n),this._display.hidden||this.updatePosition()}updatePosition(e){return I(this,null,function*(){this._display.updatePosition({positionReference:e||(yield this._trigger.getElement())})})}close(){var e,t;this.closable&&((t=(e=this.getHooksByName("Layer"))==null?void 0:e.pop())==null||t.close())}show(e){return I(this,null,function*(){yield this.updatePosition(e),yield this._display.show(),this.updateState({isTransitory:!1}),setTimeout(()=>{var t;return(t=this._connection)==null?void 0:t.pushEvent("update-scroll")},200),this.dispatch("doofinder.show")})}hide(){return I(this,null,function*(){this._display&&(yield this._display.hide()),this.dispatch("doofinder.hide")})}dispatch(e,t={}){let s=xe(H({},t),{tag:this});document.dispatchEvent(new CustomEvent(e,{detail:s}))}connect(e){return this._connection||(this.debug(`creating live socket for layer: ${this._mount.id}`),this._connection=new Es(this.__connectionSetup__(e)),this._connection.connect(this.__afterConnect__)),this._connectedPromise}isConnected(){return this._connection?this._connection.connected:!1}open(){return I(this,arguments,function*(e={}){let{search:t,screen:s}=e,r=H({},e);t!=null&&!s&&(r.screen="fallback"),typeof t=="string"&&(delete r.search,r.query=t),yield this.connect(r),yield this.show(),typeof t=="object"&&this.search(t)})}openCategoryPages(e){return I(this,null,function*(){let{search:t}=e,s={search:t},r=this._state.value;r&&(s.state=r),C("[category pages] connect with",s),yield this.connect(s),yield this.show(),r||(C("[category pages] no state, opening with: ",t),this.search(t))})}disconnect(){var e;this.layerType!=="category_pages"&&(this.debug(`disconnecting from live socket: ${this._mount.id}`),this._trigger.updateQuery(""),this.updateState({value:"",itemId:null,isTransitory:!1}),this.hide(),(e=this._connection)==null||e.disconnect(this.__afterDisconnect__),this._connection=null,this._connectedPromise=new De)}destroy(){return I(this,null,function*(){var e;this.debug(`destroy: ${this._mount.id}`),this.hide(),(e=this._connection)==null||e.disconnect(this.__afterDisconnect__),this._connection=null,this._eventBusSubscriptions.forEach(t=>t()),this._eventBusSubscriptions=null,this._eventBus.teardown(),this._eventBus=null,yield this._display.destroy(),this._display=null,this._trigger.destroy(),this._mount.replaceChildren(),this.dispatch("doofinder.destroy")})}getHooksByName(e){var t;return(t=this._connection)==null?void 0:t.getHooksByName(e)}search(e,t){var r;let s=typeof e=="string"?{query:e}:e;(r=this._connection)==null||r.pushEvent("search-suggest",{search:s},t)}changeLocale(e,t,s){var r;(r=this._connection)==null||r.pushEvent("change-locale",{language:e,currency:t},s)}submit(e,t){var s;(s=this._connection)==null||s.pushEvent("search-submit",{search:{query:e}},t)}__buildSocketParams__(e){let{params:t,sort:s,vars:r,indices:n,state:o,priceName:a}=e,l={hashid:this._hashid,origin:window.location.hostname,indices:n,params:t,sort:s,vars:r,state:o,price_name:a};return["indices","search-server"].filter(c=>!l[c]).forEach(c=>delete l[c]),l}__buildSocketHooks__(e){let t=e.hooks||{},s={Carousel:me("Carousel",this,sn,t.Carousel||{}),ImageSearch:me("ImageSearch",this,on),Input:me("Input",this,ln,t.Input||{}),Layer:me("Layer",this,pn,t.Layer||{}),LayerNotAvailable:me("LayerNotAvailable",this,mn),AddToCart:me("AddToCart",this,hn,t.AddToCart||{}),EmbeddedResults:me("EmbeddedResults",this,$s,Kn?Fs:{},t.EmbeddedResults||{}),Results:me("Results",this,En,Kn?Fs:{},$s,t.Results||{}),Slider:me("Slider",this,$n,t.Slider||{}),Swipe:me("Swipe",this,Un,t.Swipe||{}),VoiceSearch:me("VoiceSearch",this,Xn,t.VoiceSearch||{})};return C("[tag] Hooks created:",this._mount.id,s),Object.keys(t).filter(r=>!s[r]).forEach(r=>{s[r]=me(r,this,t[r]||{})}),s}__connectionSetup__(e){return{url:`${Jt(this._zone,!0)}/layer/${rt}`,mount:this._mount,hooks:this._hooks,mainHook:"Layer",params:()=>this.__updateSocketParams__(e),appName:"layer",disconnectCallback:(()=>{this.debug("layer died and can't reconnect automatically! \u{1F92C}"),this.__afterDisconnect__()}).bind(this)}}__updateSocketParams__(e){var s,r,n,o;let t=xe(H({},Jn(this._params)),{zone:this.zone,installation_id:this.installationId,language:this.language,currency:this.currency,session_id:Doofinder.Session.getSessionId(),tab_id:"getTabId"in Doofinder.Session?Doofinder.Session.getTabId():null,session_alive:Doofinder.Session.isLive("layer"),user_id:Doofinder.Session.getUserId(),latest_searches:this.getLatestSearches(),voice_supported:!!ji,export_results_data:Ws((s=this.exportResultsData)==null?void 0:s.slice(0,Ya)),ga_client_id:Ws((r=qs("_ga"))==null?void 0:r.substring(6)),layer_type:this.layerType,state:this._state.value,mount_id:this._mount.id,current_url:window.location.href});return this._layerType==="category_pages"&&(t.search=e.search),((n=this._connection)==null?void 0:n.connected)||(t=H(H({},t),e)),this.debug(`__updateSocketParams__ for layer: ${this._mount.id}`,t," socket connected? ",(o=this._connection)==null?void 0:o.connected," overrides: ",e," current state",this._state.value),t}__afterConnect__(){document.addEventListener("mousedown",this.__handleDocumentMousedown__),document.addEventListener("keyup",this.__handleDocumentKeyup__,{passive:!0})}__afterDisconnect__(){document.removeEventListener("keyup",this.__handleDocumentKeyup__),document.removeEventListener("mousedown",this.__handleDocumentMousedown__),this.dispatch("doofinder.disconnect")}__defineNewState__(e,t,s,r){return new st({installationId:e,autoload:t,urlHash:s,layerType:r})}};var Za=Object.freeze({language(i){let e=(i==null?void 0:i.replaceAll("_","-").trim().split("-"))||[];function t(s){return s?`-${s.toUpperCase()}`:""}if(e.length<3){let[s,r]=e;return`${s==null?void 0:s.toLowerCase()}${t(r)}`}else{let[s,r,n]=e;return`${s==null?void 0:s.toLowerCase()}-${r.toUpperCase()}${t(n)}`}},currency(i){return i==null?void 0:i.trim().toUpperCase()}});function Ks(i){return I(this,null,function*(){let e=document.createElement("style");e.appendChild(document.createTextNode((i||"").trim())),document.head.appendChild(e)})}function Gn(i){return I(this,null,function*(){var o;let e=tl(i);C("[category pages] displayForSeo options: ",i,"params: ",e);let t=yield il(e);if(C("[category pages] displayForSeo htmlContent: ",t),!t)return;let s=el(i.id,t);i.device=="mobile"&&(s.classList.remove("dfd-embedded"),s.classList.add("dfd-mobile_embedded")),i.custom_css.forEach(Ks);let r=(o=i.custom_properties)==null?void 0:o.join(`
`);Ks(`#${s.id} {
${r||""}
}`);let n=document.querySelector(i.insertion_point);C("[category pages] displayForSeo insertion point: ",n),n&&n.replaceWith(s)})}function el(i,e){let t=document.createElement("div");return t.id=i||`df-${bt(32)}`,t.dataset.dfdView="Search",t.classList.add("dfd-root"),t.insertAdjacentHTML("afterbegin",e),t}function tl(i){let{installationId:e,hashid:t,language:s,currency:r,zone:n,search:o,sort:a,urlHash:l,vars:c,layerType:f,autoload:m,priceName:w}=i,_=Doofinder.Session.getSessionId(),S=Doofinder.Session.getUserId(),E=new st({installationId:e,autoload:m,urlHash:l,layerType:f}).value;return{installationId:e,hashid:t,language:s,currency:r,zone:n,state:E,search:o,sort:a,price_name:w,session_id:_,user_id:S,vars:c}}function il(i){return I(this,null,function*(){let{zone:e}=i,t=Jt(e),s=new URL(`${t}/api/${rt}/categorypage`);return Object.keys(i).forEach(function(n){let o=i[n];typeof o=="undefined"||o==null||(typeof o=="object"&&(o=JSON.stringify(o)),s.searchParams.append(n,o))}),yield fetch(s).then(function(n){return n.ok?n.text():""})})}function Yn(i){let{hashid:e,url_patterns:t}=i,s=window.location.toString();return C("[category merchandising] __getNewOptions__ category merchandising URL patterns:  ",t," url: ",s),sl(e,t,s)}function sl(i,e,t){try{let s=rl(i,e,t);if(!s)return C("[category merchandising] configuration not found for current location, urlStr: ",t),null;let r=zs(s),n=[...t.matchAll(r)][0].groups,o=nl(s,n);return o.url_pattern_id=s.id,C("[category merchandising] configuration found for current location, urlStr: ",t,"categoryMerchandisingConfig: ",s,"capturedValues from URL: ",n,"params to open the layer: ",o),o}catch(s){return C("[category merchandising] error trying to get category merchandising search options: ",s),null}}function rl(i,e,t){let s=e.filter(r=>r.hashid===i).find(r=>{let n=zs(r);return[...t.matchAll(n)].length>0});return s||e.filter(r=>!r.hashid).find(r=>{let n=zs(r);return[...t.matchAll(n)].length>0})}function zs(i){let[,,e,t]=i.pattern.match(/(\/?)(.+)\1([a-z]*)/i);t=t||"g";let s=new RegExp(e,t);return C("pattern ",e,"flags",t,"regexp",s),s}function nl(i,e){let t="{{",s="}}",{params:r}=i,n=JSON.stringify(r.search);for(let o in e){let a=`${t}${o}${s}`,l=ol(i,o,`${e[o]}`);C("[category merchandising] replacing old value: ",a,", new value ",l,"at",n),n=n.replaceAll(a,l)}return JSON.parse(n)}function ol(i,e,t){var r;let s=(r=i.params)==null?void 0:r.transformers;if(!s||!s[e])return C("[category merchandising] __applyTransformer__ transformers not found in categoryMerchandisingConfig",i," for ",e),t;try{return Array.isArray(s[e])?al(s[e],t):typeof s[e]=="string"?ll(s[e],t):t}catch(n){C("[category merchandising] __applyTransformer__ error ","category merchandising config: ",i,"key",e,"value",t,"error",n)}return t}function al(i,e){C("[category merchandising] __applyTransformerDefinedAsArray__ ",i);let[t,s]=i,r=t.split("."),n=window[r[0]];return r.slice(1).forEach(o=>n=window[o]),typeof n=="function"?(C("[category merchandising] __applyTransformer__ call function ",t," args: ",[e,s]),n(e,s)):(C("[category merchandising] __applyTransformer__ transformer",t," is not a function. Type: ",typeof n),e)}function ll(i,e){let t=(0,eval)(i);return C("[category merchandising] __applyTransformerDefinedAsString__ completionValue obtained with eval",t," evaluated code ",i),typeof t=="function"?t(e):e}var Ji=[];document.addEventListener("doofinder.destroy",i=>{Ji=Ji.filter(e=>e!==i.detail)});var Qn={getTags(){return Ji.slice(0)},create(i){let e=new Xi(i);return i.layerType==="category_pages"&&(i.search=i.search||Yn(i),i.search&&(Gn(i),e.openCategoryPages(i))),Ji.push(e),e},destroy(i){var e;i instanceof Xi?i.destroy():(e=i==null?void 0:i.doofinderTag)==null||e.destroy()},enableDebug:Gr,disableDebug:Yr,debug:C,utils:{buildNumericFormatter:$i,buildCurrencyFormatter:Fi}};Object.defineProperty(Qn,"__version__",{value:rt});cr(hr,Qn);})();
